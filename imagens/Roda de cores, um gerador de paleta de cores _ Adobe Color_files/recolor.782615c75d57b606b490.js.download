(this.webpackJsonp=this.webpackJsonp||[]).push([[11],{1002:function(t,e,r){"use strict";r.d(e,"d",(function(){return v})),r.d(e,"e",(function(){return d})),r.d(e,"a",(function(){return y})),r.d(e,"c",(function(){return g})),r.d(e,"f",(function(){return S})),r.d(e,"g",(function(){return _})),r.d(e,"h",(function(){return x})),r.d(e,"b",(function(){return L})),r.d(e,"j",(function(){return A})),r.d(e,"i",(function(){return C}));var n=r(1),o=r(67),a=r(4),i=r(988),c=r(136),u=r(36),l=r(42),s=r(813),f=r(987);function h(t){var e=t.user,r={"x-api-key":config("CLIENT_ID")};return e.isLoggedIn&&(r.Authorization="Bearer ".concat(e.token)),r}function p(t,e,r,o){var c,u=function(t){return t.themes=t.libraries,delete t.libraries,t}(t);u.themes=null===(c=u.themes)||void 0===c?void 0:c.filter((function(t){return t.ownership===n.Cc.OWNERSHIP.PRIVATE||!Object(a.u)(t.bookmark)&&t.bookmark.role===n.Cc.ROLE.EDITOR||!(Object(a.u)(t.asset_acl)||Object(a.u)(t.asset_acl["".concat(n.Cc.ASSET_ACL.DIRECTORY_ACCESS)])||!t.asset_acl["".concat(n.Cc.ASSET_ACL.DIRECTORY_ACCESS)].includes(n.Cc.ACCESS_LEVEL.WRITE))})),u.oldThemes=e,o(Object(i.e)(r,n.p,u)),o(Object(i.g)(r,n.p))}function v(t,e){return function(r,c){var u=c(),l=u.criteriaDataCollection;if(!Object(a.u)(l[t]))return r(Object(i.i)(t,n.p)),Object(o.c)(e.firstEndPoint,h(u)).then((function(e){return p(e,l[t].cclibrary.themeList,t,r),c().criteriaDataCollection[t].cclibrary.themeList})).then((function(n){return Object(o.c)(e.secondEndPoint,h(u)).then((function(e){return p(e,n,t,r),c().criteriaDataCollection[t].cclibrary.themeList}))})).catch((function(e){Object(a.x)("fetchCCLibraries: ".concat(e));var o=n.h.COMPLETED_WITH_GENERIC_ERROR;return e.response&&e.response.status&&(o=e.response.status),console.log("error ".concat(e)),r(Object(i.h)(t,n.p,o)),[]}))}}function d(t,e){return function(r,c){var u=c(),l=u.criteriaDataCollection;if(u.user,!Object(a.u)(l[t])&&l[t].cclibrary.fetchStatus!==n.h.REQUESTED)return r(Object(i.i)(t,n.p)),function(t,e){return Object(o.c)(t,e).then((function(t){return t.elements})).catch((function(t){return Object(a.x)("fetchCCLibraryAssets: ".concat(t)),[]}))}(e.endPointTheme,h(u)).then((function(e){var o=[],a=[];e.forEach((function(t){switch(t.type){case n.Mc:o.push(t);break;case n.wb:n.Sb||a.push(t)}}));var c={themes:o,oldThemes:l[t].cclibrary.themeList,gradients:a};r(Object(i.g)(t,n.p)),r(Object(i.e)(t,n.p,c))})).catch((function(e){Object(a.x)("fetchCCLibraryThemeList: ".concat(e));var o=n.h.COMPLETED_WITH_GENERIC_ERROR;e.response&&e.response.status&&(o=e.response.status),console.log("error ".concat(e)),r(Object(i.h)(t,n.p,o))}))}}function y(t){return function(e,r){var c=h(r()),u=r().libraries.criteria,l=config("CCLIBRARIES_ENDPOINT").melvilleBasePath,s=config("CCLIBRARIES_ENDPOINT").librariesApi,f="".concat(l).concat(s);return c=Object.assign(c,{Accept:"application/json","Content-Type":"application/json"}),Object(o.e)(f,c,{name:t.libraryName}).then((function(t){var r={themes:[t]};return u.forEach((function(t){return e(Object(i.a)(JSON.stringify(t),n.p,r))})),{name:t.name,id:t.library_urn}})).catch((function(t){if(t.exceptionCode===n.nb.STORAGE_FULL)throw console.log("error ".concat(t.message)),t;Object(a.x)("createNewLibrary: ".concat(t)),console.log("error ".concat(t))}))}}var m=function(t,e,r){var o=[],c={},u={libraryName:t.defaultLibraryName};return e(y(u)).then((function(a){return e(f.f({name:t.defaultLibraryName,id:a.id})),o.push({isWritable:a.isWritable?a.isWritable:null,name:a.name,library_urn:a.id}),c.themes=o,c._links=null,e(Object(i.g)(r,n.p)),c})).catch((function(t){Object(a.x)("createNewDefaultLibrary: ".concat(t)),console.log("error ".concat(t))}))};function g(t,e){return function(r,c){var u=c(),l=u.criteriaDataCollection;if(!Object(a.u)(l[t]))return r(Object(i.i)(t,n.p)),Object(o.d)(e.url,h(u),e.signal).then((function(n){return 0===n.total_count&&"create"===e.currentPage?m(e,r,t):(p(n,l[t].cclibrary.themeList,t,r),c(),n)})).catch((function(e){Object(a.x)("fetchAllCCLibraries: ".concat(e));var o=n.h.COMPLETED_WITH_GENERIC_ERROR;return e.response&&e.response.status&&(o=e.response.status),console.log("error ".concat(e)),r(Object(i.h)(t,n.p,o)),[]}))}}function b(t){var e=t.criteriaDataCollection,r=t.libraries,o=(t.user,r.criteria),a=null;return(void 0===e[JSON.stringify(o[0])]?[]:e[JSON.stringify(o[0])].cclibrary.themeList.slice().reverse()).some((function(t){return!!(isNaN(t.totalElements)||t.totalElements<n.r)&&(a=t,!0)})),a}function w(t){var e={};return Object(c.a)(t)&&(t.isSpotColor?e.type="spot":e.type="process",e.spotColorName="PANTONE ".concat(t.pantone)),e}function O(t){var e=[],r=t.swatches,o=t.colorMode;return r.forEach((function(t){var r=[],a={};o.toUpperCase()!==n.X&&r.push(function(t,e){var r={};switch(e){case n.y.CMYK:r.mode=n.z.CMYK,r.value={c:parseInt(Math.round(t.cmyk.c*n.A.MAX.CMYK.C),10),m:parseInt(Math.round(t.cmyk.m*n.A.MAX.CMYK.M),10),y:parseInt(Math.round(t.cmyk.y*n.A.MAX.CMYK.Y),10),k:parseInt(Math.round(t.cmyk.k*n.A.MAX.CMYK.K),10)};break;case n.y.HSV:r.mode=n.z.HSB,r.value={h:parseInt(Math.round(t.hsv.h*n.A.MAX.HSV.H),10),s:parseInt(Math.round(t.hsv.s*n.A.MAX.HSV.S),10),b:parseInt(Math.round(t.hsv.v*n.A.MAX.HSV.V),10)};break;case n.y.LAB:var o=Object(u.e)([t.lab.l,t.lab.a,t.lab.b]);r.mode=n.z.LAB,r.value={l:Math.round(o[0]),a:Math.round(o[1]),b:Math.round(o[2])}}return Object.assign(r,w(t)),r}(t,o)),a.mode=n.z.RGB,a.value={r:parseInt(Math.round(t.rgb.r*n.A.MAX.RGB.R),10),g:parseInt(Math.round(t.rgb.g*n.A.MAX.RGB.G),10),b:parseInt(Math.round(t.rgb.b*n.A.MAX.RGB.B),10)},Object.assign(a,w(t)),r.push(a),e.push(r)})),e}function E(t,e,r){return function(c,u){if(null!==b(u())){var l=config("CCLIBRARIES_ENDPOINT").melvilleBasePath,s=config("CCLIBRARIES_ENDPOINT").librariesApi,f=config("CCLIBRARIES_ENDPOINT").themesApi,p=u().save,v=Object(a.u)(p.library)?b(u()):p.library,d="".concat(l).concat(s,"/").concat(v.id).concat(f),y=h(u()),m={};switch(y=Object.assign(y,{Accept:"application/json","Content-Type":"application/json"}),r){case n.g.GRADIENT:m=e.gradient;break;default:m=e.theme}return Object(o.e)(d,y,function(t,e){var r={name:t.name,client:{deviceId:window.adobeUserProfile.userId.split("@")[0],device:"".concat(window.navigator.platform,"_").concat(platform.os.version),app:"COLOR-".concat(n.d)},representations:[]},o={};switch(e){case n.g.GRADIENT:r.type=n.wb,o=function(t,e){var r={rel:"primary"};return r.type=n.Bb,r[e]={interpolation:t.interpolation,angle:t.angle,aspectRatio:t.aspectRatio,type:t.type,stops:t.stops},r}(t,n.xb);break;case n.g.THEME:r.type=n.Mc,o=function(t,e){var r={rel:"primary"};return r.type=n.Qc,r[e]={baseSwatchIndex:t.harmony.baseSwatchIndex,mood:t.harmony.mood,rule:t.harmony.rule,swatches:O(t),tags:t.tags.map((function(t){return t.value}))},t.accessibilityData&&(r[e].accessibilityData=t.accessibilityData),r}(t,n.Nc)}return r.representations.push(o),r}(m,r)).then((function(r){return c(Object(i.f)(t,m.source,e)),{response:r,libraryName:v.name}})).catch((function(t){throw Object(a.x)("saveAssetToCCLibrary: ".concat(t)),console.log("error ".concat(t)),t}))}console.error("All Libraries full. User needs to create new library")}}function S(t,e,r){return function(n,o){return function(t){var e=t.criteriaDataCollection,r=t.libraries.criteria,n=e[JSON.stringify(r[0])],o=[];return n&&(o=n.cclibrary.themeList),0===o.length}(o())?n(y({libraryName:"My Library"})).then((function(){n(E(t,e,r))})):n(E(t,e,r))}}function j(t,e){var r=config("CCLIBRARIES_ENDPOINT").melvilleBasePath,n=config("CCLIBRARIES_ENDPOINT").librariesApi,i=config("CCLIBRARIES_ENDPOINT").themesApi,c=config("CCLIBRARIES_ENDPOINT").metadataApi,u=t.cclibraryThemeUpdateLibId,l="".concat(r).concat(n,"/").concat(u).concat(i).concat(c),s=e;return s=Object.assign(s,{Accept:"application/json","Content-Type":"application/json"}),Object(o.i)(l,s,JSON.stringify(function(t){var e={elements:[]},r={id:t.cclibraryThemeUpdateAssetId};return void 0!==t.name&&(r.name=t.name),e.elements.push(r),e}(t))).then((function(t){return{response:t}})).catch((function(t){Object(a.x)("updateAssetMetadata: ".concat(t))}))}function _(t){return function(e,r){return j(t,h(r()))}}function x(t,e){return function(r,c){var u=config("CCLIBRARIES_ENDPOINT").melvilleBasePath,f=config("CCLIBRARIES_ENDPOINT").librariesApi,p=config("CCLIBRARIES_ENDPOINT").themesApi,v=e.cclibraryThemeUpdateLibId,d="".concat(u).concat(f,"/").concat(v).concat(p,"/").concat(e.cclibraryThemeUpdateAssetId,"/representations"),y=h(c()),m=l.a;return y=Object.assign(y,{Accept:"application/json","Content-Type":"application/json"}),(m=Object.assign(m,e)).id=e.cclibraryThemeUpdateAssetId,m.source=n.p,m.uniqueID=Object(s.a)(),Object(o.h)(d,y,JSON.stringify(function(t){var e={client:{deviceId:window.adobeUserProfile.userId.split("@")[0],device:"".concat(window.navigator.platform,"_").concat(platform.os.version),app:"COLOR-".concat(n.d)},type:"application/vnd.adobe.element.colortheme+dcx",representations:[]},r={rel:"primary",type:"application/vnd.adobe.colortheme+json","colortheme#trackingdata":"color-web-service","colortheme#optype":"colorThemePanel"};return r["colortheme#data"]={baseSwatchIndex:t.harmony.baseSwatchIndex,mood:t.harmony.mood,rule:t.harmony.rule,swatches:O(t),tags:t.tags.map((function(t){return t.value}))},t.accessibilityData&&(r["colortheme#data"].accessibilityData=t.accessibilityData),e.representations.push(r),e}(e))).then((function(o){return o.id=m.id,j(e,h(c())),r(Object(i.k)(JSON.stringify(t),n.p,m)),{response:o,libraryName:v.name}})).catch((function(t){Object(a.x)("updateCCLibraryTheme: ".concat(t))}))}}function L(t,e){return function(r,n){var c=h(n()),u=config("CCLIBRARIES_ENDPOINT").melvilleBasePath,l=config("CCLIBRARIES_ENDPOINT").librariesApi,s=config("CCLIBRARIES_ENDPOINT").themesApi,f="".concat(u).concat(l,"/").concat(JSON.parse(t).main).concat(s,"/").concat(e.id);return c=Object.assign(c,{Accept:"application/json","Content-Type":"application/json"}),Object(o.b)(f,c).then((function(n){return r(Object(i.d)(t,e.source,e)),{response:n,themeName:e.name}})).catch((function(t){Object(a.x)("deletePrivateTheme: ".concat(t))}))}}function A(t,e){return Object(i.p)(t,n.p,e)}function C(t,e){return Object(i.m)(t,n.p,e)}},1004:function(t,e,r){"use strict";r.d(e,"a",(function(){return l})),r.d(e,"g",(function(){return f})),r.d(e,"e",(function(){return h})),r.d(e,"f",(function(){return p})),r.d(e,"d",(function(){return v})),r.d(e,"i",(function(){return y})),r.d(e,"h",(function(){return m})),r.d(e,"k",(function(){return g})),r.d(e,"c",(function(){return b})),r.d(e,"b",(function(){return w})),r.d(e,"j",(function(){return O}));var n=r(1),o=r(67),a=r(988),i=r(2);function c(t,e,r){return{type:i.h,payload:r,srcName:e,criteria:t}}var u=r(4);function l(t){return Object(a.b)(t,n.Wb)}function s(t){var e=t.user,r={"x-api-key":config("ETHOS_ENDPOINT").clientId};return e.isLoggedIn&&(r.Authorization="Bearer ".concat(e.token)),r}function f(t,e,r){return e.hasNextPageForKuler.hasNextPage}function h(t,e){return function(r,i){var c=i();r(Object(a.i)(t,n.Wb)),Object(o.c)(e.endPoint,s(c)).then((function(e){var o={themes:[e]};r(Object(a.e)(t,n.Wb,o)),r(Object(a.g)(t,n.Wb))})).catch((function(e){var o=n.h.COMPLETED_WITH_GENERIC_ERROR;e.response&&e.response.status&&(o=e.response.status),console.log("error ".concat(e)),r(Object(a.h)(t,n.Wb,o))}))}}function p(t,e){return function(r,i){var l=i(),f=l.criteriaDataCollection,h=s(l);Object(u.u)(f[t])||f[t].kuler.fetchStatus===n.h.REQUESTED||(r(Object(a.i)(t,n.Wb)),Object(o.c)(e.endPoint,h).then((function(e){r(Object(a.e)(t,n.Wb,e)),r(c(t,n.Wb,e.hasNextPage)),r(Object(a.g)(t,n.Wb))})).catch((function(e){var o=n.h.COMPLETED_WITH_GENERIC_ERROR;e.response&&e.response.status&&(o=e.response.status),console.log("error ".concat(e)),r(Object(a.h)(t,n.Wb,o))})))}}function v(t,e){return function(r,i){var l=i(),f=l.criteriaDataCollection,h=s(l);Object(u.u)(f[t])||f[t].gradient.fetchStatus===n.h.REQUESTED||(r(Object(a.i)(t,n.x)),Object(o.c)(e.endPoint,h).then((function(e){r(Object(a.e)(t,n.x,e)),r(c(t,n.x,e.hasNextPage)),r(Object(a.g)(t,n.x))})).catch((function(e){var o=n.h.COMPLETED_WITH_GENERIC_ERROR;e.response&&e.response.status&&(o=e.response.status),console.log("error ".concat(e)),r(Object(a.h)(t,n.x,o))})))}}function d(t){var e=t.swatches,r=t.colorMode,o=[];return e.forEach((function(t){var e={};e.mode=r.toLowerCase(),e.values=function(t,e){switch(e){case n.y.RGB:return[t.rgb.r,t.rgb.g,t.rgb.b];case n.y.CMYK:return[t.cmyk.c,t.cmyk.m,t.cmyk.y,t.cmyk.k];case n.y.HSV:return[t.hsv.h,t.hsv.s,t.hsv.v];case n.y.LAB:return[t.lab.l,t.lab.a,t.lab.b]}return otherMode}(t,r),o.push(e)})),o}function y(t,e){return function(r,n){var i=s(n()),c=config("ETHOS_ENDPOINT").basePathForB1,l=config("ETHOS_ENDPOINT").api,f=config("ETHOS_ENDPOINT").themePath,h="".concat(c).concat(l).concat(f),p=Object.assign({},t);return n().save,i=Object.assign(i,{Accept:"application/json, text/javascript, */*","Content-Type":"application/json"}),Object(o.e)(h,i,function(t,e){var r={};return r.name=t.name?t.name:"My Color Theme",r.swatches=d(t),r.assets={assetid:e.id,libraryid:t.libraryid},r.tags=t.tags,r.harmony={baseSwatchIndex:t.harmony.baseSwatchIndex,mood:t.harmony.mood.toLowerCase(),rule:t.harmony.rule.toLowerCase(),sourceURL:""},t.accessibilityData&&(r.accessibilityData=t.accessibilityData),r}(p,e)).then((function(t){return e.isPublishToKuler&&r(Object(a.n)({isAssetPublished:!0,uniqueID:e.uniqueID,criteria:e.criteria,srcName:e.srcName,href:"".concat(window.location.origin,"/").concat(t.name.replaceAll(" ","-"),"-color-theme-").concat(t.id),kulerID:t.id})),t})).catch((function(t){Object(u.x)("saveThemeToKuler: ".concat(t))}))}}function m(t,e){return function(r,n){var i=s(n()),c=config("ETHOS_ENDPOINT").basePathForGradient,l=config("ETHOS_ENDPOINT").api,f=config("ETHOS_ENDPOINT").gradientPath,h="".concat(c).concat(l).concat(f),p=Object.assign({},t);return i=Object.assign(i,{Accept:"application/json","Content-Type":"application/json"}),Object(o.e)(h,i,p).then((function(t){return e.isPublishToKuler&&r(Object(a.j)({isAssetPublished:!0,uniqueID:e.uniqueID,criteria:e.criteria,srcName:e.srcName,href:"".concat(window.location.origin,"/").concat(t.name.replaceAll(" ","-"),"-color-gradient-").concat(t.id),kulerID:t.id})),t})).catch((function(t){Object(u.x)("saveGradientToKuler: ".concat(t))}))}}function g(t,e){return function(r,i){var c=s(i()),u=config("ETHOS_ENDPOINT").basePathForB2,l=config("ETHOS_ENDPOINT").themePath,f="".concat(u).concat(l,"/").concat(e.id,"/likeDuplicate"),h="".concat(u).concat(l,"/").concat(e.id,"/like");return c=Object.assign(c,{Accept:"application/json","Content-Type":"application/json"}),e.like.user?Object(o.a)(h,c).then((function(o){JSON.parse(t).main===n.L.EXPLORE.MY_APPRECIATIONS&&r(Object(a.d)(t,e.source,e)),r(Object(a.l)(t,n.Wb,e))})).catch((function(t){console.error("Error while updating status")})):Object(o.e)(f,c,{}).then((function(o){return r(Object(a.l)(t,n.Wb,e))})).catch((function(t){console.error("Error while updating status")}))}}function b(t,e){return function(r,i){var c=s(i()),l=config("ETHOS_ENDPOINT").basePathForB1,f=config("ETHOS_ENDPOINT").api,h=config("ETHOS_ENDPOINT").themePath,p="".concat(l).concat(f).concat(h,"/").concat(e.id);return c=Object.assign(c,{Accept:"application/json","Content-Type":"application/json"}),Object(o.a)(p,c).then((function(o){return r(Object(a.d)(t,n.Wb,e)),{response:o,themeName:e.name}})).catch((function(t){Object(u.x)("deletePublishedTheme: ".concat(t)),console.log("error ".concat(t))}))}}function w(t,e){return function(r,i){var c=s(i()),l=s(i()),f={Accept:"application/json","Content-Type":"application/json"},h=config("ETHOS_ENDPOINT").basePathForGradient,p=config("ETHOS_ENDPOINT").api,v=config("ETHOS_ENDPOINT").gradientPath,d="".concat(h).concat(p).concat(v,"/").concat(e.id);return c=Object.assign(c,f),l=Object.assign(l,f),Object(o.a)(d,l).then((function(o){return r(Object(a.c)(t,n.x,e)),{response:o,gradientName:e.name}})).catch((function(t){Object(u.x)("deletePublishedGradient: ".concat(t)),console.log("error ".concat(t))}))}}function O(t,e,r){return function(n,i){var c=i();return Object(o.c)(t,s(c)).then((function(t){if(t.themes.length>0){if("THEME"===r)return n(Object(a.n)({isAssetPublished:!0,uniqueID:e.uniqueID,criteria:e.criteria,srcName:e.srcName,href:t.themes[0].href,kulerID:t.themes[0].id}));if("GRADIENT"===r)return n(Object(a.j)({isAssetPublished:!0,uniqueID:e.uniqueID,criteria:e.criteria,srcName:e.srcName,href:t.themes[0].href,kulerID:t.themes[0].id}))}return n(Object(a.j)({isAssetPublished:!1,uniqueID:e.uniqueID,criteria:e.criteria,srcName:e.srcName})),n(Object(a.n)({isAssetPublished:!1,uniqueID:e.uniqueID,criteria:e.criteria,srcName:e.srcName}))})).catch((function(t){console.log("error ".concat(t))}))}}},1006:function(t,e,r){"use strict";r.d(e,"f",(function(){return u})),r.d(e,"e",(function(){return l})),r.d(e,"c",(function(){return s})),r.d(e,"b",(function(){return f})),r.d(e,"d",(function(){return h})),r.d(e,"g",(function(){return p})),r.d(e,"a",(function(){return v}));var n=r(1),o=r(993),a=r(4),i={sources:[n.p],criteria:[{main:"libraries"}]};function c(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.jb.LAST_MODIFIED,r=config("CCLIBRARIES_ENDPOINT"),o=r.melvilleBasePath,a=r.librariesApi,i=e===n.jb.LAST_MODIFIED?n.ec:n.nc;return"".concat(o).concat(a,"?owner=").concat(n.Cc.URL.QUERY,"&start=").concat(t,"&limit=").concat(n.ic,"&selector=details&orderBy=").concat(i,"&toolkit=none")}function u(t,e){var r=config("CCLIBRARIES_ENDPOINT"),o=r.melvilleBasePath,a=r.librariesApi,i=n.ec,c="".concat(o).concat(a,"?owner=").concat(n.Cc.URL.QUERY,"&start=").concat(t,"&limit=").concat(n.ic,"&orderBy=").concat(i,"&toolkit=none");return e?c:"".concat(c,"&selector=details")}function l(t){var e=config("CCLIBRARIES_ENDPOINT").melvilledomainPath;return"".concat(e).concat(t,"&toolkit=none")}var s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.jb.LAST_MODIFIED;return function(e,r){var i=r().libraries.criteria,u=r().criteriaDataCollection,l=0;Object(a.u)(u[JSON.stringify(i[0])])||(l=u[JSON.stringify(i[0])].cclibrary.startIndex);var s=c(l,t),f=c(l+n.ic,t);return e(o.m(JSON.stringify(i[0]),s,f))}},f=function(t,e,r,n){return function(a,i){var c=i().libraries.criteria;return i().criteriaDataCollection,a(o.i(JSON.stringify(c[0]),t,e,r,n))}},h=function(){return function(t,e){var r=e().libraries.criteria,n=e().criteriaDataCollection;return Object(a.u)(n[JSON.stringify(r[0])])?[]:n[JSON.stringify(r[0])].cclibrary.themeList}},p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return function(e){return e(o.p(n.gc,t))}},v=function(){return function(t,e){var r=e().libraries.criteria;return t(o.e(JSON.stringify(r[0])))}}},1007:function(t,e,r){"use strict";var n,o=r(1);function a(t,e){this.worker=new Worker(t),this.worker.addEventListener("message",this.onmessage.bind(this)),this.thisThreadPool=e,this.callback=null}function i(t,e){this.threads=[],this.tasks=[];for(var r=0;r<e;r++)this.threads.push(new a(t,this))}a.prototype.run=function(t){this.worker.postMessage(t.task),this.callback=t.callback},a.prototype.onmessage=function(t){this.callback(t.data),this.callback=null,this.thisThreadPool.afterTask(this)},i.prototype.queueTask=function(t){var e={task:t.startMessage,callback:t.onExtractionComplete};this.threads.length>0?this.threads.shift().run(e):this.tasks.push(e)},i.prototype.afterTask=function(t){this.tasks.length>0?t.run(this.tasks.shift()):this.threads.push(t)},i.prototype.clearQueue=function(){this.tasks.length=0},n="undefined"==typeof window?{clearQueue:function(){console.log("Clear Queue")},queueTask:function(){console.log("Queue Task")}}:new i("/extract.js",o.Sc),e.a=n},1019:function(t,e,r){"use strict";r.d(e,"a",(function(){return c})),r.d(e,"d",(function(){return s})),r.d(e,"c",(function(){return f})),r.d(e,"b",(function(){return h}));var n=r(1),o=r(988),a=r(67),i=r(4);function c(t){return Object(o.b)(t,n.Hc)}function u(t){return t.themes=t.files,delete t.files,t}function l(){return{"x-api-key":config("CLIENT_ID"),"x-product":config("STOCK_ENDPOINT").productId}}function s(t){return Object(a.c)(t,l()).then((function(t){return u(t).themes.length>0})).catch((function(t){return!1}))}function f(t,e){return function(r,c){var s=c().criteriaDataCollection;if(!Object(i.u)(s[t])&&!Object(i.D)(s[t].stock.fetchStatus))return r(Object(o.i)(t,n.Hc)),Object(a.c)(e.endPoint,l()).then((function(e){var a=u(e);r(Object(o.e)(t,n.Hc,a)),r(Object(o.g)(t,n.Hc))})).catch((function(e){var a=n.h.COMPLETED_WITH_GENERIC_ERROR;e.response&&e.response.status&&(a=e.response.status),console.log("error ".concat(e)),r(Object(o.h)(t,n.Hc,a))}))}}function h(t,e){return function(e,r){var a={},c=r().criteriaDataCollection;Object(i.u)(c[t])||c[t].stock.fetchStatus===n.h.COMPLETED_SUCCESSFULLY||(a.themes=[],n.P.forEach((function(t){a.themes.push({title:t})})),e(Object(o.e)(t,n.Hc,a)),e(Object(o.g)(t,n.Hc)))}}},1020:function(t,e,r){"use strict";r.d(e,"a",(function(){return u})),r.d(e,"d",(function(){return f})),r.d(e,"c",(function(){return p})),r.d(e,"b",(function(){return v}));var n=r(1),o=r(2),a=r(988),i=r(67),c=r(4);function u(t){return Object(a.b)(t,n.i)}function l(t){return t.projects&&(t.themes=t.projects,delete t.projects),t.entities&&(t.themes=t.entities,delete t.entities),t.categories&&(t.themes=[],t.categories.forEach((function(e){n.N.includes(e.label_en)&&t.themes.push(e)})),delete t.categories),t}function s(){return{"x-api-key":config("CLIENT_ID")}}function f(t){return Object(i.c)(t,s()).then((function(t){return l(t).themes.length>0})).catch((function(t){return!1}))}function h(t,e,r){return{type:o.X,payload:r,srcName:e,criteria:t}}function p(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(o,u){var f=u().criteriaDataCollection;return Object(c.u)(f[t])||Object(c.D)(f[t].behance.fetchStatus)?r?Object(i.c)(e.endPoint,s()).then((function(t){var e=l(t);if(e.gallery){var r=u(),a=r.gallery,i=r.galleries;a.criteria.some((function(t){return!(!t.galleryId||t.galleryId!==e.gallery.id||(o(h(JSON.stringify(i.criteria[0]),n.i,e)),0))}))}})).catch((function(e){console.log("error ".concat(e));var r=n.h.COMPLETED_WITH_GENERIC_ERROR;e.response&&e.response.status&&(r=e.response.status),o(Object(a.h)(t,n.i,r))})):void 0:(o(Object(a.i)(t,n.i)),Object(i.c)(e.endPoint,s()).then((function(e){var r=l(e);if(r.gallery){var i=u(),c=i.gallery,s=i.galleries;c.criteria.some((function(t){return!(!t.galleryId||t.galleryId!==r.gallery.id||(o(h(JSON.stringify(s.criteria[0]),n.i,r)),0))}))}o(Object(a.e)(t,n.i,r)),o(Object(a.g)(t,n.i))})).catch((function(e){console.log("error ".concat(e));var r=n.h.COMPLETED_WITH_GENERIC_ERROR;e.response&&e.response.status&&(r=e.response.status),o(Object(a.h)(t,n.i,r))})))}}function v(t,e){return function(r,o){var u=o().criteriaDataCollection;if(!Object(c.u)(u[t])&&u[t].behance.fetchStatus!==n.h.COMPLETED_SUCCESSFULLY)return r(Object(a.i)(t,n.i)),Object(i.c)(e.endPoint,s()).then((function(e){var o=l(e);r(Object(a.e)(t,n.i,o)),r(Object(a.g)(t,n.i))})).catch((function(e){console.log("error ".concat(e)),r(Object(a.h)(t,n.i,e))}))}}},1026:function(t,e,r){"use strict";var n=r(0),o=r.n(n),a=r(821),i=r.n(a);e.a=o.a.memo((function(t){return o.a.createElement("div",{className:i.a.gridWrapper},t.children)}))},1105:function(t,e,r){"use strict";var n=r(0),o=r.n(n);e.a=function(){return o.a.createElement("svg",{id:"Group_1","data-name":"Group 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 191.2 97.9"},o.a.createElement("path",{id:"Path_347","data-name":"Path 347",className:"cls-1",d:"M51.5,33H3.5A3.543,3.543,0,0,0,0,36.5v35A3.543,3.543,0,0,0,3.5,75h48A3.543,3.543,0,0,0,55,71.5v-35A3.543,3.543,0,0,0,51.5,33Zm-48,3h48a.472.472,0,0,1,.5.5V67.1L40.5,55.4a2.94,2.94,0,0,0-2.2-.9h0a3.1,3.1,0,0,0-2.2.9l-4.7,5-11.8-12a2.94,2.94,0,0,0-2.2-.9h0a3.1,3.1,0,0,0-2.2.9L3,60.8V36.5A.472.472,0,0,1,3.5,36ZM3,71.5V63.7L16.7,49.9a1.08,1.08,0,0,1,.7-.3h0a.908.908,0,0,1,.7.3L40.2,72H3.5A.472.472,0,0,1,3,71.5Zm48.5.5H42.9c0-.1-.1-.1-.1-.2l-9.9-10,4.7-5a.908.908,0,0,1,.7-.3h0a.779.779,0,0,1,.7.3L52,70v1.5A.472.472,0,0,1,51.5,72Z"}),o.a.createElement("path",{id:"Path_348","data-name":"Path 348",className:"cls-1",d:"M41.8,51.3h0a5.664,5.664,0,0,0,4.1-1.7,5.835,5.835,0,0,0,1.7-4.1,5.957,5.957,0,0,0-5.8-5.9h0a5.85,5.85,0,0,0,0,11.7Zm-2.7-8.5a3.864,3.864,0,0,1,2.7-1.1h0a3.8,3.8,0,0,1,3.8,3.8,3.756,3.756,0,0,1-3.8,3.8h0A3.8,3.8,0,0,1,38,45.5,3.864,3.864,0,0,1,39.1,42.8Z"}),o.a.createElement("path",{id:"Path_349","data-name":"Path 349",className:"cls-1",d:"M187.3,35H160.1l-7.5-6.8a4.713,4.713,0,0,0-3-1.2H134.3a3.159,3.159,0,0,0-3.2,3.2V70.3a3.691,3.691,0,0,0,3.7,3.7h52.7a3.691,3.691,0,0,0,3.7-3.7V38.7A3.933,3.933,0,0,0,187.3,35Zm-53.1-5h15.3a1.284,1.284,0,0,1,1,.4l5.1,4.6H134V30.2A.215.215,0,0,1,134.2,30ZM188,70.3a.684.684,0,0,1-.7.7H134.6a.684.684,0,0,1-.7-.7V38h53.3a.684.684,0,0,1,.7.7V70.3Z"}),o.a.createElement("path",{id:"Path_350","data-name":"Path 350",className:"cls-1",d:"M100.4,86,93,93.4V55.7a1.5,1.5,0,0,0-3,0V93.4L82.6,86a1.449,1.449,0,0,0-2.1,0,1.541,1.541,0,0,0,0,2.1L89.4,97a2.878,2.878,0,0,0,2.1.9,2.723,2.723,0,0,0,2.1-.9l8.9-8.9a1.485,1.485,0,0,0-2.1-2.1Z"}),o.a.createElement("path",{id:"Path_351","data-name":"Path 351",className:"cls-1",d:"M119.5,26a1.538,1.538,0,0,0-1.5,1.5V71.2a.86.86,0,0,1-.8.8H97.5a1.5,1.5,0,0,0,0,3h19.7a3.8,3.8,0,0,0,3.8-3.8V27.5A1.538,1.538,0,0,0,119.5,26Z"}),o.a.createElement("path",{id:"Path_352","data-name":"Path 352",className:"cls-1",d:"M121,21.4a.749.749,0,0,0-.1-.5h0c-.1-.2-.2-.3-.3-.5h0L99.6.4h0a2.186,2.186,0,0,0-.5-.3h0a1.486,1.486,0,0,0-.6-.1H67.8A3.8,3.8,0,0,0,64,3.8V71.2A3.8,3.8,0,0,0,67.8,75H85.5a1.5,1.5,0,0,0,0-3H67.8a.86.86,0,0,1-.8-.8V3.8a.86.86,0,0,1,.8-.8H97V19.2a3.8,3.8,0,0,0,3.8,3.8h19c.1,0,.2,0,.2-.1h.1c.1,0,.2-.1.3-.1l.1-.1c.1,0,.1-.1.2-.1h0a2.186,2.186,0,0,0,.3-.5v-.7Zm-21-2.2V5l15.7,15h-15A.858.858,0,0,1,100,19.2Z"}))}},1121:function(t,e,r){"use strict";var n=r(0),o=r.n(n),a=r(27),i=r(7),c=r(1106),u=r.n(c),l=r(1176),s=r.n(l),f=r(10),h=r(1),p=r(33),v=r(4);r(8),e.a=Object(i.e)((function(t){var e=Object(a.d)(),r=Object(a.e)((function(t){return t.user.onBoardingTour}));return!h.Sb&&!Object(f.b)(t.cookie)&&r===t.cookie&&o.a.createElement(s.a,{onTourEnd:function(){Object(f.c)(t.cookie,!0,8760),e(p.f(h.vc.DISABLE))}},function(){var e=[],r=t.steps.length,n=1;return t.steps.forEach((function(a,i){e.push(o.a.createElement(u.a,{key:i,flip:!0,title:t.intl.formatMessage({id:a.title}),image:!Object(v.u)(a.image)&&a.image,imageAlt:!Object(v.u)(a.image)&&t.intl.formatMessage({id:a.imageAlt}),selector:a.selectorId,currentStep:n,totalSteps:r,cancelLabel:n<r?t.intl.formatMessage({id:"app.tourDialog.steps.cacelLable"}):null,confirmLabel:n<r?t.intl.formatMessage({id:"app.tourDialog.steps.confirmLabelNext"}):t.intl.formatMessage({id:"app.tourDialog.steps.confirmLabelDone"}),placement:a.placement},t.intl.formatMessage({id:a.description}))),n++})),e}())}))},1459:function(t,e){},1461:function(t,e){},1471:function(t,e){},1473:function(t,e){},1498:function(t,e){},1500:function(t,e){},1501:function(t,e){},1506:function(t,e){},1508:function(t,e){},1514:function(t,e){},1516:function(t,e){},1535:function(t,e){},1547:function(t,e){},1550:function(t,e){},258:function(t,e,r){"use strict";r.r(e);var n,o=r(0),a=r.n(o),i=r(7),c=r(1041),u=r(27),l=r(63),s=r(141),f=r(29),h=r.n(f),p=r(1120),v=r.n(p),d=r(1449),y=r.n(d),m="image/svg+xml",g="NORMAL",b="LUMINOUCITY",w="NORMAL",O="KULER_BRIGHT",E="KULER_COLORFUL",S="KULER_DARK",j="KULER_MUTED",_="KULER_DEEP",x="KULER_BRIGHT_WEIGHTED",L="KULER_COLORFUL_WEIGHTED",A="KULER_DARK_WEIGHTED",C="KULER_MUTED_WEIGHTED",T="KULER_DEEP_WEIGHTED",M=r(1130);function I(t){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==I(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===I(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var N="default",R="complementary",k="analogous",D="triad",F="splitComplementary",G="square",U=(new Set([N,R,k,D,F,G]),P(n={},N,{label:"Default"}),P(n,R,{label:"Complementary"}),P(n,k,{label:"Analogous"}),P(n,D,{label:"Triad"}),P(n,F,{label:"Split complementary"}),P(n,G,{label:"Square"}),r(1592));function B(t,e){if(t){if("string"==typeof t)return H(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?H(t,e):void 0}}function H(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function V(t){return new Array(t).fill(0)}function W(t){return Array.from(Array(t),(function(){return V(t)}))}function q(t,e){return Array.from(Array(t),(function(){return V(e)}))}function z(t){return t.reduce((function(t,e){return t+e}),0)}function J(t,e){if(t.length!==e.length)throw new Error("Lengths of two arrays should be equal, but got lengths - ".concat(t.length,", ").concat(e.length));for(var r=[],n=0;n<t.length;n++)r.push(t[n]+e[n]);return r}function K(t,e){if(t.length!==e.length)throw new Error("Lengths of two arrays should be equal, but got lengths - ".concat(t.length,", ").concat(e.length));for(var r=[],n=0;n<t.length;n++)r.push(t[n]-e[n]);return r}function Y(t,e){var r,n=[],o=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=B(t))){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;n.push(a*e)}}catch(t){o.e(t)}finally{o.f()}return n}function X(t,e){var r=t.map((function(r,n){return t[n]-e[n]}));return Math.hypot.apply(Math,function(t){return function(t){if(Array.isArray(t))return H(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||B(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(r))}function Z(t){for(var e,r=t.length;0!==r;){e=Math.floor(Math.random()*r),r--;var n=[t[e],t[r]];t[r]=n[0],t[e]=n[1]}return t}var $=Object(M.a)("#000000"),Q={toRGB:function(t){return[(t=t.toFormat("rgb")).getChannelValue("red"),t.getChannelValue("green"),t.getChannelValue("blue")]},fromRGB:function(t){var e=Math.floor(Math.min(255,Math.max(0,t[0]))),r=Math.floor(Math.min(255,Math.max(0,t[1]))),n=Math.floor(Math.min(255,Math.max(0,t[2])));return $.toFormat("rgb").withChannelValue("red",e).withChannelValue("green",r).withChannelValue("blue",n)},randomColor:function(){var t=Math.floor(255*Math.random()),e=Math.floor(255*Math.random()),r=Math.floor(255*Math.random());return Q.fromRGB([t,e,r])},getColorFromCSSColor:function(t){var e=$,r=document.createElement("canvas").getContext("2d");return r&&(r.fillStyle=t,e=Object(M.a)(r.fillStyle)),e}};function tt(t){return nt(gt(t)).colorfulness<.07}function et(t){if(1===t[0]&&1===t[1]&&1===t[2])return!0;var e=nt(t);return e.luminosity<.005&&e.colorfulness<.02}function rt(t){if(0===t[0]&&0===t[1]&&0===t[2])return!0;var e=nt(t);return e.luminosity>.87&&e.colorfulness<.04-.02*(1-e.luminosity)}function nt(t){var e=function(t){return 1-(.3*t[0]+.59*t[1]+.11*t[2])}(t),r=function(t){return[1-t,1-t,1-t]}(e),n=0,o=0;n=Math.abs(t[0]-r[0]),o=Math.abs(t[1]-r[1]),n=Math.max(o,n),o=Math.abs(t[2]-r[2]),n=Math.max(o,n);var a={};return a.colorfulness=n,a.luminosity=e,a}function ot(t){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function at(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function it(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ut(n.key),n)}}function ct(t,e,r){return(e=ut(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ut(t){var e=function(t,e){if("object"!==ot(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===ot(e)?e:String(e)}var lt=function(t){var e=t.length;if(0<e){for(var r=Array(e),n=0;n<e;n++)r[n]=t[n];return r}return[]},st=function(t,e){for(var r=[],n=0;n<e;n++)r[n]=t;return r},ft={add:function(t,e,r){return r[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r},scale:function(t,e,r){return r[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r},distanceSquared:function(t,e){var r=t[0]-e[0],n=t[1]-e[1],o=t[2]-e[2];return r*r+n*n+o*o},setFromArray:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},createFloat32FromArray:function(t){var e=new Float32Array(3);return ft.setFromArray(e,t),e}};function ht(t,e){if(e===g)return 0;if(e===b){var r=Q.fromRGB(t).toFormat("hsl"),n=r.getChannelRange("saturation");return(r.getChannelValue("saturation")-n.minValue)/(n.maxValue-n.minValue)}return 1}var pt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ct(this,"labs_",void 0),ct(this,"weights_",void 0),ct(this,"bucketToImageSaliencyMap_",void 0),ct(this,"seeds_",void 0),ct(this,"seedWeights_",void 0),ct(this,"seedSaliencyWeights_",void 0),ct(this,"saliency",void 0),this.labs_=[],this.weights_=[],this.bucketToImageSaliencyMap_=void 0,this.seeds_=[],this.seedWeights_=[],this.seedSaliencyWeights_=[],this.saliency=[]}return function(t,e,r){e&&it(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"processImageData",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,n=arguments.length>3?arguments[3]:void 0;return this.computeHistogramFromImageData_(t,e,n),this.selectSeeds_(r),this.clusterColors_(),this.exportPalette_()}},{key:"computeHistogramFromImageData_",value:function(e,r,n){this.labs_=[],this.weights_=st(0,t.HISTOGRAM_SIZE_),n&&(this.bucketToImageSaliencyMap_=st(0,t.HISTOGRAM_SIZE_)),this.saliency=[];for(var o=0;o<t.HISTOGRAM_SIZE_;o++)this.saliency[o]=[-1,0];for(var a=0;a<e.length;a+=4){var i=e[a],c=e[a+1],u=e[a+2],l=ft.createFloat32FromArray(this.rgbToLab(i,c,u)),s=16*(16*Math.floor(i/16)+Math.floor(c/16))+Math.floor(u/16);s in this.labs_?ft.add(this.labs_[s],l,this.labs_[s]):this.labs_[s]=l,this.weights_[s]++,n&&this.bucketToImageSaliencyMap_&&(this.bucketToImageSaliencyMap_[s]+=n.at(Math.floor(a/4))/255),this.saliency[s]=[s,this.saliency[s][1]+ht([i,c,u],r)]}}},{key:"selectSeeds_",value:function(t){this.seeds_=[];for(var e,r=lt(this.weights_),n=this.bucketToImageSaliencyMap_?lt(this.bucketToImageSaliencyMap_):void 0,o=0,a=0;a<t&&0!==r[o=this.getHeaviestIndex_(r,n)];++a)e=this.addSeedByIndex_(o),r[o]=0,this.saliency[o][1]=0,n&&(n[o]=0),this.attenuateWeightsAroundSeed_(r,e,n)}},{key:"clusterColors_",value:function(){if(!this.seeds_.length)throw Error("Please select seeds before clustering");var e=st(0,t.HISTOGRAM_SIZE_),r=[];this.seedWeights_=[],this.seedSaliencyWeights_=[];for(var n=!1,o=0;!n;){for(n=!0,r=[],this.seedWeights_=st(0,this.seeds_.length),this.seedSaliencyWeights_=st(0,this.seeds_.length),o=0;o<t.HISTOGRAM_SIZE_;o++)if(0!==this.weights_[o]){var a=this.getClosestSeedIndex_(o);n&&a!==e[o]&&(n=!1),e[o]=a,this.addColorToSeed_(r,a,o)}this.updateSeedsWithNewSeeds_(r)}}},{key:"exportPalette_",value:function(){if(!this.seeds_.length)throw Error("Please select seeds and get clusters before exporting a new palette");var t,e=[],r=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return at(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?at(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}(this.seeds_);try{for(r.s();!(t=r.n()).done;){var n=t.value,o=this.labToRgb(n[0],n[1],n[2]);e.push(this.rgbToHex(o[0],o[1],o[2]))}}catch(t){r.e(t)}finally{r.f()}return e}},{key:"attenuateWeightsAroundSeed_",value:function(e,r,n){for(var o=0;o<t.HISTOGRAM_SIZE_;o++)if(0<this.weights_[o]){var a=ft.createFloat32FromArray([0,0,0]);ft.scale(this.labs_[o],1/this.weights_[o],a);var i=1-Math.exp(-ft.distanceSquared(r,a)/3650);e[o]*=i,this.saliency[o][1]*=i,n&&(n[o]*=i)}}},{key:"addSeedByIndex_",value:function(t){var e=ft.createFloat32FromArray([0,0,0]);return ft.scale(this.labs_[t],1/this.weights_[t],e),this.seeds_.push(e),e}},{key:"getImportance",value:function(t){return this.weights_[t]>0?this.saliency[t][1]:0}},{key:"getHeaviestIndex_",value:function(e,r){for(var n=0,o=0,a=0;a<t.HISTOGRAM_SIZE_;a++)(r?(1-.8)*e[a]+.8*r[a]:(1-.8)*e[a]+.8*this.getImportance(a))>n&&(n=e[a],o=a);return o}},{key:"addColorToSeed_",value:function(t,e,r){e in t||(t[e]=ft.createFloat32FromArray([0,0,0])),ft.add(t[e],this.labs_[r],t[e]),this.seedWeights_[e]+=this.weights_[r],this.bucketToImageSaliencyMap_&&(this.seedSaliencyWeights_[e]+=this.bucketToImageSaliencyMap_[r])}},{key:"updateSeedsWithNewSeeds_",value:function(t){for(var e=0;e<this.seeds_.length;e++)e in t||(t[e]=ft.createFloat32FromArray([0,0,0])),0===this.seedWeights_[e]?t[e]=ft.createFloat32FromArray([0,0,0]):ft.scale(t[e],1/this.seedWeights_[e],t[e]),this.seeds_[e]=ft.createFloat32FromArray(t[e])}},{key:"getClosestSeedIndex_",value:function(t){var e=ft.createFloat32FromArray(this.labs_[t]);ft.scale(e,1/this.weights_[t],e);for(var r=Number.MAX_SAFE_INTEGER,n=0,o=0;o<this.seeds_.length;o++){var a=ft.distanceSquared(this.seeds_[o],e);a<r&&(r=a,n=o)}return n}},{key:"componentToHex",value:function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}},{key:"rgbToHex",value:function(t,e,r){if(e=+e,r=+r,(t=+t)!=(255&t)||e!==(255&e)||r!==(255&r))throw Error("(".concat(t,", ").concat(e,", ").concat(r,") is not a valid RGB color"));return"#"+this.componentToHex(t)+this.componentToHex(e)+this.componentToHex(r)}},{key:"rgbToLab",value:function(t,e,r){t/=255,e/=255,r/=255;var n=this.rgbToXyz(t,e,r);return this.xyzToLab(n[0],n[1],n[2])}},{key:"labToRgb",value:function(t,e,r){var n=this.labToXyz(t,e,r),o=this.xyzToRgb(n[0],n[1],n[2]);return[Math.min(255,Math.max(0,Math.round(255*o[0]))),Math.min(255,Math.max(0,Math.round(255*o[1]))),Math.min(255,Math.max(0,Math.round(255*o[2])))]}},{key:"xyzToRgb",value:function(t,e,r){var n=3.2406*(t/=100)+-1.5372*(e/=100)+-.4986*(r/=100),o=-.9689*t+1.8758*e+.0415*r,a=.0557*t+-.204*e+1.057*r;return[n=.0031308<n?1.055*Math.pow(n,1/2.4)-.055:12.92*n,o=.0031308<o?1.055*Math.pow(o,1/2.4)-.055:12.92*o,a=.0031308<a?1.055*Math.pow(a,1/2.4)-.055:12.92*a]}},{key:"labToXyz",value:function(e,r,n){var o=(e+16)/116;return[t.REF_X*Math.pow(o+r/500,3),t.REF_Y*Math.pow(o,3),t.REF_Z*Math.pow(o-n/200,3)]}},{key:"xyzToLab",value:function(e,r,n){var o=e/t.REF_X,a=r/t.REF_Y,i=n/t.REF_Z;return[.008856<a?116*Math.pow(a,1/3)-16:903.3*a,500*(this.transformation(o)-this.transformation(a)),200*(this.transformation(a)-this.transformation(i))]}},{key:"rgbToXyz",value:function(t,e,r){return.04045<t?t=Math.pow((t+.055)/1.055,2.4):t/=12.92,.04045<e?e=Math.pow((e+.055)/1.055,2.4):e/=12.92,.04045<r?r=Math.pow((r+.055)/1.055,2.4):r/=12.92,[.4124*(t*=100)+.3576*(e*=100)+.1805*(r*=100),.2126*t+.7152*e+.0722*r,.0193*t+.1192*e+.9505*r]}},{key:"transformation",value:function(t){return.008856<t?Math.pow(t,1/3):7.787*t+16/116}}]),t}();ct(pt,"HISTOGRAM_SIZE_",4096),ct(pt,"REF_X",95.047),ct(pt,"REF_Y",100),ct(pt,"REF_Z",108.883);var vt=pt;function dt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return yt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?yt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function mt(t){return t.map((function(t){return Math.floor(255*t)}))}function gt(t){return t.map((function(t){return t/255}))}function bt(t){var e=dt(mt(t),3),r=e[0],n=e[1],o=e[2];return(new vt).rgbToLab(r,n,o)}function wt(t){var e=dt(t,3),r=e[0],n=e[1],o=e[2];return gt((new vt).labToRgb(r,n,o))}function Ot(t,e){var r=bt(t),n=bt(e),o=dt(r,3),a=o[0],i=o[1],c=o[2],u=dt(n,3),l=u[0],s=u[1],f=u[2];return Math.hypot(a-l,i-s,c-f)}function Et(t){var e=t.toFormat("rgb");return gt([e.getChannelValue("red"),e.getChannelValue("green"),e.getChannelValue("blue")])}function St(t){var e=t.toFormat("rgb");return[e.getChannelValue("red"),e.getChannelValue("green"),e.getChannelValue("blue")]}function jt(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function _t(t,e,r){var n,o,a;if(0===e)n=o=a=r;else{var i=r<.5?r*(1+e):r+e-r*e,c=2*r-i;n=jt(c,i,t+1/3),o=jt(c,i,t),a=jt(c,i,t-1/3)}return[n,o,a]}function xt(t,e,r){var n=Math.max(t,e,r),o=Math.min(t,e,r),a=0,i=0,c=(n+o)/2;if(n===o)a=i=0;else{var u=n-o;switch(i=c>.5?u/(2-n-o):u/(n+o),n){case t:a=(e-r)/u+(e<r?6:0);break;case e:a=(r-t)/u+2;break;case r:a=(t-e)/u+4}a/=6}return{h:a,s:i,l:c}}function Lt(t){var e=t.toString(16);return 1===e.length?"0"+e:e}function At(t){var e=dt(t,3),r=e[0],n=e[1],o=e[2];return"#"+Lt(r)+Lt(n)+Lt(o)}function Ct(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[0,0,0]}function Tt(t){return(Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Pt(n.key),n)}}function It(t,e,r){return(e=Pt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pt(t){var e=function(t,e){if("object"!==Tt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==Tt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===Tt(e)?e:String(e)}var Nt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),It(this,"_flow",void 0),It(this,"_numNodes",void 0),It(this,"_cap",void 0),It(this,"_cost",void 0),It(this,"_found",void 0),It(this,"_dist",void 0),It(this,"_pi",void 0),It(this,"_width",void 0),It(this,"_parent",void 0),this._numNodes=e,this._cap=W(e),this._flow=W(e),this._cost=W(e),this._found=V(e),this._dist=V(e),this._pi=V(e),this._width=V(e),this._parent=q(e,2)}return function(t,e,r){e&&Mt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"addEdge",value:function(t,e,r,n){this._cap[t][e]=r,this._cost[t][e]=n}},{key:"getMaxFlow",value:function(t,e){for(var r=0,n=0;;){var o=this._dijkstra(t,e);if(0===o)break;r+=o;for(var a=e;a!==t;)1===this._parent[a][1]?(this._flow[this._parent[a][0]][a]+=o,n+=o*this._cost[this._parent[a][0]][a]):(this._flow[a][this._parent[a][0]]-=o,n-=o*this._cost[a][this._parent[a][0]]),a=this._parent[a][0]}return[r,n]}},{key:"flow",get:function(){return this._flow}},{key:"_relax",value:function(t,e,r,n,o){var a=this._dist[t]+this._pi[t]-this._pi[e]+n;0!==r&&a<this._dist[e]&&(this._dist[e]=a,this._parent[e]=[t,o],this._width[e]=Math.min(r,this._width[t]))}},{key:"_dijkstra",value:function(t,e){this._found=V(this._numNodes),this._dist=V(this._numNodes).fill(1/0),this._width=V(this._numNodes),this._dist[t]=0,this._width[t]=1/0;for(var r=t;-1!==r;){var n=-1;this._found[r]=1;for(var o=0;o<this._numNodes;o++)1!==this._found[o]&&(this._relax(r,o,this._cap[r][o]-this._flow[r][o],this._cost[r][o],1),this._relax(r,o,this._flow[o][r],-this._cost[o][r],-1),(-1===n||this._dist[o]<this._dist[n])&&(n=o));r=n}for(var a=0;a<this._numNodes;a++)this._pi[a]=Math.min(this._pi[a]+this._dist[a],1/0);return this._width[e]}}]),t}();function Rt(t){return(Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&function(t,e){(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}function Dt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ft(t);if(e){var o=Ft(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(t,e){if(e&&("object"===Rt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function Ft(t){return(Ft=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||Bt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ut(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Bt(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function Bt(t,e){if(t){if("string"==typeof t)return Ht(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ht(t,e):void 0}}function Ht(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Vt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zt(n.key),n)}}function qt(t,e,r){return e&&Wt(t.prototype,e),r&&Wt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function zt(t){var e=function(t,e){if("object"!==Rt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==Rt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===Rt(e)?e:String(e)}var Jt=function(){function t(){Vt(this,t),function(t,e,r){(e=zt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}(this,"_entityColorToUniqueColor",[])}return qt(t,[{key:"_computeFlow",value:function(t,e){for(var r=e.length,n=t.length,o=new Nt(r+n+2),a=0;a<r;a++)o.addEdge(r+n,a,e[a].weight,0);for(var i=r;i<r+n;i++)o.addEdge(i,r+n+1,t[i-r].weight,0);for(var c=0;c<r;c++)for(var u=r;u<r+n;u++){var l=e[c].rgbColor,s=t[u-r].rgbColor,f=Math.floor(100*Ot(l,s));o.addEdge(c,u,1/0,f)}o.getMaxFlow(r+n,r+n+1);for(var h=q(r,n),p=0;p<r;p++)for(var v=r;v<r+n;v++)o.flow[p][v]>0&&(h[p][v-r]=o.flow[p][v]);return h}},{key:"_mixColorsWithFlow",value:function(t,e,r,n){for(var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=[],i=t.length,c=t.map((function(e,r){return t[(r+o)%i].rgbColor})).map(bt),u=0;u<e.length;u++){for(var l=[0,0,0],s=0;s<t.length;s++){var f=r[u][s]/e[u].weight;l=J(l,Y(c[s],f))}var h=mt(wt([n?bt(e[u].rgbColor)[0]:l[0],l[1],l[2]]));a.push(h)}return a}},{key:"_clusterColors",value:function(t){this._entityColorToUniqueColor=V(t.length);for(var e=[],r={},n=new Set,o=0;o<t.length;o++){var a=t[o].hex;n.has(a)?e[r[a]].weight+=t[o].weight:(r[a]=e.length,e.push(Object(U.a)(t[o]))),this._entityColorToUniqueColor[o]=r[a],n.add(a)}return e}},{key:"_matchColorsToEntities",value:function(t){var e,r=[],n=Ut(this._entityColorToUniqueColor);try{for(n.s();!(e=n.n()).done;){var o=e.value;r.push(t[o])}}catch(t){n.e(t)}finally{n.f()}return r}},{key:"_avoidColorCollapse",value:function(t,e){for(var r=new Map,n=t.length,o=0;o<n;o++){var a=At(e[o]);if(r.has(a)){var i=r.get(a);i.push(o),r.set(a,i)}else r.set(a,[o])}var c,u=q(n,3),l=Ut(r);try{for(l.s();!(c=l.n()).done;){var s=Gt(c.value,2),f=(s[0],s[1]);if(f.length>1){var h,p=Ut(f);try{for(p.s();!(h=p.n()).done;){var v=h.value,d=Gt(bt(gt(e[v])),3),y=d[0],m=d[1],g=d[2],b=Gt(bt(gt(t[v])),3),w=b[0];b[1],b[2],y=w,u[v]=mt(wt([y,m,g]))}}catch(t){p.e(t)}finally{p.f()}}else{var O,E=Ut(f);try{for(E.s();!(O=E.n()).done;){var S=O.value;u[S]=e[S]}}catch(t){E.e(t)}finally{E.f()}}}}catch(t){l.e(t)}finally{l.f()}return u}},{key:"recolor",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=this._clusterColors(e),a=this._computeFlow(t,e),i=this._mixColorsWithFlow(t,o,a,!1,n),c=this._avoidColorCollapse(o.map((function(t){return t.rgbColor})).map(mt),i);return this._matchColorsToEntities(c)}}]),t}(),Kt=function(t){kt(r,Jt);var e=Dt(r);function r(){return Vt(this,r),e.apply(this,arguments)}return qt(r,[{key:"_computeFlowHungarian",value:function(t,e){for(var r=e.length,n=t.length,o=new Nt(r+n+2),a=0;a<r;a++)o.addEdge(r+n,a,1,0);for(var i=r;i<r+n;i++)o.addEdge(i,r+n+1,1,0);for(var c=0;c<r;c++)for(var u=r;u<r+n;u++){var l=e[c].rgbColor,s=t[u-r].rgbColor,f=Math.floor(100*Ot(l,s));o.addEdge(c,u,1,f)}o.getMaxFlow(r+n,r+n+1);for(var h=q(r,n),p=0;p<r;p++)for(var v=r;v<r+n;v++)o.flow[p][v]>0&&(h[p][v-r]=o.flow[p][v]);return h}},{key:"_assignColorsWithFlow",value:function(t,e,r){for(var n=e.length,o=t.length,a=[],i=0;i<n;i++)for(var c=0;c<o;c++)r[i][c]>0&&a.push(mt(t[c].rgbColor));return a}},{key:"recolor",value:function(t,e,r){var n=this._clusterColors(e),o=this._computeFlowHungarian(t,n),a=this._assignColorsWithFlow(t,n,o);return this._matchColorsToEntities(a)}}]),r}(),Yt=function(t){kt(r,Jt);var e=Dt(r);function r(){return Vt(this,r),e.apply(this,arguments)}return qt(r,[{key:"_computeFlowWeightedRandom",value:function(t,e){for(var r=e.length,n=t.length,o=new Nt(r+n+2),a=0;a<r;a++)o.addEdge(r+n,a,e[a].weight,0);for(var i=r;i<r+n;i++)o.addEdge(i,r+n+1,t[i-r].weight,0);for(var c=0;c<r;c++)for(var u=r;u<r+n;u++){var l=e[c].rgbColor,s=t[u-r].rgbColor,f=Math.floor(100*Ot(l,s));o.addEdge(c,u,1/0,f)}o.getMaxFlow(r+n,r+n+1);for(var h=q(r,n),p=0;p<r;p++)for(var v=r;v<r+n;v++)o.flow[p][v]>0&&(h[p][v-r]=o.flow[p][v]);for(var d=0;d<r;d++){for(var y=[],m=0,g=0,b=(1-e[d].weight)/n,w=r;w<r+n;w++){var O=Math.max(o.flow[d][w],0);g+=O,y.push(O)}for(var E=0;E<y.length;E++)y[E]/=g,y[E]+=b,m+=y[E];for(var S=0;S<y.length;S++)y[S]/=m;for(var j=this._weightedRand(y)+r,_=r;_<r+n;_++)h[d][_-r]=0,_===j&&(h[d][_-r]=g)}return h}},{key:"_weightedRand",value:function(t){for(var e=0,r=Math.random(),n=0;n<t.length;n++)if(r<=(e+=t[n]))return n;return 0}},{key:"recolor",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=this._clusterColors(e),a=this._computeFlowWeightedRandom(t,e),i=this._mixColorsWithFlow(t,o,a,!0,n);return this._matchColorsToEntities(i)}}]),r}(),Xt=function(t){kt(r,Jt);var e=Dt(r);function r(){return Vt(this,r),e.apply(this,arguments)}return qt(r,[{key:"_computeFlowSqrt",value:function(t,e){for(var r=e.length,n=t.length,o=new Nt(r+n+2),a=0;a<r;a++)o.addEdge(r+n,a,e[a].weight,0);for(var i=r;i<r+n;i++)o.addEdge(i,r+n+1,t[i-r].weight,0);for(var c=0;c<r;c++)for(var u=r;u<r+n;u++){var l=e[c].rgbColor,s=t[u-r].rgbColor,f=Math.floor(100*Ot(l,s));o.addEdge(c,u,1/0,f)}o.getMaxFlow(r+n,r+n+1);for(var h=q(r,n),p=0;p<r;p++)for(var v=r;v<r+n;v++)o.flow[p][v]>0&&(h[p][v-r]=o.flow[p][v]);for(var d=0;d<r;d++){for(var y=[],m=0,g=r;g<r+n;g++){var b=Math.max(o.flow[d][g],0);m+=b,y.push(b)}for(var w=0,O=0;O<y.length;O++)y[O]/=m,y[O]=Math.sqrt(y[O]),w+=y[O];for(var E=0;E<y.length;E++)y[E]/=w,y[E]*=m;for(var S=r;S<r+n;S++)h[d][S-r]=y[S-r]}return h}},{key:"recolor",value:function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=this._clusterColors(e),a=this._computeFlowSqrt(t,e),i=this._mixColorsWithFlow(t,o,a,!1,n);return this._matchColorsToEntities(i)}}]),r}();function Zt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function $t(t,e){console.assert(e<t.length,"Index out of bounds!");var r=t.pop();return t.length!==e&&(t[e]=r),e}function Qt(t,e){var r=t.pop();if(r===e)return t.length;var n=t.indexOf(e);if(-1===n)throw t.push(r),new Error("Removing component that's not present");return t[n]=r,n}function te(t,e,r,n,o){for(var a=0,i=0,c=0;c<o;++c)if(c!==r){i=0;for(var u=0;u<o;++u)u!==n&&(e[a][i]=t[c][u],++i);++a}}function ee(t){for(var e=new ArrayBuffer(t*t*4),r=[],n=0;n<t;++n)r[n]=new Float32Array(e,n*t<<2,t);return r}function re(t,e){if(1===e)return t[0][0];if(2===e)return t[0][0]*t[1][1]-t[0][1]*t[1][0];if(3===e)return t[0][0]*t[1][1]*t[2][2]+t[0][1]*t[1][2]*t[2][0]+t[0][2]*t[1][0]*t[2][1]-t[0][2]*t[1][1]*t[2][0]-t[0][1]*t[1][0]*t[2][2]-t[0][0]*t[1][2]*t[2][1];for(var r=1,n=0,o=ee(e-1),a=0;a<e;++a)te(t,o,0,a,e),n+=r*t[0][a]*re(o,e-1),r=-r;return n}function ne(t,e){var r,n=t.length,o=t[0],a=[];e=null!==(r=e)&&void 0!==r?r:new Float32Array(n+1);for(var i=1;i<n;++i){for(var c=t[i],u=[],l=0;l<n;++l)u[l]=o[l]-c[l];a.push(u)}return function(t,e){var r,n=t[0].length;if(e=null!==(r=e)&&void 0!==r?r:new Float32Array(n),3===n){var o=t[0],a=t[1],i=o[0],c=o[1],u=o[2],l=a[0],s=a[1],f=a[2];e[0]=c*f-u*s,e[1]=u*l-i*f,e[2]=i*s-c*l}else for(var h=n%2?-1:1,p=ee(n-1),v=0;v<n;++v)te(t,p,n-1,v,n),e[v]=h*re(p,n-1),h=-h}(a,e),e[n]=-function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;-1===r&&(r=t.length);for(var n=t[0]*e[0],o=1;o<r;++o)n+=t[o]*e[o];return n}(o,e,n),function(t){for(var e=t.length,r=t[0]*t[0],n=1;n<e-1;++n)r+=t[n]*t[n];if(0===r)return t;r=1/Math.sqrt(r);for(var o=0;o<e;++o)t[o]*=r}(e),e}function oe(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;-1===r&&(r=t.length);for(var n=e[r],o=0;o<r;++o)n+=t[o]*e[o];return n}function ae(t){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ie(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ce(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,se(n.key),n)}}function ue(t,e,r){return e&&ce(t.prototype,e),r&&ce(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function le(t,e,r){return(e=se(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function se(t){var e=function(t,e){if("object"!==ae(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===ae(e)?e:String(e)}var fe=function(){function t(e){ie(this,t),le(this,"verts",[]),le(this,"neighbor",void 0),le(this,"opposite",void 0),le(this,"facet",void 0),le(this,"_plane",void 0),this.facet=e}return ue(t,[{key:"getPlane",value:function(t){return this._plane||(this._plane=ne(this.verts.map((function(e){return t[e]})))),this._plane}}]),t}(),he=ue((function t(){ie(this,t),le(this,"ridges",[]),le(this,"plane",void 0),le(this,"verts",[]),le(this,"meta",void 0)}));function pe(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return ve(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ve(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function ve(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function de(t,e,r){var n,o=e.verts,a=o.length,i=pe(r);try{for(i.s();!(n=i.n()).done;){var c,u=pe(n.value.ridges);try{for(u.s();!(c=u.n()).done;){var l=c.value;if(!l.neighbor){for(var s=!0,f=0;f<a;++f)s=s&&l.verts.includes(o[f]);if(s)return e.neighbor=l,void(l.neighbor=e)}}}catch(t){u.e(t)}finally{u.f()}}}catch(t){i.e(t)}finally{i.f()}}function ye(t,e,r,n){var o=t.ridges.map((function(t){return e[t.verts[0]]})),a=t.plane=ne(o);if(n&&oe(n,a,r)>0){!function(t){for(var e=t.length,r=0;r<e;++r)t[r]=-t[r]}(a),t.verts.reverse(),t.ridges.reverse();var i,c=pe(t.ridges);try{for(c.s();!(i=c.n()).done;)i.value.verts.reverse()}catch(t){c.e(t)}finally{c.f()}}}function me(t,e,r){for(var n=t.verts,o=t.ridges.length;o<r;++o){for(var a=new fe(t),i=0;i<r-1;++i)a.verts[i]=n[(o+i)%r];a.opposite=n[(o+r)%r],de(0,a,e),t.ridges.push(a)}}function ge(t,e,r,n,o,a){var i=new he;return i.verts=t.verts.concat([e]),i.ridges.push(t),t.facet=i,t.opposite=e,me(i,n,a),ye(i,r,a,o),i}function be(t){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function we(t){return function(t){if(Array.isArray(t))return Se(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ee(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oe(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Ee(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function Ee(t,e){if(t){if("string"==typeof t)return Se(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Se(t,e):void 0}}function Se(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function je(t,e,r){return(e=_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _e(t){var e=function(t,e){if("object"!==be(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==be(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===be(e)?e:String(e)}var xe=function(t,e,r){return Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),je(this,"outsideSet",[]),je(this,"outsideDist",[]),je(this,"currentPoint",void 0)}));function Le(t){var e=t.meta,r=e.outsideSet,n=e.outsideDist,o=r.length;if(0===o)return-1;for(var a=r[0],i=n[0],c=1;c<o;++c)n[c]>i&&(i=n[c],a=r[c]);return a}function Ae(t,e,r,n){for(var o=r.map((function(t){return[]})),a=t.length,i=0;i<a;++i){var c,u=t[i],l=e[u],s=Oe(r);try{for(s.s();!(c=s.n()).done;){var f=c.value,h=oe(l,f.plane,n);if(h>1e-4){var p=f.meta;p.outsideSet.push(u),p.outsideDist.push(h);break}}}catch(t){s.e(t)}finally{s.f()}}return o}function Ce(t,e,r,n,o){r.push(e),e.meta.currentPoint=t;var a,i=Oe(e.ridges);try{for(i.s();!(a=i.n()).done;){var c,u=a.value,l=null===(c=u.neighbor)||void 0===c?void 0:c.facet;l.meta.currentPoint!==t&&(oe(t,l.plane,o)>1e-4?Ce(t,l,r,n,o):n.push(u))}}catch(t){i.e(t)}finally{i.f()}}function Te(t,e,r,n,o){var a,i=[],c=Oe(r);try{for(c.s();!(a=c.n()).done;){var u=ge(a.value,e,t,i,n,o);u.meta=new xe,i.push(u)}}catch(t){c.e(t)}finally{c.f()}return i}function Me(t,e,r,n){for(var o=r[t],a=r[e],i=0;i<n;++i){if(o[i]<a[i])return e;if(o[i]>a[i])return t}return e}function Ie(t,e,r,n){for(var o=r[t],a=r[e],i=0;i<n;++i){if(o[i]>a[i])return e;if(o[i]<a[i])return t}return e}function Pe(t){var e=t.length,r=function(t){return t.length}(t[0]);if(e<=r)throw new Error("A convex hull in ".concat(r," dimensions requires at least ").concat(r+1," points."));for(var n=[],o=0;o<e;++o)n.push(o);var a,i=function(t,e){for(var r=t.length,n=0,o=0,a=1;a<r;++a)o=Me(a,o,t,e),n=Ie(a,n,t,e);for(var i=[n,o],c=[t[n],t[o]],u=2;u<e+1;++u){for(var l=ne(c),s=-1/0,f=-1,h=0;h<r;++h){var p=Math.abs(oe(t[h],l,u));p>s&&(s=p,f=h)}i.push(f),c.push(t[f])}return i}(t,r),c=function(t,e,r){var n=t[e?e[0]:0],o=n.length,a=e?e.length:o+1;if(r)for(var i=0;i<o;++i)r[i]=n[i];else r=n.slice();for(var c=0;c<o;++c){for(var u=1;u<a;++u){var l=e?e[u]:u;r[c]+=t[l][c]}r[c]/=a}return r}(t,i),u=function(t,e){for(var r=t[0].length,n=r+1,o=[],a=0;a<=r;++a){for(var i=new he,c=0;c<r;++c){var u=(a+c)%n;i.verts[c]=e?e[u]:u}me(i,o,r);var l=(a+r)%(r+1);ye(i,t,r,t[e?e[l]:l]),o.push(i)}return o}(t,i),l=Oe(u);try{for(l.s();!(a=l.n()).done;)a.value.meta=new xe}catch(t){l.e(t)}finally{l.f()}!function(t,e){var r,n=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Zt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Zt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}(e.slice().sort((function(t,e){return e-t})));try{for(n.s();!(r=n.n()).done;)$t(t,r.value)}catch(t){n.e(t)}finally{n.f()}}(n,i),function(t){for(var e,r,n=t.length;0!==n;)r=Math.floor(Math.random()*n),e=t[n-=1],t[n]=t[r],t[r]=e}(n),Ae(n,t,u,r);for(var s=!1;!s;){s=!0;for(var f=0;f<u.length;++f){var h=u[f],p=Le(h);if(-1!==p){Qt(h.meta.outsideSet,p);var v=[],d=[];Ce(t[p],h,v,d,r);for(var y=Te(t,p,d,c,r),m=0,g=v;m<g.length;m++){var b=g[m];Qt(u,b)<=f&&--f,Ae(b.meta.outsideSet,t,y,r),b.meta.outsideSet.length>0&&(s=!1)}u.push.apply(u,we(y))}}}var w,O=Oe(u);try{for(O.s();!(w=O.n()).done;)w.value.meta=void 0}catch(t){O.e(t)}finally{O.f()}return u}function Ne(t){return(Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Re(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,De(n.key),n)}}function ke(t,e,r){return(e=De(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function De(t){var e=function(t,e){if("object"!==Ne(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==Ne(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===Ne(e)?e:String(e)}function Fe(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Ge(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ge(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function Ge(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Ue={sub:function(t,e){for(var r=[],n=0;n<t.length;++n)r.push(t[n]-e[n]);return r},add:function(t,e){for(var r=[],n=0;n<t.length;++n)r.push(t[n]+e[n]);return r},mult:function(t,e){for(var r=[],n=0;n<t.length;++n)r.push(t[n]*e[n]);return r},multScalar:function(t,e){var r,n=[],o=Fe(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;n.push(a*e)}}catch(t){o.e(t)}finally{o.f()}return n},divScalar:function(t,e){var r,n=[],o=Fe(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;n.push(a/e)}}catch(t){o.e(t)}finally{o.f()}return n},neg:function(t){return this.multScalar(t,-1)},cross:function(t,e){var r=[];return r.push(t[1]*e[2]-t[2]*e[1]),r.push(t[2]*e[0]-t[0]*e[2]),r.push(t[0]*e[1]-t[1]*e[0]),r},dot:function(t,e){for(var r=0,n=0;n<t.length;++n)r+=t[n]*e[n];return r},l2:function(t,e){return this.norm(this.sub(t,e))},norm:function(t){return Math.sqrt(this.dot(t,t))},signed:function(t,e,r,n){var o=this.sub(e,t),a=this.sub(r,t),i=this.cross(o,a);return Math.sign(this.dot(i,this.sub(n,t)))},area:function(t,e,r){var n=this.sub(e,t),o=this.sub(r,t);return.5*this.norm(this.cross(n,o))},insideTriangle:function(t,e,r,n){var o=this.area(t,e,n),a=this.area(e,r,n),i=this.area(r,t,n),c=this.area(t,e,r);return Math.abs(o+a+i-c)<1e-4},closest2line:function(t,e,r){var n=this.sub(e,t),o=this.norm(n);if(o<1e-4)return t;var a=this.divScalar(n,o),i=this.dot(a,this.sub(r,t));return 0<=i&&i<=o?this.add(t,this.multScalar(a,i)):i<0?t:e},closest2triangle:function(t,e,r,n){var o=this.sub(e,t),a=this.sub(r,t),i=this.cross(o,a),c=this.norm(i);if(c<1e-4)return this.closest2line(t,e,n);i=this.divScalar(i,c);var u=this.dot(i,this.sub(n,t)),l=this.sub(n,this.multScalar(i,u));if(this.insideTriangle(t,e,r,l))return l;var s=[this.closest2line(t,e,n),this.closest2line(e,r,n),this.closest2line(r,t,n)],f=[this.l2(s[0],n),this.l2(s[1],n),this.l2(s[2],n)];return s[f.indexOf(Math.min.apply(Math,f))]}},Be=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ke(this,"vertices",void 0),ke(this,"triangles",void 0),ke(this,"com",void 0),this.vertices=e;var r,n=[0,0,0],o=Fe(e);try{for(o.s();!(r=o.n()).done;){var a=r.value;n=Ue.add(n,a)}}catch(t){o.e(t)}finally{o.f()}this.com=Ue.divScalar(n,e.length),this.triangles=this.constructSimplices(e)}return function(t,e,r){e&&Re(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"constructSimplices",value:function(t){var e,r=[],n=Fe(Pe(t));try{for(n.s();!(e=n.n()).done;){var o=e.value.verts;r.push([t[o[0]],t[o[1]],t[o[2]]])}}catch(t){n.e(t)}finally{n.f()}return r}},{key:"isHullTriangle",value:function(t,e,r){var n,o=Ue.signed(t,e,r,this.com),a=Fe(this.vertices);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(o*Ue.signed(t,e,r,i)<0)return!1}}catch(t){a.e(t)}finally{a.f()}return!0}},{key:"insideHull",value:function(t){var e,r=Fe(this.triangles);try{for(r.s();!(e=r.n()).done;){var n=e.value;if(Ue.signed(n[0],n[1],n[2],t)*Ue.signed(n[0],n[1],n[2],this.com)<0)return!1}}catch(t){r.e(t)}finally{r.f()}return!0}},{key:"project",value:function(t,e){if(e&&console.log("Point in Hull ",t," result:= ",this.insideHull(t)),this.insideHull(t))return t;var r,n=[],o=[],a=Fe(this.triangles);try{for(a.s();!(r=a.n()).done;){var i=r.value,c=Ue.closest2triangle(i[0],i[1],i[2],t);o.push(c),n.push(Ue.l2(c,t))}}catch(t){a.e(t)}finally{a.f()}return e&&console.log("L2s:",n),o[n.indexOf(Math.min.apply(Math,n))]}}]),t}();var He=r(1186);function Ve(t){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function We(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ze(n.key),n)}}function qe(t,e,r){return(e=ze(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ze(t){var e=function(t,e){if("object"!==Ve(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==Ve(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===Ve(e)?e:String(e)}function Je(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Ke(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ke(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function Ke(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Ye={mean:function(t){return 0===t.length?0:t.reduce((function(t,e){return t+e}))/t.length},var:function(t){if(0===t.length)return 0;var e=this.mean(t),r=t.map((function(t){var r=t-e;return r*r}));return this.mean(r)},cov:function(t,e){var r=t.length;if(e.length!==r||r<1)return 0;for(var n=this.mean(t),o=this.mean(e),a=0,i=0;i<r;i++)a+=(n-t[i])*(o-e[i]);return a/r},covMat:function(t,e,r){return[[this.var(t),this.cov(t,e),this.cov(t,r)],[this.cov(t,e),this.var(e),this.cov(e,r)],[this.cov(t,r),this.cov(e,r),this.var(r)]]},mult4x4:function(t,e){for(var r=W(4),n=0;n<4;++n)for(var o=0;o<4;++o){r[n][o]=0;for(var a=0;a<4;++a)r[n][o]=r[n][o]+t[n][a]*e[a][o]}return r},mult4x1:function(t,e){for(var r=[0,0,0,0],n=0;n<4;++n)for(var o=0;o<4;++o)r[n]=r[n]+t[n][o]*e[o];return r},svd:function(t){for(var e=Object(He.SVD)(t),r=e.u,n=e.q,o=JSON.parse(JSON.stringify(r)),a=JSON.parse(JSON.stringify(n)),i=0;i<o.length;++i)r[i][0]=-o[i][2],r[i][2]=-o[i][0];return n[0]=a[2],n[2]=a[0],{u:r,q:n}},dot:function(t,e){for(var r=0,n=0;n<t.length;++n)r+=t[n]*e[n];return r},cross:function(t,e){var r,n=[],o=Je(t);try{for(o.s();!(r=o.n()).done;){var a,i=r.value,c=[],u=Je(e);try{for(u.s();!(a=u.n()).done;){var l=a.value;c.push(i*l)}}catch(t){u.e(t)}finally{u.f()}n.push(c)}}catch(t){o.e(t)}finally{o.f()}return n},col:function(t,e){var r,n=[],o=Je(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;n.push(a[e])}}catch(t){o.e(t)}finally{o.f()}return n},abs2:function(t){var e,r=Je(t);try{for(r.s();!(e=r.n()).done;){var n,o=Je(e.value);try{for(o.s();!(n=o.n()).done;){var a=n.value;a=Math.abs(a)}}catch(t){o.e(t)}finally{o.f()}}}catch(t){r.e(t)}finally{r.f()}return t},abs:function(t){for(var e=0;e<t.length;++e)t[e]=Math.abs(t[e]);return t},add:function(t,e){for(var r=[],n=0;n<t.length;++n){for(var o=[],a=0;a<t[n].length;++a)o.push(t[n][a]*e[n][a]);r.push(o)}return r},sqrt:function(t){for(var e=0;e<t.length;++e)t[e]=Math.sqrt(t[e]);return t},sqrt2:function(t){for(var e=0;e<t.length;++e)t[e]=this.sqrt(t[e]);return t},clamp:function(t){return t<0?0:t>1?1:t}},Xe=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),qe(this,"src",void 0),qe(this,"trg",void 0),qe(this,"oriTrg",void 0),this.src=[new Float32Array,new Float32Array,new Float32Array],this.trg=[new Float32Array,new Float32Array,new Float32Array],this.oriTrg=[new Float32Array,new Float32Array,new Float32Array]}return function(t,e,r){e&&We(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"fromImage",value:function(t){for(var e=t.length/4,r=[new Float32Array(e),new Float32Array(e),new Float32Array(e)],n=0;n<t.length;n+=4){var o=n/4;r[0][o]=t[n],r[1][o]=t[n+1],r[2][o]=t[n+2]}return r}},{key:"load",value:function(t,e){this.src=this.fromImage(t),this.trg=this.fromImage(e)}},{key:"loadFromPalette",value:function(t,e){var r,n=[],o=Je(t);try{for(o.s();!(r=o.n()).done;)for(var a=r.value,i=0;i<Math.ceil(1e3*a.weight);++i)n.push(a.rgbColor)}catch(t){o.e(t)}finally{o.f()}for(var c=0;c<3;++c){this.src[c]=new Float32Array(n.length);for(var u=0;u<n.length;++u)this.src[c][u]=n[u][c]}n=[];var l,s=Je(e);try{for(s.s();!(l=s.n()).done;)for(var f=l.value,h=0;h<Math.ceil(1e3*f.weight);++h)n.push(f.rgbColor)}catch(t){s.e(t)}finally{s.f()}for(var p=0;p<3;++p){this.trg[p]=new Float32Array(n.length);for(var v=0;v<n.length;++v)this.trg[p][v]=n[v][p]}for(var d=0;d<3;++d){this.oriTrg[d]=new Float32Array(e.length);for(var y=0;y<e.length;++y)this.oriTrg[d][y]=e[y].rgbColor[d]}}},{key:"matchColumns",value:function(t,e,r,n){for(var o=0,a=0,i=[[0,1,2],[0,2,1],[1,0,2],[1,2,0],[2,0,1],[2,1,0]],c=0;c<6;++c){var u=i[c][0],l=i[c][1],s=i[c][2],f=Ye.dot(Ye.col(t,u),Ye.col(r,0)),h=Ye.dot(Ye.col(t,l),Ye.col(r,1)),p=Ye.dot(Ye.col(t,s),Ye.col(r,2)),v=Math.abs(f)+Math.abs(h)+Math.abs(p);v>o&&(o=v,a=c)}for(var d=i[a][0],y=i[a][1],m=i[a][2],g=JSON.parse(JSON.stringify(e)),b=JSON.parse(JSON.stringify(t)),w=Ye.dot(Ye.col(b,d),Ye.col(r,0)),O=Ye.dot(Ye.col(b,y),Ye.col(r,1)),E=Ye.dot(Ye.col(b,m),Ye.col(r,2)),S=0;S<t.length;++S)t[S][0]=b[S][d]*Math.sign(w),t[S][1]=b[S][y]*Math.sign(O),t[S][2]=b[S][m]*Math.sign(E);return e[0]=g[d],e[1]=g[y],e[2]=g[m],{Us:t,As:Ye.sqrt(e),Ut:r,At:Ye.sqrt(n)}}},{key:"transfer",value:function(){if(this.oriTrg[0].length<=1&&this.src[0].length>0){var t=[],e=[this.src[0][0],this.src[1][0],this.src[2][0]];return t.push([255*Ye.clamp(e[0]),255*Ye.clamp(e[1]),255*Ye.clamp(e[2])]),console.log("ColourTransferInCorrelatedSpace: Traget length is %d, hence bugging out.",this.oriTrg[0].length),t}var r=Ye.covMat(this.src[0],this.src[1],this.src[2]),n=[Ye.mean(this.src[0]),Ye.mean(this.src[1]),Ye.mean(this.src[2])],o=[[1,0,0,n[0]],[0,1,0,n[1]],[0,0,1,n[2]],[0,0,0,1]],a=Ye.svd(r),i=a.u,c=a.q,u=[Ye.mean(this.trg[0]),Ye.mean(this.trg[1]),Ye.mean(this.trg[2])],l=Ye.covMat(this.trg[0],this.trg[1],this.trg[2]),s=[[1,0,0,-u[0]],[0,1,0,-u[1]],[0,0,1,-u[2]],[0,0,0,1]],f=Ye.svd(l),h=f.u,p=f.q,v=this.matchColumns(i,c,h,p);i=v.Us,c=v.As,h=v.Ut,p=v.At;for(var d=[[i[0][0],i[0][1],i[0][2],0],[i[1][0],i[1][1],i[1][2],0],[i[2][0],i[2][1],i[2][2],0],[0,0,0,1]],y=[[h[0][0],h[1][0],h[2][0],0],[h[0][1],h[1][1],h[2][1],0],[h[0][2],h[1][2],h[2][2],0],[0,0,0,1]],m=[[c[0],0,0,0],[0,c[1],0,0],[0,0,c[2],0],[0,0,0,1]],g=[[1/p[0],0,0,0],[0,1/p[1],0,0],[0,0,1/p[2],0],[0,0,0,1]],b=Ye.mult4x4(o,d),w=Ye.mult4x4(b,m),O=Ye.mult4x4(w,g),E=Ye.mult4x4(O,y),S=Ye.mult4x4(E,s),j=[],_=0;_<this.oriTrg[0].length;++_){var x=[this.oriTrg[0][_],this.oriTrg[1][_],this.oriTrg[2][_],1],L=Ye.mult4x1(S,x);j.push([255*Ye.clamp(L[0]),255*Ye.clamp(L[1]),255*Ye.clamp(L[2])])}return j}}]),t}(),Ze=r(1187),$e=r.n(Ze),Qe=r(1553),tr=r(1593);function er(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||nr(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rr(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=nr(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function nr(t,e){if(t){if("string"==typeof t)return or(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?or(t,e):void 0}}function or(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ar(t){var e=z(t);return t.map((function(t){return t/e}))}function ir(t,e,r,n,o){return t[e*o[0]+r*o[1]+n]}function cr(t,e,r,n,o,a){e[r*a[0]+n*a[1]+o]=t}function ur(t,e,r,n,o){return t[e*(o[0]/4)+r*(o[1]/4)+n]}function lr(t,e,r,n,o,a){e[r*(a[0]/4)+n*(a[1]/4)+o]=t}var sr=r(1554);function fr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return hr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?hr(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var pr="undefined"==typeof DOMParser;function vr(t){try{var e=(pr?new sr.DOMParser:new DOMParser).parseFromString(t,m);if("svg"===e.documentElement.nodeName.toLowerCase())return e}catch(t){console.error(t)}}function dr(t,e){var r=!1,n=t.children;if(void 0===n&&pr&&void 0!==t.childNodes&&(n=t.childNodes),n)for(var o=0;o<n.length;++o){var a=n.item(o),i=!0;if(e){var c=fr(e(a),2);i=c[0],r=c[1]}if(!r&&i&&(r=dr(a,e)),r)break}return r}function yr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return mr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mr(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function gr(t){var e=document.createElement("style");e.type="text/css",e.appendChild(document.createTextNode(t)),document.head.appendChild(e);var r=e.sheet;return e.remove(),r}function br(t){return!(null===t||t.toLowerCase().includes("url")||"none"===t.trim().toLowerCase())}function wr(t){return!["animate","animateMotion","animateTransform","set","clipPath"].includes(t.tagName)}function Or(t,e){var r=bt(e)[0],n=yr(bt(t),3);return n[0],wt([r,n[1],n[2]])}function Er(t,e,r,n){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=xr(t),i=a.map((function(t){var e=yr(t,3),r=e[0],n=e[1],o=e[2];return Q.fromRGB([r,n,o])})).map((function(t){return n?n(t):Q.randomColor()})).map((function(t){return Q.toRGB(t)})),c=i.map((function(t){var e=yr(t,3),r=e[0],n=e[1],o=e[2];return Q.fromRGB([r,n,o])}));o&&(c=function(t,e,r,n){var o=t.length;if(o<500){for(var a=[0,0,0],i=W(o),c=t.map(gt),u=0;u<o;u++)for(var l=u+1;l<o;l++)i[u][l]=Ot(c[u],c[l]);for(var s=e.map(gt),f=0;f<o;f++)if(!n.preserveBlackAndWhite||!(et(c[f])||rt(c[f])||no(c[f],a,.08)))for(var h=f+1;h<o;h++)if(Ot(s[f],s[h])<30&&i[f][h]>15){var p=Or(s[f],c[f]),v=Or(s[h],c[h]);e[f]=mt(p),e[h]=mt(v)}}return e.map((function(t){var e=yr(t,3),r=e[0],n=e[1],o=e[2];return Q.fromRGB([r,n,o])}))}(a,i,0,e));var u=function(t,e){return c[e]},l=0;return dr(t,(function(t){return wr(t)&&["color","fill","stroke","stop-color","flood-color","lighting-color","text-decoration-color","solid-color"].forEach((function(e){var r=t.getAttribute(e);r&&br(r)&&(t.setAttribute(e,u(0,l).toString("hex")),l+=1);var n=t.style;if(n){var o=n.getPropertyValue(e);o&&br(o)&&(n.setProperty(e,u(0,l).toString("hex")),l+=1)}if("style"===t.tagName){var a=t,i=a.sheet;if(i||a.innerHTML&&a.innerHTML.length>0&&(i=gr(a.innerHTML)),i){for(var c="",s=0,f=Array.from(i.cssRules);s<f.length;s++){var h=f[s],p=h,v=p.style.getPropertyValue(e);v&&br(v)&&(p.style.setProperty(e,u(0,l).toString("hex")),l+=1),c=c+h.cssText+"\n"}a.innerHTML=c}}})),"clipPath"===t.tagName?[!1,!1]:[!0,!1]})),(new XMLSerializer).serializeToString(t)}function Sr(t,e,r,n){var o=vr(t);if(void 0===o)throw Error("invalid raw svg string");return Er(o,n,!1,(function(t){return function(t,e){var r=Q.toRGB(t),n=new Ze.Mat(1,1,$e.a.CV_8UC3,new $e.a.Scalar(r[2],r[1],r[0])),o=n.clone(),a=new $e.a.MatVector;$e.a.cvtColor(n,o,$e.a.COLOR_BGR2HSV_FULL),$e.a.split(o,a);var i=a.get(2),c=i.data,u=i.step;cr(e[ir(c,0,0,0,u)],c,0,0,0,u);var l=n;$e.a.merge(a,l),$e.a.cvtColor(l,l,$e.a.COLOR_HSV2RGB_FULL);var s=l.data,f=l.step,h=ir(s,0,0,0,f),p=ir(s,0,0,1,f),v=ir(s,0,0,2,f);return n.delete(),o.delete(),a.delete(),Q.fromRGB([h,p,v])}(t,e)}),r,!1)}function jr(t,e,r,n,o,a){var i=vr(t);if(void 0===i)throw Error("invalid raw svg string");var c=e.map((function(t){return bt(gt(Q.toRGB(t)))})),u=r.map((function(t){return bt(gt(Q.toRGB(t)))}));return Er(i,o,a,(function(t){return function(t,e,r,n,o,a,i){for(var c=t.length,u=[],l=0;l<c;l++)u.push([i[l][0]-a[l][0],i[l][1]-a[l][1],i[l][2]-a[l][2]]);var s=1/c,f=[],h=0,p=Q.toRGB(r),v=bt(gt(p)),d=gt(p);if(n.preserveBlackAndWhite&&(rt(d)||no(d,[0,0,0],.08)))return r;if(n.preserveBlackAndWhite&&et(d))return r;for(var y=0;y<c;++y){var m=0,g=0;m+=(g=v[0]-a[y][0])*g,m+=(g=v[1]-a[y][1])*g,m+=(g=v[2]-a[y][2])*g;var b=1/(Math.sqrt(m)+1e-4);f.push(b),h+=b}if(h>0)for(var w=0;w<c;++w)f[w]/=h;else for(var O=0;O<c;++O)f[O]=s;for(var E=0,S=0,j=0,_=0;_<c;++_)E+=f[_]*(v[0]+u[_][0]),S+=f[_]*(v[1]+u[_][1]),j+=f[_]*(v[2]+u[_][2]);var x=mt(wt([E,S,j]));return o&&(x=function(t){var e=dt(bt(gt(t)),3),r=e[0];return e[1],e[2],mt(wt([r,0,0]))}(x)),Q.fromRGB([x[0],x[1],x[2]])}(e,0,t,o,n,c,u)}),n)}function _r(t){var e=vr(t);if(void 0===e)throw Error("invalid raw svg string");return xr(e)}function xr(t){var e=[];return dr(t,(function(t){return wr(t)&&["color","fill","stroke","stop-color","flood-color","lighting-color","text-decoration-color","solid-color"].forEach((function(r){var n=t.getAttribute(r);n&&br(n)&&e.push(Q.toRGB(Q.getColorFromCSSColor(n)));var o=t.style;if(o){var a=o.getPropertyValue(r);a&&br(a)&&e.push(Q.toRGB(Q.getColorFromCSSColor(a)))}if("style"===t.tagName){var i=t,c=i.sheet;if(c||i.innerHTML&&i.innerHTML.length>0&&(c=gr(i.innerHTML)),c)for(var u=0,l=Array.from(c.cssRules);u<l.length;u++){var s=l[u].style.getPropertyValue(r);s&&br(s)&&e.push(Q.toRGB(Q.getColorFromCSSColor(s)))}}})),"clipPath"===t.tagName?[!1,!1]:[!0,!1]})),e}var Lr=r(813);function Ar(t){return(Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cr(){Cr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var a=e&&e.prototype instanceof y?e:y,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:_(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var h="suspendedStart",p="executing",v="completed",d={};function y(){}function m(){}function g(){}var b={};l(b,i,(function(){return this}));var w=Object.getPrototypeOf,O=w&&w(w(T([])));O&&O!==r&&n.call(O,i)&&(b=O);var E=g.prototype=y.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==Ar(s)&&n.call(s,"__await")?e.resolve(s.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(s).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function _(e,r,n){var o=h;return function(a,i){if(o===p)throw new Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(e,r,n);if("normal"===l.type){if(o=n.done?v:"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=v,n.method="throw",n.arg=l.arg)}}}function x(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,d;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ar(e)+" is not iterable")}return m.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=l(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(j.prototype),l(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(s(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(E),l(E,u,"Generator"),l(E,i,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),d}},e}function Tr(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function Mr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Tr(a,n,o,i,c,"next",t)}function c(t){Tr(a,n,o,i,c,"throw",t)}i(void 0)}))}}function Ir(t){return new TextDecoder("iso-8859-1").decode(t)}var Pr="\n <style> svg * { fill: #000000; } \x3c!-- Firefly, Recolor, SVG Default Style --\x3e </style> \n";function Nr(t){return Rr.apply(this,arguments)}function Rr(){return(Rr=Mr(Cr().mark((function t(e){return Cr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Ir,t.next=3,e.arrayBuffer();case 3:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function kr(t){var e=t;return function(t){return t.includes(Pr)}(t)||(e=Pr+t),e}function Dr(t){return dr(t,(function(t){return wr(t)&&["fill"].forEach((function(e){if(t.hasAttribute(e)){var r=t.getAttribute(e);if(t.hasAttribute("style")){var n=t.style,o=n.getPropertyValue(e);o&&br(o)||n.setProperty(e,r)}else t.removeAttribute(e),t.setAttribute("style",e+":"+String(r))}})),[!0,!1]})),t}function Fr(t){return Gr.apply(this,arguments)}function Gr(){return(Gr=Mr(Cr().mark((function t(e){var r;return Cr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Ur,t.next=3,Nr(e);case 3:return t.t1=t.sent,t.next=6,(0,t.t0)(t.t1);case 6:return r=t.sent,t.abrupt("return",r);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ur(t){return Br.apply(this,arguments)}function Br(){return(Br=Mr(Cr().mark((function t(e){var r,n,o,a,i,c,u,l,s,f,h,p,v,d,y,g;return Cr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=new DOMParser,n=r.parseFromString(e,m),o=document.createElement("div"),a=Object(Lr.a)(),o.id=a,o.append(n.documentElement),document.documentElement.prepend(o),o=document.getElementById(a),t.prev=8,u=null===(i=o)||void 0===i?void 0:i.querySelector("svg"),null===(c=u)||void 0===c||!c.viewBox){t.next=36;break}if(0!==u.viewBox.baseVal.width&&0!==u.viewBox.baseVal.height||(s=u.getBBox(),u.viewBox.baseVal.x=s.x,u.viewBox.baseVal.y=s.y,u.viewBox.baseVal.width=s.width,u.viewBox.baseVal.height=s.height),f=u.viewBox.baseVal.width,h=u.viewBox.baseVal.height,!(f<=0||h<=0)){t.next=16;break}throw Error("Error while processing input svg");case 16:return u.width.baseVal.valueAsString="".concat(f,"px"),u.height.baseVal.valueAsString="".concat(h,"px"),p=new XMLSerializer,v=p.serializeToString(u),u.innerHTML=kr(u.innerHTML),u=Dr(u),d=p.serializeToString(u),y=zr(v),null===(l=o)||void 0===l||l.remove(),t.t0=v,t.t1=d,t.t2=y,t.t3=u.viewBox.baseVal.width,t.t4=u.viewBox.baseVal.height,t.next=32,Wr(y,512,512);case 32:return t.t5=t.sent,t.abrupt("return",{svg:t.t0,svgWithDefaultStyleApplied:t.t1,svgDataUrl:t.t2,width:t.t3,height:t.t4,svgImage512:t.t5});case 36:throw Error("Error while processing input svg");case 37:return t.prev=37,null===(g=o)||void 0===g||g.remove(),t.finish(37);case 40:case"end":return t.stop()}}),t,null,[[8,,37,40]])})))).apply(this,arguments)}function Hr(t,e,r){return Vr.apply(this,arguments)}function Vr(){return(Vr=Mr(Cr().mark((function t(e,r,n){var o,a;return Cr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=zr(e),t.next=3,Wr(o,r,n);case 3:return a=t.sent,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Wr(t,e,r){return qr.apply(this,arguments)}function qr(){return(qr=Mr(Cr().mark((function t(e,r,n){return Cr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(void 0!==n&&void 0!==r&&n<r||void 0!==n&&n<=0||void 0!==r&&r<=0)){t.next=2;break}throw Error("Invalid arguments minWidthOrHeight:".concat(void 0!==r?r:"undefined"," and maxWidthOrHeight:").concat(void 0!==n?n:"undefined"));case 2:return t.abrupt("return",new Promise((function(t,o){var a=new Image;a.src=e,a.onload=function(){try{var e=document.createElement("canvas"),i=a.width/a.height,c=[a.width,a.height],u=c[0],l=c[1];n&&(u>l&&u>n?l=(u=n)/i:l>=u&&l>n&&(u=(l=n)*i)),r&&(u>l&&u<r?l=(u=r)/i:l>=u&&l<r&&(u=(l=r)*i));var s=e.getContext("2d");if(!s)throw Error("Unable to create 2D canvas context");s.canvas.width=u,s.canvas.height=l,s.clearRect(0,0,e.width,e.height),s.drawImage(a,0,0,a.width,a.height,0,0,e.width,e.height);var f=e.toDataURL("image/png"),h=s.getImageData(0,0,e.width,e.height);t({dataUrl:f,data:h})}catch(t){o(t)}},a.onerror=function(t){o(t)}})));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function zr(t){var e=window.btoa(window.unescape(encodeURIComponent(t)));return"data:".concat(m,";base64,").concat(e)}function Jr(t){return(Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$r(n.key),n)}}function Yr(t,e,r){return e&&Kr(t.prototype,e),r&&Kr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Xr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zr(t,e,r){return(e=$r(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $r(t){var e=function(t,e){if("object"!==Jr(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==Jr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===Jr(e)?e:String(e)}var Qr={hexToString:function(t){var e=t.toString(16);return"000000".substr(0,6-e.length)+e},rgbToHsv:function(t){var e=0,r=t.r,n=t.g,o=t.b,a=r<n&&r<o?r:n<o?n:o,i=r>n&&r>o?r:n>o?n:o,c=0===i?0:(i-a)/i,u=0===c?1e-5:i-a;switch(i){case r:e=(n-o)/u;break;case n:e=2+(o-r)/u;break;case o:e=4+(r-n)/u}return{h:(1e3+e/6)%1,s:c,v:i}},hsvToRgb:function(t){var e=t.h,r=t.s,n=t.v,o=0,a=0,i=0,c=6*(e=(e+1e3)%1)>>0,u=6*e-c,l=n*(1-r),s=n*(1-r*u),f=n*(1-r*(1-u));switch(c){case 0:o=n,a=f,i=l;break;case 1:o=s,a=n,i=l;break;case 2:o=l,a=n,i=f;break;case 3:o=l,a=s,i=n;break;case 4:o=f,a=l,i=n;break;case 5:o=n,a=l,i=s}return{r:o,g:a,b:i}},rgbToCmyk:function(t){var e=1-t.r,r=1-t.g,n=1-t.b,o=e<r&&e<n?e:r<n?r:n;return 1===o?e=r=n=0:(e=(e-o)/(1-o),r=(r-o)/(1-o),n=(n-o)/(1-o)),{c:e,m:r,y:n,k:o}},cmykToRgb:function(t){var e=t.k;return{r:1-(t.c*(1-e)+e),g:1-(t.m*(1-e)+e),b:1-(t.y*(1-e)+e)}},rgbToXyz:function(t){var e=t.r,r=t.g,n=t.b;return{x:100*(.4124*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)+.3576*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.1805*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92))/95.047,y:.2126*e+.7152*r+.0722*n,z:100*(.0193*e+.1192*r+.9505*n)/108.883}},xyzToRgb:function(t){var e=t.x,r=t.y,n=t.z,o=3.24063*(e*=95.047/100)-1.53721*r-.498629*(n*=1.08883),a=-.968931*e+1.87576*r+.0415175*n,i=.0557101*e-.204021*r+1.057*n;return{r:o=o>.0031308?1.055*Math.pow(o,.4167)-.055:12.92*o,g:a=a>.0031308?1.055*Math.pow(a,.4167)-.055:12.92*a,b:i=i>.0031308?1.055*Math.pow(i,.4167)-.055:12.92*i}},rgbToLab:function(t){var e=this.rgbToXyz(t),r=e.x,n=e.y,o=e.z,a=r>.008856?Math.pow(r,1/3):7.787*r+.1379,i=n>.008856?Math.pow(n,1/3):7.787*n+.1379;return{l:(116*i-16)/100,a:(500*(a-i)+128)/255,b:(200*(i-(o>.008856?Math.pow(o,1/3):7.787*o+.1379))+128)/255}},labToRgb:function(t){var e=(100*t.l+16)/116,r=e+(255*t.a-128)/500,n=e-(255*t.b-128)/200;return this.xyzToRgb({x:r>.2069?r*r*r:.1284*(r-.1379),y:e>.2069?e*e*e:.1284*(e-.1379),z:n>.2069?n*n*n:.1284*(n-.1379)})},labToLAB:function(t){var e=[];return e[0]=100*t[0],e[1]=255*t[1]-128,e[2]=255*t[2]-128,e},labToLABInverse:function(t){var e=[];return e[0]=t[0]/100,e[1]=(t[1]+128)/255,e[2]=(t[2]+128)/255,e},valuesToRgb:function(t,e){var r,n,o,a;switch(t){case"lab":n={l:e[0],a:e[1],b:e[2]},r=this.labToRgb(n);break;case"rgb":r={r:e[0],g:e[1],b:e[2]};break;case"cmyk":o={c:e[0],m:e[1],y:e[2],k:e[3]},r=this.cmykToRgb(o);break;case"hsv":a={h:e[0],s:e[1],v:e[2]},r=this.hsvToRgb(a)}function i(t){return t<0?0:t>1?1:t}return{r:i(r.r),g:i(r.g),b:i(r.b)}},valuesToHex:function(t,e){var r=this.valuesToRgb(t,e);return this.hexToString((Math.round(255*r.r)<<16|Math.round(255*r.g)<<8|Math.round(255*r.b))>>>0).toUpperCase()}},tn=40960;function en(t){for(var e=new Array(t);--t>=0;)e[t]=0;return e}function rn(t,e,r){var n=4*(e+r*t._width);return{r:t._data.data[n],g:t._data.data[n+1],b:t._data.data[n+2],a:t._data.data[n+3]}}var nn,on={cubicSigmoid:function(t){if(t<0)return 0;if(t>1)return 1;var e=2*t-1;return.5*(1+e*(1.5-.5*e*e))},tripleCubicSigmoid:function(t,e,r){var n=r-e;return n>0?on.cubicSigmoid((t-e)/n):1},suppression:function(t,e){e<0&&(e*=-1,t=255-t);var r=t/255,n=e<.5?2*e:1,o=e<.5?0:2*e-1;return Math.pow(n*on.cubicSigmoid(r)+(1-n),1+3*o)},colorfulness:function(t,e,r){var n=Qr.rgbToLab(Qr.hsvToRgb({h:t/255,s:e/255,v:r/255})),o=2*n.a-1,a=2*n.b-1;return 255*Math.sqrt(.5*(o*o+a*a))},weight:function(t,e,r,n,o){var a=on.suppression(on.colorfulness(t,e,r),n)*on.suppression(r,o)*on.tripleCubicSigmoid(e,0,30)*on.tripleCubicSigmoid(r,0,30);return a<.001?.001:a},hsvToLab:function(t){var e=t.hsv;t.rgb=Qr.hsvToRgb({h:e.h,s:e.s,v:e.v});var r=Qr.rgbToLab(t.rgb);r.l*=255,r.a*=255,r.b*=255,t.gregLab=r},weightedDistanceLab:function(t,e,r,n){var o,a,i,c,u,l;t.gregLab||on.hsvToLab(t),e.gregLab||on.hsvToLab(e);var s=null===(o=t.gregLab)||void 0===o?void 0:o.l,f=null===(a=e.gregLab)||void 0===a?void 0:a.l,h=null===(i=t.gregLab)||void 0===i?void 0:i.a,p=null===(c=e.gregLab)||void 0===c?void 0:c.a,v=null===(u=t.gregLab)||void 0===u?void 0:u.b,d=null===(l=e.gregLab)||void 0===l?void 0:l.b,y=s-f,m=h-p,g=v-d,b=Math.sqrt(h*h+v*v)-Math.sqrt(p*p+d*d),w=b*b,O=m*m+g*g-w;return Math.sqrt(r*y*y+n*w+O)}},an=Yr((function t(e,r,n){Xr(this,t),Zr(this,"_data",void 0),Zr(this,"_width",void 0),Zr(this,"_height",void 0),this._data=e,this._width=r,this._height=n})),cn=179769e300;function un(t,e,r,n,o,a){return t.density<1e-10||e.density<1e-10?cn:(nn=on.weightedDistanceLab(t.color,e.color,o,a))<r?(nn<r?cn:0)*(1-nn/r):n*(1/nn-1/r)}var ln=Yr((function t(e,r){Xr(this,t),Zr(this,"color",void 0),Zr(this,"density",void 0),this.color=e,this.density=r})),sn=function(t,e){var r=t.color.hsv,n=e.color.hsv;return r.h>n.h?-1:r.h<n.h?1:r.s>n.s?-1:r.s<n.s?1:r.v>n.v?-1:r.v<n.v?1:0},fn=Yr((function t(e){var r,n;switch(Xr(this,t),Zr(this,"gHH",void 0),Zr(this,"gSS",void 0),Zr(this,"gBB",void 0),Zr(this,"colorRepulsion",void 0),Zr(this,"hardCoreInteractionRadius",void 0),Zr(this,"saturationScaleFactor",void 0),Zr(this,"style",void 0),Zr(this,"colorfulnessEnhancement",void 0),Zr(this,"shadowHighlightSuppression",void 0),e.toLowerCase()){case"bright":r=.88,n=.75;break;case"dark":r=-.8,n=-.8;break;case"muted":r=-.8,n=.6;break;case"deep":r=.6,n=-.7;break;case"colorful":r=.5,n=0;break;case"blank":r=0,n=0;break;default:r=.5,n=0}this.gHH=1,this.gSS=.23,this.gBB=.04,this.colorRepulsion=2.5,this.hardCoreInteractionRadius=4,this.saturationScaleFactor=1,this.style=e,this.colorfulnessEnhancement=r,this.shadowHighlightSuppression=n})),hn=Yr((function t(e,r){var n=this;Xr(this,t),Zr(this,"_bitmapData",void 0),Zr(this,"_colorStyle",void 0),Zr(this,"_numColors",void 0),Zr(this,"_histogram",void 0),Zr(this,"_xOffset",void 0),Zr(this,"_yOffset",void 0),Zr(this,"_xMultiplier",void 0),Zr(this,"_yMultiplier",void 0),Zr(this,"_weightedHistogram",void 0),Zr(this,"finalColor",void 0),Zr(this,"_colors",void 0),Zr(this,"points",void 0),Zr(this,"_harmonyPoints",void 0),Zr(this,"extractColors",(function(t,e,r){n._bitmapData=t,n._colorStyle=e,n._numColors=r,n.synchronousExtract()})),Zr(this,"synchronousExtract",(function(){n.clearHistogram(),n.generateHistogram(),n.weightAndNormalizeHistogram(),n.findBestColors(),n.findBestPoints()})),Zr(this,"clearHistogram",(function(){n._histogram=en(tn)})),Zr(this,"generateHistogram",(function(){var t,e,r,o,a,i=n._bitmapData,c=n._yOffset,u=n._xOffset,l=n._yMultiplier,s=n._xMultiplier,f=n._bitmapData._width,h=n._bitmapData._height,p=null!==(t=n._histogram)&&void 0!==t?t:en(tn);for(o=c;o<h;o+=l)for(r=u;r<f;r+=s)(a=rn(i,r,o)).r/=255,a.g/=255,a.b/=255,p[10*(64*~~(63.75*(e=Qr.rgbToHsv(a)).h)+~~(63.75*e.s))+~~(9.9609375*e.v)]++;n._histogram=p})),Zr(this,"weightAndNormalizeHistogram",(function(){var t=n._numColors,e=n.weightAndNormalize().volume;e<t&&(n._colorStyle=new fn("Blank"),e=n.weightAndNormalize().volume,n._numColors=Math.min(e,t))})),Zr(this,"weightAndNormalize",(function(){var t,e,r,o,a,i,c,u,l=n._colorStyle.colorfulnessEnhancement,s=n._colorStyle.shadowHighlightSuppression,f=function(t){return function(t,e){for(var r=new Array(40960),n=0;n<40960;n++)r[n]=e[n];return r}(0,t)}(null!==(t=n._histogram)&&void 0!==t?t:en(tn)),h=0;for(r=0;r<64;r++)for((i=~~((256*r+32)/64))>255&&(i=255),o=0;o<64;o++)for((c=~~((256*o+32)/64))>255&&(c=255),a=0;a<10;a++)0!==f[10*(64*r+o)+a]&&(u=~~(256*(a+.5)/10),(e=f[10*(64*r+o)+a]*=on.weight(i,c,u,l,s))>h&&(h=e));var p,v,d=h>.01?Math.log(h/.01):0,y=0;if(d>0)for(r=0;r<64;r++)for(o=0;o<64;o++)for(a=0;a<10;a++)0!==f[p=10*(64*r+o)+a]&&(0!=(v=(e=f[p])>.01?Math.log(e/.01)/d:0)&&y++,f[p]=v);return n._weightedHistogram=f,{volume:y}})),Zr(this,"findBestColors",(function(){var t,e,r,o,a,i,c=n._colorStyle,u=n._numColors,l=n._weightedHistogram,s=[];for(t=0;t<64;t++)for(o=~~(1.411*~~((256*t+32)/64)),e=0;e<64;e++)for((a=~~((256*e+32)/64*.392))>100&&(a=100),r=0;r<10;r++)if(0!==l[10*(64*t+e)+r]){var f={hsv:{h:o/360,s:a/100,v:~~(256*(r+.5)/10*.392)/100}};i={hsv:f.hsv,rgb:Qr.hsvToRgb(f.hsv)},s.push(new ln(i,l[10*(64*t+e)+r]))}var h,p,v,d,y,m,g=c.hardCoreInteractionRadius,b=c.colorRepulsion,w=c.gBB,O=c.gSS,E=[];for(h=0;h<u;h++){for(d=Math.pow(10,100),p=0;p<s.length;p++){for(y=1-s[p].density,v=0;v<E.length;v++)y+=un(s[p],E[v],g,b,w,O);y<d&&(d=y,m=s[p])}E.push(m)}n._harmonyPoints=E})),Zr(this,"findBestPoints",(function(){var t=n._harmonyPoints;t.sort(sn);for(var e=0;e<t.length;e++)n._colors.push(t[e].color),n.points.push(n.findPixel(n._colors[e]));n.finalColor=n._colors})),Zr(this,"findPixel",(function(t){for(var e,r,o,a=n._bitmapData,i=n._bitmapData._width,c=n._bitmapData._height,u=255*(null===(e=t.rgb)||void 0===e?void 0:e.r),l=255*(null===(r=t.rgb)||void 0===r?void 0:r.g),s=255*(null===(o=t.rgb)||void 0===o?void 0:o.b),f=179769e300,h=0,p=0,v=!1,d=0;!v&&d<c;d++)for(var y=0;!v&&y<i;y++){var m=rn(a,y,d),g=m.r-u,b=m.g-l,w=m.b-s,O=g*g+b*b+w*w;O<f&&(h=y,p=d,f=O,O<=12&&(v=!0))}return{x:h,y:p}})),this._bitmapData=e,this._colorStyle=r,this._numColors=5,this._histogram=void 0,this._weightedHistogram=[],this._colors=[],this.points=[],this.finalColor=[],this._xMultiplier=1,this._yMultiplier=1,this._xOffset=0,this._yOffset=0,this._harmonyPoints=[]}));function pn(t,e,r,n,o){var a=new an(t,e,r),i=new fn(o),c=new hn(a,i);return c.extractColors(a,i,n),{finalColor:c.finalColor,points:c.points}}function vn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return dn(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function yn(t,e,r,n){for(var o=[],a=t.data,i=t.step,c=t.cols,u=t.rows,l=0;l<c;++l){o.push(new Float32Array(u));for(var s=0;s<u;++s)o[l][s]=ir(a,s,l,0,i)}var f=Ye.covMat(o[0],o[1],o[2]);e.floatPtr(0,0)[0]=f[0][0],e.floatPtr(0,1)[0]=f[0][1],e.floatPtr(0,2)[0]=f[0][2],e.floatPtr(1,0)[0]=f[1][0],e.floatPtr(1,1)[0]=f[1][1],e.floatPtr(1,2)[0]=f[1][2],e.floatPtr(2,0)[0]=f[2][0],e.floatPtr(2,1)[0]=f[2][1],e.floatPtr(2,2)[0]=f[2][2];var h=Ye.mean(o[0]),p=Ye.mean(o[1]),v=Ye.mean(o[2]);r.floatPtr(0,0)[0]=h,r.floatPtr(0,1)[0]=p,r.floatPtr(0,2)[0]=v}function mn(t,e){if(void 0===e){e=[];for(var r=t.data32F,n=t.step,o=t.cols,a=t.rows,i=0;i<a;++i){e.push(new Array(o));for(var c=0;c<o;++c)e[i][c]=ur(r,i,c,0,n)}}for(var u=Object(He.SVD)(e,!0,!0),l=u.q,s=u.u,f=u.v,h=new Ze.Mat(l.length,1,t.type()),p=0;p<l.length;++p)h.floatPtr(p,0)[0]=l[p];for(var v=new Ze.Mat(s.length,s[0].length,t.type()),d=0;d<v.rows;++d)for(var y=0;y<v.cols;++y)v.floatPtr(d,y)[0]=s[d][y];for(var m=new Ze.Mat(f.length,f[0].length,t.type()),g=0;g<m.rows;++g)for(var b=0;b<m.cols;++b)m.floatPtr(g,b)[0]=f[g][b];var w=m.t();return m.delete(),[h,v,w]}function gn(t,e,r,n){$e.a.normalize(t,e,r,n,$e.a.NORM_MINMAX)}function bn(t){var e=t.size();$e.a.cvtColor(t,t,$e.a.COLOR_RGBA2BGR);var r=300/Math.max(t.rows,t.cols);$e.a.resize(t,t,new $e.a.Size(0,0),r,r,$e.a.INTER_AREA),$e.a.cvtColor(t,t,$e.a.COLOR_RGB2Lab);var n=t.clone();$e.a.medianBlur(t,t,5);var o=function(t){var e=t.cols,r=t.rows,n=t.channels(),o=new Ze.Mat(r,e,$e.a.CV_8UC3,new $e.a.Scalar(255,255,255)),a=new $e.a.Rect(0,0,e,1),i=new $e.a.Rect(0,0,1,r),c=new $e.a.Rect(e-1,0,1,r),u=new $e.a.Rect(0,r-1,e,1);o.roi(a).setTo(new $e.a.Scalar(0)),o.roi(i).setTo(new $e.a.Scalar(0)),o.roi(c).setTo(new $e.a.Scalar(0)),o.roi(u).setTo(new $e.a.Scalar(0));for(var l=t.clone(),s=t.clone(),f=t.data,h=t.step,p=l.data,v=l.step,d=s.data,y=s.step,m=o.data,g=o.step,b=0;b<n;++b)for(var w=0;w<3;++w){var O=void 0,E=void 0,S=void 0,j=void 0,_=void 0;w%2==1?(O=1,E=1,S=1,j=e-2,_=r-2):(O=-1,E=e-2,S=r-2,j=1,_=1);for(var x=S*O;x<=_*O;x+=O*O)for(var L=E*O;L<=j*O;L+=O*O)for(var A=x*O,C=L*O,T=[[A,C-O],[A-O,C]],M=ir(f,A,C,b,h),I=0;I<2;++I){var P=T[I][0],N=T[I][1],R=Math.max(ir(p,P,N,b,v),M),k=Math.min(ir(d,P,N,b,y),M),D=R-k;D<ir(m,A,C,b,g)&&(cr(D,m,A,C,b,g),cr(R,p,A,C,b,v),cr(k,d,A,C,b,y))}}for(var F=new Ze.Mat(r,e,$e.a.CV_32FC1),G=F.data32F,U=F.step,B=0;B<r;B++)for(var H=0;H<e;H++)lr((ir(m,B,H,0,g)+ir(m,B,H,1,g)+ir(m,B,H,2,g))/3,G,B,H,0,U);return gn(F,F,0,1),o.delete(),l.delete(),s.delete(),F}(t),a=function(t,e,r){var n=t.cols,o=t.rows,a=t.channels(),i=new Ze.Mat(o,n,$e.a.CV_32FC1),c=Math.max(Math.floor(.1*n),1),u=Math.max(Math.floor(.1*o),1),l=new Ze.Mat(o,n,$e.a.CV_32FC3);t.convertTo(l,$e.a.CV_32FC3);for(var s=new $e.a.Rect(0,0,Math.max(n-1,1),Math.max(Math.min(u-1,o-1),1)),f=new $e.a.Rect(0,0,Math.max(Math.min(c-1,n-1),1),Math.max(o-1,1)),h=new $e.a.Rect(Math.max(0,n-c),0,Math.max(n-1-Math.max(0,n-c),1),Math.max(o-1,1)),p=new $e.a.Rect(0,Math.max(0,o-u),Math.max(n-1,1),Math.max(o-1-Math.max(0,o-u),1)),v=[t.roi(s).clone(),t.roi(f).clone(),t.roi(h).clone(),t.roi(p).clone()],d=function(t){for(var e=t.cols,r=t.rows,n=t.channels(),o=r*e,a=new Ze.Mat(o,n,$e.a.CV_8UC1),i=a.cols,c=a.channels(),u=o*n,l=t.data,s=t.step,f=a.data,h=a.step,p=0;p<u;++p)cr(ir(l,Math.floor(p/(e*n)),Math.floor(p%(e*n)/n),p%(e*n)%n,s),f,Math.floor(p/(i*c)),Math.floor(p%(i*c)/c),p%(i*c)%c,h);return a},y=[new Ze.Mat,new Ze.Mat,new Ze.Mat,new Ze.Mat],m=$e.a.Mat.eye(a,a,$e.a.CV_32FC1),g=m.mul(m,20),b=0;b<v.length;b++){var w=new Ze.Mat(1,a,$e.a.CV_32FC1),O=new Ze.Mat(a,a,$e.a.CV_32FC1);y[b].create(o,n,$e.a.CV_32FC1);var E=d(v[b]);v[b].delete(),v[b]=E,yn(v[b],O,w,$e.a.CV_32F),$e.a.add(O,g,O);var S=vn(mn(O),3),j=S[0],_=S[1],x=S[2],L=j.clone(),A=Ze.Mat.ones(j.size(),j.type());$e.a.divide(A,j,L),A.delete();var C=Ze.Mat.zeros(3,3,j.type());C.floatPtr(0,0)[0]=L.floatPtr(0,0)[0],C.floatPtr(1,1)[0]=L.floatPtr(1,0)[0],C.floatPtr(2,2)[0]=L.floatPtr(2,0)[0];var T=new Ze.Mat,M=new Ze.Mat,I=x.t(),P=_.t(),N=$e.a.Mat.zeros(3,3,x.type());$e.a.gemm(I,C,1,N,1,T),N.delete(),N=$e.a.Mat.zeros(3,3,_.type()),$e.a.gemm(T,P,1,N,1,M),N.delete();for(var R=new Ze.Mat(o,n,$e.a.CV_32FC1),k=[0,0,0],D=l.data32F,F=l.step,G=R.data32F,U=R.step,B=M.data32F,H=M.step,V=[w.floatPtr(0,0)[0],w.floatPtr(0,1)[0],w.floatPtr(0,2)[0]],W=0;W<o;W++)for(var q=0;q<n;q++){var z=ur(D,W,q,0,F),J=ur(D,W,q,1,F),K=ur(D,W,q,2,F);k[0]=z,k[1]=J,k[2]=K,k[0]=k[0]-V[0],k[1]=k[1]-V[1],k[2]=k[2]-V[2];var Y=ur(B,0,0,0,H)*k[0]*k[0]+ur(B,1,1,0,H)*k[1]*k[1]+ur(B,2,2,0,H)*k[2]*k[2]+(ur(B,0,1,0,H)+ur(B,1,0,0,H))*k[0]*k[1]+(ur(B,0,2,0,H)+ur(B,2,0,0,H))*k[0]*k[2]+(ur(B,1,2,0,H)+ur(B,2,1,0,H))*k[1]*k[2];lr(Math.sqrt(Y),G,W,q,0,U)}gn(R,y[b],0,1),w.delete(),O.delete(),M.delete(),R.delete(),j.delete(),_.delete(),x.delete(),I.delete(),L.delete(),C.delete(),T.delete(),P.delete()}for(var X=[y[0].data32F,y[1].data32F,y[2].data32F,y[3].data32F],Z=[y[0].step,y[1].step,y[2].step,y[3].step],$=i.data32F,Q=i.step,tt=0;tt<o;tt++)for(var et=0;et<n;et++){var rt=ur(X[0],tt,et,0,Z[0]),nt=ur(X[1],tt,et,0,Z[1]),ot=ur(X[2],tt,et,0,Z[2]),at=ur(X[3],tt,et,0,Z[3]);lr(rt+nt+ot+at-Math.max(Math.max(Math.max(rt,nt),ot),at),$,tt,et,0,Q)}gn(i,i,0,1);for(var it=0;it<v.length;it++)y[it].delete(),v[it].delete();return l.delete(),m.delete(),g.delete(),i}(n);$e.a.add(a,o,a);var i=function(t){for(var e=t.cols,r=t.rows,n=new Ze.Mat(r,e,$e.a.CV_32FC1),o=new $e.a.Point(e/2,r/2),a=n.data32F,i=n.step,c=0;c<r;c++)for(var u=0;u<e;u++){var l=(c-o.y)*(c-o.y)/(o.y*o.y)+(u-o.x)*(u-o.x)/(o.x*o.x);lr(Math.exp(-l/2),a,c,u,0,i)}gn(n,n,0,1);var s=t.clone();s.convertTo(s,$e.a.CV_32FC1);var f=s.mul(n,1);return s.delete(),gn(s=f,s,0,255),s.convertTo(s,$e.a.CV_8UC1),n.delete(),s}(a);a.delete();var c=function(t){var e=Math.min(t.cols,t.rows),r=Math.min(20,Math.round(e/2)),n=$e.a.getStructuringElement($e.a.MORPH_ELLIPSE,new $e.a.Size(3,3),new $e.a.Point(1,1)),o=function(t,e,r){console.assert(t.type()===$e.a.CV_8UC1);var n=new Ze.Mat(t.size(),$e.a.CV_8UC1);$e.a.erode(t,n,new Ze.Mat,new $e.a.Point(-1,-1),r/2);var o=new Ze.Mat,a=new Ze.Mat;n.copyTo(a);var i=new Ze.Mat,c=$e.a.CMP_NE;do{a.copyTo(o),$e.a.dilate(o,a,e),$e.a.min(a,t,a),$e.a.compare(o,a,i,c)}while(0!==$e.a.countNonZero(i));return o.delete(),n.delete(),i.delete(),a}(t,n,r),a=function(t,e,r){console.assert(t.type()===$e.a.CV_8UC1);var n=new Ze.Mat(t.size(),$e.a.CV_8UC1);$e.a.dilate(t,n,new Ze.Mat,new $e.a.Point(-1,-1),r/2);var o=new Ze.Mat,a=new Ze.Mat;n.copyTo(a);var i=new Ze.Mat,c=$e.a.CMP_NE;do{a.copyTo(o),$e.a.erode(o,a,e),$e.a.max(a,t,a),$e.a.compare(o,a,i,c)}while(0!==$e.a.countNonZero(i));return o.delete(),n.delete(),i.delete(),a}(o,n,r);return n.delete(),o.delete(),a}(a=i);a.delete(),(a=c).convertTo(a,$e.a.CV_32FC1),gn(a,a,0,1);for(var u=0,l=0,s=8;s<=12;s++){var f=.05*s,h=new Ze.Mat(a.size(),$e.a.CV_8U),p=new Ze.Mat(a.rows,a.cols,$e.a.CV_32FC1,new $e.a.Scalar(f));$e.a.compare(a,p,h,$e.a.CMP_GT);var v=new Ze.Mat(a.size(),$e.a.CV_8U);$e.a.compare(a,p,v,$e.a.CMP_LE);var d=$e.a.mean(a,h)[0],y=$e.a.mean(a,v)[0];d-y>u&&(l=d-1.2*(u=d-y)/2),l=.5*(d+y),h.delete(),v.delete(),p.delete()}var m=a.clone(),g=new Ze.Mat(a.rows,a.cols,$e.a.CV_32FC1,new $e.a.Scalar(l));return $e.a.subtract(a,g,m),a.delete(),gn(a=function(t){var e=t.clone(),r=new Ze.Mat(e.rows,e.cols,$e.a.CV_32FC1,new $e.a.Scalar(-15));$e.a.multiply(e,r,e),$e.a.exp(e,e);var n=$e.a.Mat.ones(e.rows,e.cols,$e.a.CV_32FC1);$e.a.add(e,n,e);var o=$e.a.Mat.ones(e.rows,e.cols,$e.a.CV_32FC1);return $e.a.divide(o,e,e),r.delete(),n.delete(),o.delete(),e}(m),a,0,255),a.convertTo(a,$e.a.CV_8UC1),$e.a.resize(a,a,e),n.delete(),o.delete(),m.delete(),g.delete(),a}function wn(t){return(wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function On(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==wn(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==wn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===wn(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var En=[O,E,S,j,_],Sn=[x,L,A,C,T];function jn(t,e){for(var r=gt(e),n=0,o=1/0,a=0;a<t.length;a++){var i=Ot(t[a],r);i<o&&(n=a,o=i)}return n}function _n(t){var e;return(On(e={},w,""),On(e,O,"bright"),On(e,E,"colorful"),On(e,S,"dark"),On(e,_,"deep"),On(e,j,"muted"),On(e,x,"bright"),On(e,L,"colorful"),On(e,A,"dark"),On(e,T,"deep"),On(e,C,"muted"),e)[t]}function xn(t,e,r,n,o){var a=[];if(e<=0)return a;if(En.includes(r)){var i=pn(t,t.width,t.height,e,_n(r));return i.finalColor.map((function(t){return{color:Q.fromRGB(mt([t.rgb.r,t.rgb.g,t.rgb.b])),weight:1/i.finalColor.length}}))}if(Sn.includes(r))return function(t,e){for(var r=V(t.length),n=e.width*e.height,o=t.map(gt),a=new Map,i=0;i<n;i++){var c=[e.data[4*i+0],e.data[4*i+1],e.data[4*i+2]],u=Q.fromRGB(c).toString("hex");a.has(u)||a.set(u,jn(o,c)),r[a.get(u)]+=1}for(var l=function(t){var e=z(t);return t.map((function(t){return t/e}))}(r),s=[],f=0;f<t.length;f++)l[f]>.01&&s.push({color:Object(M.a)(At(t[f])),weight:l[f]});var h=z(s.map((function(t){return t.weight})));return s.map((function(t){return{color:t.color,weight:t.weight/h}}))}(pn(t,t.width,t.height,e,_n(r)).finalColor.map((function(t){return mt([t.rgb.r,t.rgb.g,t.rgb.b])})),t);if(function(t){return t===w}(r)){var c=new vt,u=c.processImageData(t.data,n,e,o.useSaliency?function(t){try{for(var e,r=bn(e=t instanceof ImageData?$e.a.matFromImageData(t):$e.a.imread(t)),n=new Uint8ClampedArray(r.rows*r.cols),o=r.data,a=r.step,i=r.rows,c=r.cols,u=0;u<i;++u)for(var l=0;l<c;++l)n[u*c+l]=ir(o,u,l,0,a);return e.delete(),r.delete(),n}catch(t){throw console.log(t),"number"==typeof t&&console.log("[Memory]: ",$e.a.exceptionFromPtr(t)),t}}(t):void 0),l=c.seedWeights_.reduce((function(t,e){return t+e}),0),s=c.seedWeights_.map((function(t){return t/l})),f=s;if(o.useSaliency){var h=c.seedSaliencyWeights_.reduce((function(t,e){return t+e}),0),p=(f=c.seedSaliencyWeights_.map((function(t){return t/h})).map((function(t,e){return o.saliencyFactor*t+(1-o.saliencyFactor)*s[e]}))).reduce((function(t,e){return t+e}),0);f=f.map((function(t){return t/p}))}for(var v=0;v<u.length;v++)a.push({color:Object(M.a)(u[v]),weight:f[v]});return a.sort((function(t,e){return e.weight-t.weight}))}throw Error("unknow recolor method - ".concat(r.toString()))}function Ln(t){return(Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function An(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||Tn(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cn(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Tn(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function Tn(t,e){if(t){if("string"==typeof t)return Mn(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Mn(t,e):void 0}}function Mn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function In(){In=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var a=e&&e.prototype instanceof y?e:y,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:_(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var h="suspendedStart",p="executing",v="completed",d={};function y(){}function m(){}function g(){}var b={};l(b,i,(function(){return this}));var w=Object.getPrototypeOf,O=w&&w(w(T([])));O&&O!==r&&n.call(O,i)&&(b=O);var E=g.prototype=y.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==Ln(s)&&n.call(s,"__await")?e.resolve(s.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(s).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function _(e,r,n){var o=h;return function(a,i){if(o===p)throw new Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(e,r,n);if("normal"===l.type){if(o=n.done?v:"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=v,n.method="throw",n.arg=l.arg)}}}function x(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,d;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ln(e)+" is not iterable")}return m.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=l(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(j.prototype),l(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(s(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(E),l(E,u,"Generator"),l(E,i,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),d}},e}function Pn(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function Nn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Rn(n.key),n)}}function Rn(t){var e=function(t,e){if("object"!==Ln(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==Ln(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===Ln(e)?e:String(e)}function kn(t){var e,r=[],n=Cn(t);try{for(n.s();!(e=n.n()).done;){var o,a=e.value,i=!0,c=Cn(r);try{for(c.s();!(o=c.n()).done;){var u=o.value;if(Ot(gt(Q.toRGB(a.color)),gt(Q.toRGB(u.color)))<4/255){i=!1;break}}}catch(t){c.e(t)}finally{c.f()}i&&r.push(a)}}catch(t){n.e(t)}finally{n.f()}return r}function Dn(t,e,r,n,o){var a=An(bt(Et(t)),3),i=a[0],c=a[1],u=a[2],l=An(mt(wt([i+100*(e+Math.random()*(r-e))*(Math.random()>.5?1:-1),c+255*(n+Math.random()*(o-n))*(Math.random()>.5?1:-1),u+255*(n+Math.random()*(o-n))*(Math.random()>.5?1:-1)])),3),s=l[0],f=l[1],h=l[2];return Q.fromRGB([s,f,h])}function Fn(t,e,r){for(var n=t,o=[],a=0;a<e;++a){var i=a%t.length;i<o.length?o[i]++:o.push(1)}for(var c=e/(t.length+e),u=.25*r,l=.025*r,s=0;s<o.length;++s)for(var f=o[s],h=0;h<f;++h)n.push({color:Dn(t[s].color,.1,u,0,l),weight:c});var p,v=0,d=Cn(n);try{for(d.s();!(p=d.n()).done;)v+=p.value.weight}catch(t){d.e(t)}finally{d.f()}var y,m=Cn(n);try{for(m.s();!(y=m.n()).done;){var g=y.value;g.weight=g.weight/v}}catch(t){m.e(t)}finally{m.f()}return n}function Gn(t,e){for(var r=kn(t),n=0,o=r;n<2&&r.length<e;)o.length<e&&(o=Fn(o,e-o.length,n)),r=kn(o),++n;return o}function Un(t){return(Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||Jn(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hn(t){return function(t){if(Array.isArray(t))return Kn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Jn(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vn(){Vn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var a=e&&e.prototype instanceof y?e:y,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:_(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var h="suspendedStart",p="executing",v="completed",d={};function y(){}function m(){}function g(){}var b={};l(b,i,(function(){return this}));var w=Object.getPrototypeOf,O=w&&w(w(T([])));O&&O!==r&&n.call(O,i)&&(b=O);var E=g.prototype=y.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==Un(s)&&n.call(s,"__await")?e.resolve(s.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(s).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function _(e,r,n){var o=h;return function(a,i){if(o===p)throw new Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(e,r,n);if("normal"===l.type){if(o=n.done?v:"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=v,n.method="throw",n.arg=l.arg)}}}function x(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,d;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Un(e)+" is not iterable")}return m.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=l(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(j.prototype),l(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(s(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(E),l(E,u,"Generator"),l(E,i,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),d}},e}function Wn(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function qn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Wn(a,n,o,i,c,"next",t)}function c(t){Wn(a,n,o,i,c,"throw",t)}i(void 0)}))}}function zn(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Jn(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function Jn(t,e){if(t){if("string"==typeof t)return Kn(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Kn(t,e):void 0}}function Kn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Yn=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,r){e&&Nn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"handle",value:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Pn(a,n,o,i,c,"next",t)}function c(t){Pn(a,n,o,i,c,"throw",t)}i(void 0)}))}}(In().mark((function t(e){var r,n,o;return In().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Gn(r=xn(e.payload.imageData,e.payload.desiredNumberOfColors,e.payload.method,e.payload.importanceMethod,e.payload.recolorSettings),e.payload.desiredNumberOfColors),n=r.map((function(t){return Q.toRGB(t.color)})),o=n.every(tt),t.abrupt("return",{id:e.id,type:e.type,payload:{palette:r.map((function(t){return{color:Q.toRGB(t.color),weight:t.weight}})),isGrayscalePalette:o}});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),t}());function Xn(t,e,r,n,o){return Zn.apply(this,arguments)}function Zn(){return(Zn=qn(Vn().mark((function t(e,r,n,o,a){var i,c,u,l,s,f,h,p,v;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=document.createElement("canvas"),c=e.width/e.height,u=[e.width,e.height],(l=u[0])>(s=u[1])&&l>400?s=(l=400)/c:s>=l&&s>400&&(l=(s=400)*c),i.width=l,i.height=s,f=i.getContext("2d")){t.next=9;break}throw Error("context is not defined");case 9:return f.clearRect(0,0,i.width,i.height),f.drawImage(e,0,0,e.width,e.height,0,0,i.width,i.height),h=f.getImageData(0,0,i.width,i.height),p={payload:{imageData:h,desiredNumberOfColors:r,method:n,importanceMethod:o,recolorSettings:a}},t.next=14,Yn.handle(p);case 14:return v=t.sent,t.abrupt("return",v.payload);case 16:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $n(t,e,r,n,o){return Qn.apply(this,arguments)}function Qn(){return(Qn=qn(Vn().mark((function t(e,r,n,o,a){var i;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=new Promise((function(t,i){var c=document.createElement("img");c.src=e,c.addEventListener("load",(function(){var e=Xn(c,r,n,o,a);t(e)})),c.addEventListener("error",(function(t){i(t)}))})),t.abrupt("return",i);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function to(t,e,r){return eo.apply(this,arguments)}function eo(){return(eo=qn(Vn().mark((function t(e,r,n){var o,a;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Hr(e,r,n);case 2:return o=t.sent,a=o.data,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ro(t,e,r){for(var n=t.map((function(t){return{weight:t.weight,hex:t.color.toString("hex"),rgbColor:Et(t.color)}})),o=e.map((function(t){return{weight:t.weight,hex:t.color.toString("hex"),rgbColor:Et(t.color)}})),a=function(t,e,r){if(r===qo.EMD)return(new Jt).recolor(t,e,!0,0);if(r===qo.EMD_HUNGARIAN)return(new Kt).recolor(t,e,!0);if(r===qo.EMD_WEIGHTED_RANDOM)return(new Yt).recolor(t,e,!0,0);if(r===qo.EMD_SQRT)return(new Xt).recolor(t,e,!0,0);if(r===qo.CLR_TRANS_CORR_SPACE){var n=new Xe;return n.loadFromPalette(t,e),function(t,e){try{new Array(e.length);var r,n=[],o=Fe(t);try{for(o.s();!(r=o.n()).done;){var a=r.value.rgbColor;n.push([Math.round(255*a[0]),Math.round(255*a[1]),Math.round(255*a[2])])}}catch(t){o.e(t)}finally{o.f()}var i,c=[],u=Fe(e);try{for(u.s();!(i=u.n()).done;){var l=i.value;c.push(l)}}catch(t){u.e(t)}finally{u.f()}return function(t,e,r){var n,o=new Be(t),a=[],i=Fe(e);try{for(i.s();!(n=i.n()).done;){var c=n.value,u=o.project(c,r);a.push([Math.round(u[0]),Math.round(u[1]),Math.round(u[2])])}}catch(t){i.e(t)}finally{i.f()}return a}(n,c,!1)}catch(t){return console.log("Error: ",t.message),e}}(t,n.transfer())}throw Error("unknow recolor method - ".concat(r.toString()))}(n,o,r),i=0;i<a.length;i++)(isNaN(a[i][0])||isNaN(a[i][1])||isNaN(a[i][2]))&&(a[i]=[0,0,0]);var c=function(t,e,r){var n,o=t.map(bt),a=e.map(bt),i=[],c=rr(o);try{for(c.s();!(n=c.n()).done;){var u,l=n.value,s=[],f=rr(o);try{for(f.s();!(u=f.n()).done;){var h=1/(1e-4+X(l,u.value));s.push(h)}}catch(t){f.e(t)}finally{f.f()}s=ar(s);for(var p=0,v=0,d=0,y=0;y<o.length;++y){var m=er(K(a[y],o[y]),3),g=m[0],b=m[1],w=m[2];d+=s[y]*(l[0]+g),p+=s[y]*(l[1]+b),v+=s[y]*(l[2]+w)}var O=[0,0,0];O[0]=d,O[1]=p,O[2]=v,i.push(mt(wt(O)))}}catch(t){c.e(t)}finally{c.f()}return i}(o.map((function(t){return t.rgbColor})),a.map(gt));return[e.map((function(t){return t.color})),c.map((function(t){return Q.fromRGB([t[0],t[1],t[2]])}))]}function no(t,e,r){var n=mt(t),o=mt(e);r*=1e3;var a=(n[0]+o[0])/2,i=n[0]-o[0],c=n[1]-o[1],u=n[2]-o[2];return Math.sqrt(((512+a)*i*i>>8)+4*c*c+((767-a)*u*u>>8))<r}function oo(t,e,r,n,o,a,i,c,u){return ao.apply(this,arguments)}function ao(){return(ao=qn(Vn().mark((function t(e,r,n,o,a,i,c,u,l){var s,f,h,p,v,d,y,m,g,b,w,O,E,S,j,_,x,L,A,C,T,M,I,P,U,B,H,V,W,q,z,J,K,Y,X,$,tt=arguments;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=tt.length>9&&void 0!==tt[9]&&tt[9],l){t.next=54;break}return t.next=4,$n(e,n.svgPalette.length,a,i,c);case 4:if(f=t.sent,h=f.palette.map((function(t){return{color:Q.fromRGB(t.color),weight:t.weight}})),p=Hn(c.selectedColors),!(h=uo(h,p)).some((function(t){return isNaN(t.weight)}))){t.next=11;break}throw Error("weights are nan");case 11:if(c.colorHarmony===N){t.next=34;break}v=Qe.b.ANALOGOUS,t.t0=c.colorHarmony,t.next=t.t0===R?16:t.t0===k?18:t.t0===D?20:t.t0===F?22:t.t0===G?24:26;break;case 16:return v=Qe.b.COMPLEMENTARY,t.abrupt("break",28);case 18:return v=Qe.b.ANALOGOUS,t.abrupt("break",28);case 20:return v=Qe.b.TRIADIC,t.abrupt("break",28);case 22:return v=Qe.b.SPLIT_COMPLEMENTARY,t.abrupt("break",28);case 24:return v=Qe.b.SQUARE,t.abrupt("break",28);case 26:return v=Qe.b.ANALOGOUS,t.abrupt("break",28);case 28:for(d={color:Q.fromRGB([0,0,0]),weight:0},y=0;y<h.length;y++)h[y].weight>d.weight&&(d=h[y]);if(m=Qe.a.getHarmony(At(Q.toRGB(d.color)),v,Qe.c.ADDITIVE),(g=h.length-m.length)>0){if(b=Object(tr.a)(g/(2*m.length)),w=b,O=Object(tr.a)(h.length-(b+w)*m.length-m.length),E=Object(tr.a)(O/2),j=[],b+(S=O-E)>0)for(_=0;_<m.length;_++)j.push(Qe.a.getShades(m[_],0===_?b+S:b));if(w+E>0)for(x=0;x<m.length;x++)j.push(Qe.a.getTints(m[x],x===m.length-1?w+E:w));for(L=0;L<j.length;L++)m.push.apply(m,Hn(j[L]))}h=m.map((function(t){return{color:Q.fromRGB(Ct(t)),weight:1/m.length}}));case 34:if(A=ro(h,n.svgPalette,o)[1],C=Wo(A,n),T=Bn(C,2),M=T[0],I=T[1],P=jr(r,M,I,f.isGrayscalePalette,c,u),!s){t.next=43;break}return t.next=40,to(P,400,400);case 40:U=t.sent,B=io(U),P=Sr(P,B,f.isGrayscalePalette,c);case 43:return t.t1=n,t.t2=P,t.next=47,Hr(P,Math.max(window.screen.width,window.screen.height),Math.max(window.screen.width,window.screen.height));case 47:return t.t3=t.sent,t.t4=h,t.t5=A,t.t6=f.isGrayscalePalette,t.abrupt("return",{originalSVGPalette:t.t1,recoloredSVG:t.t2,recoloredSVGImage:t.t3,paletteUsedForRecoloring:t.t4,destColors:t.t5,wasTargetPaletteGrayScale:t.t6});case 54:if(H=Z(l.destColors),V=l.wasTargetPaletteGrayScale,W=Wo(H,n),q=Bn(W,2),z=q[0],J=q[1],K=jr(r,z,J,V,c,u),Y=H.map((function(t,e){return{color:H[e],weight:n.svgPalette[e].weight}})),!s){t.next=65;break}return t.next=62,to(K,400,400);case 62:X=t.sent,$=io(X),K=Sr(K,$,V,c);case 65:return t.t7=n,t.t8=K,t.next=69,Hr(K,Math.max(window.screen.width,window.screen.height),Math.max(window.screen.width,window.screen.height));case 69:return t.t9=t.sent,t.t10=Y,t.t11=l.destColors,t.t12=V,t.abrupt("return",{originalSVGPalette:t.t7,recoloredSVG:t.t8,recoloredSVGImage:t.t9,paletteUsedForRecoloring:t.t10,destColors:t.t11,wasTargetPaletteGrayScale:t.t12});case 74:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function io(t){var e,r=function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:23,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:230,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:10,c=t.rows,u=t.cols,l=t.channels(),s=t.clone(),f=new $e.a.MatVector;1===l?e=t.clone():($e.a.cvtColor(t,s,$e.a.COLOR_BGR2HSV_FULL),$e.a.split(s,f),e=f.get(2));for(var h=new Array(256).fill(0),p=0,v=0,d=e.data,y=e.step,m=0;m<c;m++)for(var g=0;g<u;g++){var b=ir(d,m,g,0,y),w=g<2?b:Math.abs(b-ir(d,m,g-2,0,y));p+=w,w>r&&(h[b]++,v++)}for(var O=p*i,E=O/Math.pow(2,Math.ceil(Math.log2(O))),S=Math.min(v/256,10),j=new Array(256).fill(0),_=0,x=0;x<256;x++)j[x]=x>n&&x<o?Math.round((1-E)*S+E*h[x]):Math.round(((1-E)*S+E*h[x])/(1+a)),_+=j[x];for(var L=new Array(256).fill(0),A=0,C=0;C<256;C++)A+=j[C]/_,L[C]=A;for(var T=new Array(256).fill(0),M=1;M<256;M++){var I=Math.max(0,255*L[M]);I=Math.min(I,255),T[M]=I}return 1===l?e.delete():f.delete(),s.delete(),T}(e=t instanceof ImageData?$e.a.matFromImageData(t):$e.a.imread(t));return e.delete(),r}function co(t,e,r){var n=[];if(1===r)n.push({color:t.toFormat("rgb"),weight:e});else{n.push({color:t.toFormat("rgb"),weight:.5*e});for(var o=.5*e/(r-1),a=function(t){var e=t+25*Math.random()*(Math.random()>.5?1:-1);return e=Math.max(0,e),Math.min(255,e)},i=0;i<r-1;++i){var c=a(t.getChannelValue("red")),u=a(t.getChannelValue("green")),l=a(t.getChannelValue("blue"));n.push({color:Q.fromRGB([c,u,l]),weight:o})}}return n}function uo(t,e){if(0===e.length)return t;t=t.sort((function(t,e){return e.weight-t.weight}));for(var r=[],n=Math.min(e.length,t.length),o=0,a=0;a<t.length-n;++a){var i=t[a];r.push({color:i.color.toFormat("rgb"),weight:i.weight}),o+=i.weight}0===o&&(o=1);for(var c=3*o,u=o,l=1;l<n;++l)u+=(c-u)/2;for(var s=u/n,f=0;f<n;++f){var h,p=zn(co(e[f],s,1));try{for(p.s();!(h=p.n()).done;){var v=h.value;r.push({color:v.color.toFormat("rgb"),weight:v.weight}),o+=v.weight}}catch(t){p.e(t)}finally{p.f()}}for(var d=0,y=r;d<y.length;d++)y[d].weight/=o;return r.sort((function(t,e){return e.weight-t.weight}))}var lo="kTint",so="kShade";function fo(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=ho(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function ho(t,e){if(t){if("string"==typeof t)return po(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?po(t,e):void 0}}function po(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function vo(t){var e=t.toString(16);return 1===e.length?"0"+e:e}function yo(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||ho(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,3),r=e[0],n=e[1],o=e[2];return"#"+vo(r)+vo(n)+vo(o)}function mo(t){if(0===t.length)throw new Error("Expected valid hex string, got an empty string");if(t.length>7)throw new Error("Expected valid hex string, got string - ".concat(t));var e=t.toLowerCase(),r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return null!==r?r.slice(1).map((function(t){return parseInt(t,16)})):[0,0,0]}function go(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o={tintOrShade:lo,value:0};return t=Math.max(r,t),(t=Math.min(n,t))>=e?(o.tintOrShade=lo,o.value=1!==e?(t-e)/(1-e):0):(o.tintOrShade=so,o.value=0!==e?1-t/e:0),o}function bo(t,e){var r={colorShade:[{tintOrShade:lo,value:0},{tintOrShade:lo,value:0},{tintOrShade:lo,value:0}]},n=xt(t[0],t[1],t[2]),o=xt(e[0],e[1],e[2]);return r.colorShade[0]=go(n.h,o.h),r.colorShade[0].value=n.h-o.h,r.colorShade[1]=go(n.s,o.s,.05),r.colorShade[2]=go(n.l,o.l,.05),r}function wo(t,e,r){var n=xt(t[0],t[1],t[2]),o=xt(e[0],e[1],e[2]),a=Math.abs(n.h-o.h);return a>.5&&(a=1-a),!(a>12/360||Math.abs(n.l-o.l)>r||n.s===o.s)}function Oo(t,e){if(0===t.size)return{hex:"",status:!1};var r,n=fo(t);try{for(n.s();!(r=n.n()).done;){var o=r.value;if(wo(e,gt(mo(o)),.2))return{hex:o,status:!0}}}catch(t){n.e(t)}finally{n.f()}return{hex:"",status:!1}}function Eo(t){return(Eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function So(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return jo(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?jo(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function jo(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _o(){_o=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var a=e&&e.prototype instanceof y?e:y,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:_(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var h="suspendedStart",p="executing",v="completed",d={};function y(){}function m(){}function g(){}var b={};l(b,i,(function(){return this}));var w=Object.getPrototypeOf,O=w&&w(w(T([])));O&&O!==r&&n.call(O,i)&&(b=O);var E=g.prototype=y.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==Eo(s)&&n.call(s,"__await")?e.resolve(s.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(s).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function _(e,r,n){var o=h;return function(a,i){if(o===p)throw new Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(e,r,n);if("normal"===l.type){if(o=n.done?v:"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=v,n.method="throw",n.arg=l.arg)}}}function x(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,d;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Eo(e)+" is not iterable")}return m.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=l(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(j.prototype),l(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(s(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(E),l(E,u,"Generator"),l(E,i,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),d}},e}function xo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Lo(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?xo(Object(r),!0).forEach((function(e){Ao(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xo(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Ao(t,e,r){return(e=Mo(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Co(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function To(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mo(n.key),n)}}function Mo(t){var e=function(t,e){if("object"!==Eo(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==Eo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===Eo(e)?e:String(e)}function Io(t,e){var r=t.map(gt).sort((function(t,e){return t[0]-e[0]})),n=function(t){var e,r=[],n=new Map,o=new Map,a=new Set,i=fo(t);try{for(i.s();!(e=i.n()).done;){var c,u=e.value,l="#000000",s=Oo(a,u);l=s.hex,s.status||(a.add(yo(mt(u))),l=yo(mt(u))),void 0===o.get(l)?o.set(l,[u]):null===(c=o.get(l))||void 0===c||c.push(u),n.has(l)||n.set(l,0),n.set(l,n.get(l)+1)}}catch(t){i.e(t)}finally{i.f()}for(var f=0,h=Array.from(a);f<h.length;f++){var p=h[f];if(1!==n.get(p)){var v,d=new Map,y=fo(o.get(p));try{for(y.s();!(v=y.n()).done;){var m=v.value;d.set(yo(mt(m)),!0)}}catch(t){y.e(t)}finally{y.f()}var g=Array.from(d.keys()).map(mo).map(gt);r.push(g)}else{var b=[];b.push(gt(mo(p))),r.push(b)}}return r}(new Set(r)),o=e,a=[],i=o.width*o.height,c=new Map,u=0;a=Array(n.length).fill([]);for(var l=0;l<n.length;l++)a[l]=Array(n[l].length).fill(0);for(var s=0;s<i;s++)if(0!==o.data[4*s+3]){var f=[o.data[4*s+0],o.data[4*s+1],o.data[4*s+2]],h=At(f);if(f=gt(f),c.has(h)){var p=c.get(h);if(void 0!==p){for(var v=0;v<p.length;v++){var d=p[v];a[d.gid][d.cid]+=1,u+=1}c.set(h,p)}}else{for(var y=[],m=0;m<n.length;m++)for(var g=0;g<n[m].length;g++){var b=n[m][g];if(Math.abs(f[0]-b[0])<.6&&Math.abs(f[1]-b[1])<.6&&Math.abs(f[2]-b[2])<.6){var w={gid:m,cid:g};y.push(w),a[m][g]+=1,u+=1}}c.set(h,y)}}for(var O=0;O<n.length;O++)for(var E=0;E<n[O].length;E++)0!==u&&(a[O][E]/=u);for(var S=[],j=[],_=0;_<n.length;_++){var x=0;S.push([0,0,0]);for(var L=0;L<n[_].length;L++){var A=n[_][L],C=a[_][L];S[_]=J(S[_],Y(A,C)),x+=C}S[_]=Y(S[_],1/(x+1e-4)),j.push(x)}for(var T=[],I=0;I<j.length;I++)0===j[I]&&T.push(I);for(var P=T.length-1;P>=0;P--)S.splice(T[P],1),j.splice(T[P],1),n.splice(T[P],1);for(var N=[],R=0;R<n.length;R++)if(N.push([]),n[R].length>1){var k,D=So(n[R]);try{for(D.s();!(k=D.n()).done;){var F=k.value;N[R].push(bo(F,S[R]))}}catch(t){D.e(t)}finally{D.f()}}for(var G=[],U=0;U<S.length;U++)G.push({color:Object(M.a)(At(mt(S[U]))),weight:j[U]});return{colorGroups:n,svgPalette:G,cToTFMap:N}}function Po(t){return(Po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function No(){No=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var a=e&&e.prototype instanceof y?e:y,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:_(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var h="suspendedStart",p="executing",v="completed",d={};function y(){}function m(){}function g(){}var b={};l(b,i,(function(){return this}));var w=Object.getPrototypeOf,O=w&&w(w(T([])));O&&O!==r&&n.call(O,i)&&(b=O);var E=g.prototype=y.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==Po(s)&&n.call(s,"__await")?e.resolve(s.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(s).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function _(e,r,n){var o=h;return function(a,i){if(o===p)throw new Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(e,r,n);if("normal"===l.type){if(o=n.done?v:"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=v,n.method="throw",n.arg=l.arg)}}}function x(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,d;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Po(e)+" is not iterable")}return m.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=l(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(j.prototype),l(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(s(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(E),l(E,u,"Generator"),l(E,i,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),d}},e}function Ro(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ko(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ro(Object(r),!0).forEach((function(e){Do(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ro(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Do(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==Po(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==Po(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===Po(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fo(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}var Go=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return function(t,e,r){e&&To(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1})}(t,[{key:"handle",value:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Co(a,n,o,i,c,"next",t)}function c(t){Co(a,n,o,i,c,"throw",t)}i(void 0)}))}}(_o().mark((function t(e){var r;return _o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Io(e.payload.colors,e.payload.svgImageData),t.abrupt("return",{id:e.id,type:e.type,payload:Lo(Lo({},r),{},{svgPalette:r.svgPalette.map((function(t){return{color:Q.toRGB(t.color),weight:t.weight}}))})});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),t}());function Uo(t,e){return 0===e.tintOrShade?t+(1-t)*e.value:t*(1-e.value)}function Bo(t,e){var r=gt(e);return!(t.preserveBlackAndWhite&&et(r)||t.preserveBlackAndWhite&&(rt(r)||no(r,[0,0,0],.08)))}function Ho(t,e,r){return Vo.apply(this,arguments)}function Vo(){return(Vo=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Fo(a,n,o,i,c,"next",t)}function c(t){Fo(a,n,o,i,c,"throw",t)}i(void 0)}))}}(No().mark((function t(e,r,n){var o,a,i,c,u;return No().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=performance.now(),a=(a=_r(e)).filter(Bo.bind(null,n)),i={payload:{colors:a,svgImageData:r}},t.next=6,Go.handle(i);case 6:return c=t.sent,u=performance.now(),t.abrupt("return",ko(ko({},c.payload),{},{initialColors:a,svgPalette:c.payload.svgPalette.map((function(t){return{color:Q.fromRGB(t.color),weight:t.weight}})),timeTaken:JSON.stringify(u-o)}));case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Wo(t,e){for(var r=e.colorGroups,n=[],o=[],a=0;a<r.length;a++)for(var i=0;i<r[a].length;i++){if(r[a].length>1){var c=gt(St(t[a])),u=xt(c[0],c[1],c[2]),l=e.cToTFMap[a][i];u.h+=l.colorShade[0].value,u.h+=1,u.h%=1,u.s=Uo(u.s,l.colorShade[1]),u.l=Uo(u.l,l.colorShade[2]),c=_t(u.h,u.s,u.l),o.push(mt(c))}else o.push(St(t[a]));n.push(mt(r[a][i]))}return[n.map((function(t){return Q.fromRGB([t[0],t[1],t[2]])})),o.map((function(t){return Q.fromRGB([t[0],t[1],t[2]])}))]}var qo={EMD:"EMD",EMD_HUNGARIAN:"EMD_HUNGARIAN",EMD_WEIGHTED_RANDOM:"EMD_WEIGHTED_RANDOM",EMD_SQRT:"EMD_SQRT",CLR_TRANS_CORR_SPACE:"CLR_TRANS_CORR_SPACE"},zo=r(854),Jo=r.n(zo),Ko=r(109),Yo=r(4);function Xo(t){return(Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zo(t){return function(t){if(Array.isArray(t))return ia(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||aa(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Qo(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?$o(Object(r),!0).forEach((function(e){ta(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ta(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==Xo(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==Xo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===Xo(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ea(){ea=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var a=e&&e.prototype instanceof y?e:y,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:_(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var h="suspendedStart",p="executing",v="completed",d={};function y(){}function m(){}function g(){}var b={};l(b,i,(function(){return this}));var w=Object.getPrototypeOf,O=w&&w(w(T([])));O&&O!==r&&n.call(O,i)&&(b=O);var E=g.prototype=y.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==Xo(s)&&n.call(s,"__await")?e.resolve(s.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(s).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function _(e,r,n){var o=h;return function(a,i){if(o===p)throw new Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(e,r,n);if("normal"===l.type){if(o=n.done?v:"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=v,n.method="throw",n.arg=l.arg)}}}function x(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,d;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Xo(e)+" is not iterable")}return m.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=l(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(j.prototype),l(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(s(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(E),l(E,u,"Generator"),l(E,i,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),d}},e}function ra(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function na(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){ra(a,n,o,i,c,"next",t)}function c(t){ra(a,n,o,i,c,"throw",t)}i(void 0)}))}}function oa(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||aa(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function aa(t,e){if(t){if("string"==typeof t)return ia(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ia(t,e):void 0}}function ia(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var ca=function(t){var e=oa(Object(o.useState)([]),2),r=e[0],n=e[1],c=oa(Object(o.useState)({useSaliency:!0,saliencyFactor:.7,preserveBlackAndWhite:!0,colorHarmony:N,selectedColors:[]}),2),u=c[0],l=c[1],s=oa(Object(o.useState)(),2),f=s[0],h=s[1];function p(e,r,o,a,i){n((function(t){if(!t[e])return t;var n=t[e].seed;return[].concat(Zo(t.slice(0,e)),[{url:r||"",loading:!1,recolorSVGResult:i,seed:n,error:o,reported:a,prompt:t[e].prompt}],Zo(t.slice(e+1)))})),t.setRecoloredSVG(i)}function v(t,e,r){return d.apply(this,arguments)}function d(){return(d=na(ea().mark((function e(n,o,a){var i,c,l,s,h,v,d;return ea().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=qo.EMD,c=w,l=!1,0===n?(c=O,i=qo.EMD_HUNGARIAN,l=!0):1===n?(c=w,i=qo.EMD_WEIGHTED_RANDOM):2===n?(c=w,i=qo.EMD):3===n&&(c=O,i=qo.CLR_TRANS_CORR_SPACE,l=!0),s=b,a?(n<r.length&&void 0!==r[n].recolorSVGResult&&void 0!==(h=r[n].recolorSVGResult)&&(v=h.originalSVGPalette),void 0===v&&(v=f)):v=f,void 0!==v){e.next=8;break}throw Error("workingAssetOriginalPalette must be present at this point");case 8:return e.next=10,oo(o,u.preserveBlackAndWhite?t.workingAsset.svg.svg:t.workingAsset.svg.svgWithDefaultStyleApplied,v,i,c,s,u,a,h,l);case 10:d=e.sent,p(n,o,void 0,void 0,d);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=na(ea().mark((function t(e,r,n,o){return ea().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!n){t.next=6;break}return t.next=4,v(e,n,r);case 4:t.next=7;break;case 6:p(e,void 0,o,void 0,void 0);case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),t.t0 instanceof Error&&"AbortError"===t.t0.name||(console.error(t.t0),Object(Yo.x)("Error while recoloring the image ".concat(t.t0)));case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))).apply(this,arguments)}return Object(o.useEffect)((function(){function e(){return(e=na(ea().mark((function e(){var r;return ea().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ho(u.preserveBlackAndWhite?t.workingAsset.svg.svg:t.workingAsset.svg.svgWithDefaultStyleApplied,t.workingAsset.svg.svgImage512.data,u);case 2:r=e.sent,h(r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t.workingAsset.svg]),Object(o.useEffect)((function(){t.activePalette.id&&t.activePalette.colors.length&&l(Qo(Qo({},u),{},{selectedColors:t.activePalette.colors.map((function(t){return Object(M.a)(t)}))}))}),[t.activePalette.id]),Object(o.useEffect)((function(){f?(function(){var e=t.workingAsset.seeds.map((function(e,r){return{url:"",loading:!0,prompt:t.workingAsset.processedPrompts[r],seed:e}}));n(e)}(),function(t,e,r,n){y.apply(this,arguments)}(0,!1,t.workingAsset.fileURL,!1)):(n([]),t.setRecoloredSVG(null))}),[f,t.workingAsset.seeds,u.colorHarmony,u.selectedColors]),a.a.createElement("div",{className:Jo.a.recolorContainer},a.a.createElement("div",{className:Jo.a.imageBefore},a.a.createElement("h2",null,a.a.createElement(i.a,{id:"original"})),a.a.createElement("img",{src:t.workingAsset.fileURL})),a.a.createElement("div",{className:Jo.a.imageAfter},a.a.createElement("h2",null,a.a.createElement(i.a,{id:"recolored"})),r.length&&!r[0].loading?a.a.createElement("img",{src:r[0].recolorSVGResult.recoloredSVGImage.dataUrl}):a.a.createElement(Ko.a,{style:{position:"absolute"},size:"L"})))},ua=r(1118),la=r.n(ua),sa=r(1119),fa=r.n(sa),ha=r(1105),pa=r(955),va=r.n(pa),da=r(1),ya=Object(o.forwardRef)((function(t,e){return a.a.createElement(a.a.Fragment,null,a.a.createElement("input",{type:"file",ref:e,onChange:function(){var r;if(null!==(r=e.current)&&void 0!==r&&r.files&&e.current.files.length>0){var n=e.current.files[0];n.upload_type="select_file",t.onSubmit(n)}}.bind(void 0),style:{display:"none"},accept:t.accept}),a.a.createElement("div",{className:va.a.dropZoneContainer},a.a.createElement(la.a,{onDrop:function(e){if(e.dataTransfer.files.length>0){var r=e.dataTransfer.files.item(0);r.upload_type="drag_drop",r&&(e.preventDefault(),t.onSubmit(r))}}},a.a.createElement("h1",{className:va.a.lineOne},t.title),a.a.createElement(fa.a,{heading:t.heading,description:a.a.createElement(ma,{onClick:function(){var t;return null===(t=e.current)||void 0===t?void 0:t.click()}}),illustration:a.a.createElement(ha.a,null)}))))})),ma=function(t){var e=da.Ub?"app.createfromimage.tapmessage":"app.createfromimage.selectfilemessage",r=da.Ub?"app.createfromimage.taptext":"app.createfromimage.selectfiletext";return a.a.createElement("span",null,a.a.createElement(i.a,{id:e,values:{selectFileText:a.a.createElement("span",{className:va.a.selectAFileOption,onClick:t.onClick},a.a.createElement(i.a,{id:r}))}}))},ga=ya,ba=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e5;return Math.floor(Math.random()*(e-t+1))+t},wa=r(204),Oa=r(25);function Ea(t){return(Ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sa(){Sa=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var a=e&&e.prototype instanceof y?e:y,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:_(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var h="suspendedStart",p="executing",v="completed",d={};function y(){}function m(){}function g(){}var b={};l(b,i,(function(){return this}));var w=Object.getPrototypeOf,O=w&&w(w(T([])));O&&O!==r&&n.call(O,i)&&(b=O);var E=g.prototype=y.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==Ea(s)&&n.call(s,"__await")?e.resolve(s.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(s).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function _(e,r,n){var o=h;return function(a,i){if(o===p)throw new Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(e,r,n);if("normal"===l.type){if(o=n.done?v:"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=v,n.method="throw",n.arg=l.arg)}}}function x(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,d;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(Ea(e)+" is not iterable")}return m.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=l(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(j.prototype),l(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(s(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(E),l(E,u,"Generator"),l(E,i,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),d}},e}function ja(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}var _a=Object(o.forwardRef)((function(t,e){function r(){return(r=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){ja(a,n,o,i,c,"next",t)}function c(t){ja(a,n,o,i,c,"throw",t)}i(void 0)}))}}(Sa().mark((function e(r){var n,o,a,i;return Sa().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.type!==m){e.next=18;break}return e.prev=1,e.next=4,Fr(r);case 4:n=e.sent,o=URL.createObjectURL(r),a=r.name.replace(/\.[^/.]+$/,""),n.fileURL=o,t.onWorkingAssetChange({inspiration:void 0,svg:n,name:a,visiblePrompt:void 0,processedPrompts:[],advancedParams:[],seeds:Array.from(Array(1).keys()).map((function(){return ba()})),preset:void 0,fileURL:n.fileURL}),i={workflow:da.Mb.COLOR_LABS,subcategory:da.Mb.VECTOR_RECOLOR,value:r.upload_type},Object(Oa.a)(da.Kb.FILE_UPLOAD,{event:i},[da.Mb.COLOR_LABS,da.Mb.VECTOR_RECOLOR]),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),console.error("Error processing input SVG file: ",e.t0);case 16:e.next=19;break;case 18:wa.b.negative(t.intl.formatMessage({id:"invalid.svg"}),{timeout:da.Tc});case 19:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}return a.a.createElement("div",{className:t.isHidden&&Jo.a.hidden},a.a.createElement(ga,{onSubmit:function(t){return r.apply(this,arguments)},accept:m,title:t.intl.formatMessage({id:"recolor.artwork"}),heading:t.intl.formatMessage({id:"drop.svg"}),ref:e}))})),xa=r.p+"32ddfa4dcc07d8d187caf55322ea5b6d.png";function La(t){return(La="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Aa(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==La(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==La(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===La(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ca(){Ca=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function s(t,e,r,n){var a=e&&e.prototype instanceof y?e:y,i=Object.create(a.prototype),c=new C(n||[]);return o(i,"_invoke",{value:_(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var h="suspendedStart",p="executing",v="completed",d={};function y(){}function m(){}function g(){}var b={};l(b,i,(function(){return this}));var w=Object.getPrototypeOf,O=w&&w(w(T([])));O&&O!==r&&n.call(O,i)&&(b=O);var E=g.prototype=y.prototype=Object.create(b);function S(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==La(s)&&n.call(s,"__await")?e.resolve(s.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(s).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function _(e,r,n){var o=h;return function(a,i){if(o===p)throw new Error("Generator is already running");if(o===v){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var u=x(c,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var l=f(e,r,n);if("normal"===l.type){if(o=n.done?v:"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=v,n.method="throw",n.arg=l.arg)}}}function x(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,d;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,d):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,d)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(La(e)+" is not iterable")}return m.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=l(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(j.prototype),l(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(s(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(E),l(E,u,"Generator"),l(E,i,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),d}},e}function Ta(t,e,r,n,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void r(t)}c.done?e(u):Promise.resolve(u).then(n,o)}function Ma(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){Ta(a,n,o,i,c,"next",t)}function c(t){Ta(a,n,o,i,c,"throw",t)}i(void 0)}))}}function Ia(){return(Ia=Ma(Ca().mark((function t(e){var r,n,o;return Ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:return r=t.sent,t.next=5,r.blob();case 5:return n=t.sent,t.next=8,createImageBitmap(n);case 8:return o=t.sent,t.abrupt("return",o);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Pa(t){return Na.apply(this,arguments)}function Na(){return(Na=Ma(Ca().mark((function t(e){var r;return Ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:return r=t.sent,t.next=5,r.blob();case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ra(t,e,r,n){e.drawImage(r,n,t.height-r.height-n)}var ka={"image/png":"png","image/jpeg":"jpg","image/webp":"webp","image/svg+xml":"svg"};function Da(t,e){var r=function(t){return ka[t]}(e),n="AdobeColor_".concat(t).slice(0,100);return n=n.replace(/[^\w\s-]/g,""),"".concat(n,".").concat(r)}var Fa=r(1121),Ga=r(35);function Ua(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ba(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ba(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ba(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Ha=[{selectorId:"#coachmarks-palette-label",title:"browser.themes",description:"browser.themes.desc",placement:"right top"},{selectorId:"#react-spectrum-1-tab-1",title:"find.favourites",description:"find.favourites.desc",placement:"bottom right"},{selectorId:"#btn-vector-replace",title:"replace.artwork",description:"replace.artwork.desc",placement:"bottom left"},{selectorId:"#btn-vector-download",title:"download.artwork",description:"download.artwork.desc",placement:"bottom left"}],Va=Object(i.e)((function(t){var e=Ua(Object(o.useState)(),2),r=e[0],n=e[1],i=Ua(Object(o.useState)(),2),c=i[0],l=i[1],s=Object(u.e)((function(t){return t.user.IMSReady})),f=Object(u.e)((function(t){return t.user.isLoggedIn})),p=Object(o.useRef)(),d=function(){var t=function(t){var e=Object(o.useRef)(),r=Object(o.useRef)();return r.current||(r.current=!0,function(t){return Ia.apply(this,arguments)}(t).then((function(t){e.current=t}))),e}(xa),e=function(){var e=Ma(Ca().mark((function e(r,n){var o,a,i,c,u=arguments;return Ca().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=u.length>2&&void 0!==u[2]?u[2]:0,"image/png"===n||"image/jpeg"===n){e.next=4;break}return console.error("applyToImageBlob used with unsupported mimeType"),e.abrupt("return",URL.createObjectURL(r));case 4:return e.next=6,createImageBitmap(r);case 6:if(a=e.sent,i=document.createElement("canvas"),c=i.getContext("2d"),i.width=a.width,i.height=a.height,c&&t.current){e.next=13;break}return e.abrupt("return",URL.createObjectURL(r));case 13:return c.drawImage(a,0,0),Ra(i,c,t.current,o),e.abrupt("return",i.toDataURL(n,"image/jpeg"===n?1:void 0));case 16:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();function r(t,e){return n.apply(this,arguments)}function n(){return(n=Ma(Ca().mark((function t(r,n){var o,a,i,c,u,l;return Ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=navigator.userAgent.includes("Safari"),a=navigator.userAgent.includes("Chrome"),i=o&&!a,u="","string"!=typeof r){t.next=9;break}u=r,c=fetch(r).then((function(t){return t.blob()})).then((function(t){return e(t,"image/png")})).then((function(t){return Pa(t)})),t.next=14;break;case 9:if(!(r instanceof Promise)){t.next=13;break}c=r.then((function(t){return e(t,"image/png")})).then((function(t){return Pa(t)})),t.next=14;break;case 13:return t.abrupt("return",Promise.reject(new Error("Unsupported blob type")));case 14:if(!i){t.next=19;break}return t.next=17,navigator.clipboard.write([new ClipboardItem({"image/png":c})]);case 17:t.next=24;break;case 19:return t.next=21,c;case 21:return l=t.sent,t.next=24,navigator.clipboard.write([new ClipboardItem(Aa({},l.type,l))]);case 24:n&&window.URL.revokeObjectURL(u);case 25:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return{applyWatermarkToImageBlob:e,applyWatermarkToCanvas:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e.getContext("2d");n&&t.current&&Ra(e,n,t.current,r)},downloadObjectUrlAsFile:function(t,e){var r=document.createElement("a");r.href=t,r.download=e,document.body.append(r),r.onclick=function(){document.body.removeChild(r),window.setTimeout((function(){window.URL.revokeObjectURL(t)}),0)},r.click()},copyObjectUrlToClipboard:function(){var t=Ma(Ca().mark((function t(e){var r,n,o,a,i=arguments;return Ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=!(i.length>1&&void 0!==i[1])||i[1],n=navigator.userAgent.includes("Safari"),o=navigator.userAgent.includes("Chrome"),!n||o){t.next=9;break}return t.next=7,navigator.clipboard.write([new ClipboardItem({"image/png":Pa(e)})]);case 7:t.next=14;break;case 9:return t.next=11,Pa(e);case 11:return a=t.sent,t.next=14,navigator.clipboard.write([new ClipboardItem(Aa({},a.type,a))]);case 14:r&&window.URL.revokeObjectURL(e);case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),copyToClipboardWithWaterMark:r,copyBlobToClipboardWithWatermark:function(){var t=Ma(Ca().mark((function t(e){return Ca().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e,!1));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}();function g(t){l(t)}var b=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"AdobeColor";if(t){var r=new Blob([t],{type:m}),n=URL.createObjectURL(r),o=Da("".concat(e,"_recolored"),"image/svg+xml");d.downloadObjectUrlAsFile(n,o);var a={workflow:da.Mb.COLOR_LABS,subcategory:da.Mb.VECTOR_RECOLOR};Object(Oa.a)(da.Kb.DOWNLOAD,{event:a},[da.Mb.COLOR_LABS,da.Mb.VECTOR_RECOLOR])}};return Object(o.useEffect)((function(){var t=Ga.a.getItem("rclrd-svg"),e=Ga.a.getItem("rclrd-name");t&&f&&(b(t,e),Ga.a.removeItem("rclrd-svg"),Ga.a.removeItem("rclrd-name"))}),[f]),a.a.createElement("div",{className:Jo.a.tabsContent},a.a.createElement("div",{className:Jo.a.replaceImage},a.a.createElement(h.a,{quiet:!0,id:"btn-vector-replace",variant:"action",label:t.intl.formatMessage({id:"replace.artwork"}),icon:a.a.createElement(v.a,null),alt:t.intl.formatMessage({id:"replace.artwork"}),disabled:!c,onClick:function(){var t;null===(t=p.current)||void 0===t||t.click();var e={workflow:da.Mb.COLOR_LABS,subcategory:da.Mb.VECTOR_RECOLOR};Object(Oa.a)(da.Kb.REPLACE_IMAGE,{event:e},[da.Mb.COLOR_LABS,da.Mb.VECTOR_RECOLOR])}}),a.a.createElement(h.a,{id:"btn-vector-download",quiet:!0,variant:"action",label:t.intl.formatMessage({id:"download"}),icon:a.a.createElement(y.a,null),alt:t.intl.formatMessage({id:"download"}),disabled:!c,onClick:function(){if(s&&f)b(null==r?void 0:r.recoloredSVG,c.name);else{try{Ga.a.setItem("rclrd-svg",null==r?void 0:r.recoloredSVG),Ga.a.setItem("rclrd-name",c.name)}catch(t){Object(Yo.x)("Error while saving recolored image ".concat(t))}window.adobeIMS.signIn()}}})),c&&a.a.createElement(ca,{activePalette:t.activePalette,workingAsset:c,setRecoloredSVG:n,onWorkingAssetChange:g}),a.a.createElement(_a,{onWorkingAssetChange:g,ref:p,intl:t.intl,isHidden:c}),a.a.createElement(Fa.a,{steps:Ha,cookie:da.vc.VECTOR_RECOLOR}))})),Wa=(r(1569),r(142)),qa=r(61),za=r(11),Ja=r(1005),Ka=r(1026),Ya=r(956),Xa=r.n(Ya),Za=Object(i.e)((function(t){var e=t.history,r=t.intl;return a.a.createElement("div",{className:Xa.a.emptyMyThemes},a.a.createElement("div",{className:Xa.a.lineOne},a.a.createElement(i.a,{id:"app.mythemes.emptylibraries.lineone"})),a.a.createElement("div",{className:Xa.a.lineTwo},a.a.createElement(i.a,{id:"app.mythemes.emptylibraries.linetwo"})),a.a.createElement("div",{className:Xa.a.redirect},a.a.createElement(h.a,{variant:"cta",label:r.formatMessage({id:"app.mythemes.emptylibraries.redirectbutton"}),onClick:function(){return e.push("/create")},className:Xa.a.redirectButton})))})),$a=r(957),Qa=r.n($a);function ti(){return(ti=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}var ei=function(t){var e;if(null!==(e=t.swatches)&&void 0!==e&&e.length){var r=t.swatches.map((function(t){return t.hex})),n={id:t.id,name:t.name,colors:r};return a.a.createElement("color-palette",{palette:JSON.stringify(n)})}return null},ri=function(t){return a.a.createElement("div",{id:"gridWrapper",className:Qa.a.myThemesGrid},a.a.createElement(Ka.a,null,t.libFeed.map((function(e){return function(e){return a.a.createElement(ei,{swatches:e.data.swatches,handlePaletteSelect:t.handlePaletteSelect,id:e.data.id,name:e.data.name,key:e.data.id})}({data:e})}))),t.canLoadMore(t.elements,t.libFeed.length)&&a.a.createElement(h.a,{className:Qa.a.loadMorethemes,onClick:function(){return t.loadMoreThemes(t.criteria)},label:t.intl.formatMessage({id:"app.mythemes.showmore"}),quiet:!0,variant:"primary"}))},ni=Object(i.e)((function(t){var e=t.showEmptyMyThemes,r=Object(za.g)();return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",null,a.a.createElement(Ja.Accordion,null,t.feed.map((function(e,r){var n=a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:Qa.a.libraryName},e.libraryName),a.a.createElement("div",{className:Qa.a.libraryThemeCount},e.themeCount," ",a.a.createElement(i.a,{id:"app.mythemes.themes"})));return a.a.createElement(Ja.AccordionItem,{header:n,key:r,className:Qa.a.accordionItem},a.a.createElement(ri,ti({},t,{readOnly:e.readOnly,libFeed:e.libraryFeed,criteria:e.criteria,elements:e.totalElements})))}))),e&&a.a.createElement(Za,{pageName:da.mc,history:r})))})),oi=r(1006),ai=r(992),ii=r(958),ci=r.n(ii);function ui(t){return(ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function li(t){return function(t){if(Array.isArray(t))return si(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return si(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?si(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function si(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function fi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bi(n.key),n)}}function pi(t,e,r){return e&&hi(t.prototype,e),r&&hi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vi(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&function(t,e){(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}function di(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=mi(t);if(e){var o=mi(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(t,e){if(e&&("object"===ui(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return yi(t)}(this,r)}}function yi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function mi(t){return(mi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gi(t,e,r){return(e=bi(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bi(t){var e=function(t,e){if("object"!==ui(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e);if("object"!==ui(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"===ui(e)?e:String(e)}var wi=function(t){vi(r,o.Component);var e=di(r);function r(t){var n;return fi(this,r),gi(yi(n=e.call(this,t)),"manageLibraryLoadingFromURL",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];n.props.changeCriteria(t)})),gi(yi(n),"loadMoreLibraries",(function(){var t=n.props.fetchPage,e=n.props.href,r=new AbortController;n.setState({libFetchDisabled:!0});var o=[],a=config("CCLIBRARIES_ENDPOINT").melvilledomainPath,i="".concat(a).concat(e,"&toolkit=none");n.props.fetchAllLibraries(i,r.signal).then((function(e){var r=Object(Yo.u)(e.themes)?{}:n.props.fetchThemeListFromCriteria();o=r.map((function(t){return{main:t.id,name:t.name}})),n.props.initMythemesPage({sources:[da.p],criteria:o,sortOption:da.jb.LAST_MODIFIED}),n.manageLibraryLoadingFromURL(o),t(),n.setState({libFetchDisabled:!1})}))})),gi(yi(n),"loadMoreThemes",(function(t){(0,n.props.fetchMorePage)(t)})),gi(yi(n),"canLoadMoreThemes",(function(t,e){return e>0&&e<t})),n.state={libraryNotFound:!1,libFetchDisabled:!1},n}return pi(r,[{key:"componentWillUnmount",value:function(){this.props.changeCriteria([]),this.props.isUserLoggedIn&&this.props.clearLibraries()}},{key:"componentDidMount",value:function(){var t=this,e=this.props.fetchPage,r=[];this.props.initLibraries(),this.props.fetchLibraries().then((function(n){r=n.map((function(t){return{main:t.id,name:t.name}})),t.props.initMythemesPage({sources:[da.p],criteria:r,sortOption:da.jb.LAST_MODIFIED}),t.manageLibraryLoadingFromURL(r),e()}))}},{key:"render",value:function(){var t=this.props,e=t.feed,r=t.showEmptyMyThemes,n=t.href;return this.state.libraryNotFound?a.a.createElement(Wa.a,{type:404}):this.props.librariesFetchStatus||0!==this.props.libraries.length?a.a.createElement(a.a.Fragment,null,a.a.createElement(ni,{handlePaletteSelect:this.props.handlePaletteSelect,feed:e,showEmptyMyThemes:r,loadMoreThemes:this.loadMoreThemes,canLoadMore:this.canLoadMoreThemes}),e.length>0&&a.a.createElement("div",{className:ci.a.loadMoreButton},""!==n&&a.a.createElement(h.a,{label:this.props.intl.formatMessage({id:"app.mythemes.loadmore"}),variant:"primary",onClick:this.loadMoreLibraries,icon:this.state.libFetchDisabled?a.a.createElement(Ko.a,{style:{position:"absolute"},size:"S"}):null,disabled:this.state.libFetchDisabled}))):a.a.createElement("div",{className:ci.a.loaderContainer},a.a.createElement(Ko.a,{style:{position:"absolute"},size:"L"}))}}]),r}(),Oi=function(t){vi(r,o.Component);var e=di(r);function r(){return fi(this,r),e.apply(this,arguments)}return pi(r,[{key:"render",value:function(){var t=this.props,e=t.imsReady,r=t.isUserLoggedIn;if(e){if(r)return a.a.createElement(wi,this.props);window.adobeIMS&&window.adobeIMS.signIn()}return a.a.createElement("div",{className:ci.a.loaderContainer},a.a.createElement(Ko.a,{style:{position:"absolute"},size:"L"}))}}]),r}(),Ei=Object(u.b)((function(t){var e=t.mythemes,r=t.criteriaDataCollection,n=t.user,o=t.libraries,a=n.IMSReady,i=n.isLoggedIn,c=e.srcFilter,u=e.criteria,l=o.criteria,s=[],f=[],h={},p=!1,v=0,d="";return Object(Yo.u)(r[JSON.stringify(l[0])])||(d=r[JSON.stringify(l[0])].cclibrary.next),l.forEach((function(t){Object(Yo.u)(r[JSON.stringify(t)])||(f=li(r[JSON.stringify(t)].cclibrary.themeList),p=Object(Yo.b)(r[JSON.stringify(l[0])].cclibrary.fetchStatus))})),u.forEach((function(t){if(h={},c&&c.includes(da.p)&&!Object(Yo.u)(r[JSON.stringify(t)])){var e=f.find((function(e){return e.id===t.main}));Object(Yo.u)(e)||(h.libraryName=t.name,h.libraryFeed=li(r[JSON.stringify(t)].cclibrary.themeList),h.collaborated=e.libraryScope===da.q,h.readOnly=e.readOnly,h.criteria=JSON.stringify(t),h.themeCount=r[JSON.stringify(t)].cclibrary.themeCount,h.gradientCount=r[JSON.stringify(t)].cclibrary.gradientCount,h.totalElements=e.totalElements,s=[].concat(li(s),[h]),r[JSON.stringify(t)].cclibrary.fetchStatus===da.h.COMPLETED_SUCCESSFULLY&&v++)}})),{feed:s,imsReady:a,isUserLoggedIn:i,libraries:f,href:d,librariesFetchStatus:p,showEmptyMyThemes:p&&0===s.length&&v===f.length}}),(function(t){return Object(qa.b)({changeCriteria:ai.a,fetchPage:ai.e,fetchMorePage:ai.d,initMythemesPage:ai.g,fetchLibraries:oi.c,fetchAllLibraries:oi.b,fetchThemeListFromCriteria:oi.d,initLibraries:oi.g,clearLibraries:oi.a},t)}))(Oi),Si=Object(i.e)(Ei),ji=r(1007),_i=r(959),xi=r.n(_i);function Li(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Ai={cs:"en-US",da:"da-DK",de:"de-DE",en:"en-US",es:"es-ES",fi:"fi-FI",fr:"fr-FR",it:"it-IT",ja:"ja-JP",ko:"ko-KR",nb:"nb-NO",nl:"nl-NL",pl:"en-US",pt:"pt-BR",ru:"en-US",sv:"sv-SE",tr:"en-US",zh:"zh-Hans-CN"};e.default=Object(i.e)((function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,a,i,c=[],u=!0,l=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Li(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Li(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Object(o.useState)({}),2),r=e[0],n=e[1],f=Object(u.e)((function(t){return t.user.locale})),h=Object(o.useRef)(),p=function(t){n(t.detail.palette);var e,r="color-palette"===t.target.tagName.toLowerCase(),o=t.detail.searchQuery;e=r?"USER_LIBRARIES":o?"SEARCH":"CURATED_PALETTES";var a={workflow:da.Mb.COLOR_LABS,subcategory:da.Mb.VECTOR_RECOLOR,source:e};o&&(a.value=o),Object(Oa.a)(da.Kb.APPLY_PALETTE,{event:a},[da.Mb.COLOR_LABS])};return Object(o.useEffect)((function(){var t;null===(t=h.current)||void 0===t||t.addEventListener("ac-palette-select",p),Object(Yo.A)("recolor");var e=Ga.a.getItem("recolor_redirection");e&&Ga.a.removeItem("recolor_redirection");var r={workflow:da.Mb.COLOR_LABS,subcategory:da.Mb.VECTOR_RECOLOR,source:null!=e?e:"others"};return Object(Oa.a)(da.Kb.COLOR_LABS_DEFAULT_PAGE,{event:r},[da.Mb.COLOR_LABS_DEFAULT_PAGE]),function(){var t;ji.a.clearQueue(),null===(t=h.current)||void 0===t||t.removeEventListener("ac-palette-select",p)}}),[]),da.Sb&&!da.Rb?a.a.createElement(Wa.a,{type:404,pageDescription:"recolor.artwork"}):a.a.createElement("div",{className:xi.a.create,ref:h},a.a.createElement("div",{className:xi.a.resetMinWidth},a.a.createElement(s.TabView,{className:xi.a.createContainer,selectedIndex:t.selectedIndex},a.a.createElement(l.Tab,{label:t.intl.formatMessage({id:"app.recolor"})},a.a.createElement(c.Helmet,null,a.a.createElement("title",null,t.intl.formatMessage({id:"seo.recolor.title"})),a.a.createElement("meta",{name:"description",content:t.intl.formatMessage({id:"seo.recolor.description"})}),a.a.createElement("link",{rel:"canonical",href:"https://color.adobe.com/color-labs/recolor-svg"})),a.a.createElement(Va,{activePalette:r})))),a.a.createElement(s.TabView,{className:xi.a.labsPalettes,defaultSelectedIndex:0},a.a.createElement(l.Tab,{label:t.intl.formatMessage({id:"recolor.themes"})},r.id&&a.a.createElement("div",{className:xi.a.activePaletteActions},a.a.createElement(i.a,{id:"recolor.theme"})),r.id&&a.a.createElement("color-palette",{active:!0,palette:JSON.stringify(r)}),a.a.createElement("section",{className:xi.a.globalColorsUI},a.a.createElement("global-colors-ui",{env:"production"===config("ENVIRONMENT")?"prod":"stage",locale:Ai[f]}),a.a.createElement("div",{id:"coachmarks-palette-label"}))),a.a.createElement(l.Tab,{label:t.intl.formatMessage({id:"your.themes"})},r.id&&a.a.createElement("div",{className:xi.a.activePaletteActions},a.a.createElement(i.a,{id:"recolor.theme"})),r.id&&a.a.createElement("color-palette",{active:!0,palette:JSON.stringify(r)}),a.a.createElement(Si,{handlePaletteSelect:p}))))}))},987:function(t,e,r){"use strict";r.d(e,"a",(function(){return v})),r.d(e,"b",(function(){return d})),r.d(e,"g",(function(){return y})),r.d(e,"f",(function(){return m})),r.d(e,"c",(function(){return g})),r.d(e,"e",(function(){return b})),r.d(e,"j",(function(){return w})),r.d(e,"h",(function(){return O})),r.d(e,"i",(function(){return E})),r.d(e,"d",(function(){return S}));var n=r(2),o=r(1002),a=r(1004),i=r(67),c=r(1),u=r(36),l=r(4);function s(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return f(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function h(t){var e=t.save,r=t.create,n={};return n.name=e.themeName?e.themeName:c.Z,n.tags=e.tagsToSave,n.swatches=r.order.map((function(t){return Object(u.m)(r.swatches[t])})),n.harmony={baseSwatchIndex:r.order.indexOf(r.baseColorIndex),mood:r.colorMood,rule:r.harmonyRule},r.workflow===c.K.ACCESSIBILITY&&r.isAccessible&&(n.accessibilityData={colorBlindSafe:r.isAccessible}),n.colorMode=r.colorMode,n}function p(t){var e=t.save,r=t.colorContrast,n={};return n.name=e.themeName,n.tags=e.tagsToSave,n.colorMode=c.X,n.swatches=[Object(u.m)(r.foregroundSwatch),Object(u.m)(r.backgroundSwatch)],n.harmony={baseSwatchIndex:0,mood:"CUSTOM",rule:"CUSTOM"},n.accessibilityData={wcagLevel:Object(l.p)(r.contrastRatio)},n}function v(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:n.b,payload:t}}function d(){return{type:n.j}}function y(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:n.Z,payload:t}}function m(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:n.V,payload:t}}function g(t){return function(e,r){var o=config("AUTOTAG_ENDPOINT").basePath,a=config("AUTOTAG_ENDPOINT").api,u=r(),f=u.create,h=u.colorContrast,p=[],v=new URLSearchParams,d=function(t){var e=t.user,r={"x-api-key":config("ETHOS_ENDPOINT").clientId,"Content-Type":"application/json"};return e.isLoggedIn&&(r.Authorization="Bearer ".concat(e.token)),r}(r()),y=[];t===c.K.COLOR_CONTRAST?(y.push(h.foregroundSwatch),y.push(h.foregroundSwatch),y.push(h.backgroundSwatch),y.push(h.backgroundSwatch),y.push(h.backgroundSwatch)):y=f.swatches,y.forEach((function(t){return p.push([t.rgb.r/c.A.MAX.RGB.R,t.rgb.g/c.A.MAX.RGB.G,t.rgb.b/c.A.MAX.RGB.B])}));var m="".concat(o).concat(a);return v.append("q",JSON.stringify({values:p.concat.apply([],p)})),m="".concat(o).concat(a,"?").concat(v.toString()),Object(i.c)(m,d).then((function(r){var o=r.tags.map((function(t){return Object(l.d)(t)}));t===c.K.ACCESSIBILITY?o=[].concat(s(c.u),s(o)).slice(0,5):t===c.K.COLOR_CONTRAST&&(o=[].concat(s(c.w),s(o)).slice(0,5)),e(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:n.ab,payload:t}}(o))}))}}function b(t,e){switch(t){case c.g.GRADIENT:return function(r,n){var i=n(),u=i.save,l=i.user,s=function(t){var e=t.save,r=t.create,n={};return n.name=e.themeName?e.themeName:c.W,n.interpolation=c.cb.interpolation,n.angle=c.cb.angle,n.aspectRatio=c.cb.aspectRatio,n.type=c.cb.type,n.stops=[],r.order.forEach((function(t){var e=r.swatches[t],o=[{mode:c.X,value:{r:e.rgb.r,g:e.rgb.g,b:e.rgb.b}}];n.stops.push({color:o,offset:e.offset,midpoint:e.midpoint})})),n}(n()),f=r(Object(o.f)("",{gradient:s},t,e)),h="";return u.publishToKuler&&l.isAllowedToPublish?(h=u.library.id,f.then((function(t){var e=t.response,n={};return n.id=e.elements[0].id,r(Object(a.h)(function(t,e,r,n){var o={},a=t.elements[0];return o.libraryId=e,o.assetId=a.id,o.gradientName=a.name,o.rendition=r,o.rendition.type="linear",o.assetType=a.thumbnail.type,o.renditionMimeType=a.thumbnail.rendition_mimetype,o.tags=n,o}(e,h,s,u.tagsToSave),n)),u.library.name})).catch((function(t){throw console.error(t),t}))):f.then((function(){return u.library.name})).catch((function(t){throw console.log(t),t}))};default:return function(r,n){var i=n(),u=i.save,l=i.user,s=e===c.K.COLOR_CONTRAST?p(n()):h(n()),f=r(Object(o.f)("",{theme:s},t,e));return u.publishToKuler&&l.isAllowedToPublish?(s.libraryid=u.library.id,f.then((function(t){var e=t.response,n={};return n.id=e.elements[0].id,r(Object(a.i)(s,n)),u.library.name})).catch((function(t){throw console.error(t),t}))):f.then((function(){return u.library.name})).catch((function(t){throw console.error(t),t}))}}}function w(t,e){return function(r,n){var i=n().save,u=e===c.K.COLOR_CONTRAST?p(n()):h(n());u.cclibraryThemeUpdateLibId=i.cclibraryThemeUpdateLibId,u.cclibraryThemeUpdateAssetId=i.cclibraryThemeUpdateAssetId;var l=r(Object(o.h)(t,u));return i.publishToKuler?(u.libraryid=i.library.id,l.then((function(t){var e=t.response;return r(Object(a.i)(u,e)),i.library.name})).catch((function(t){return console.error(t)}))):l.then((function(){return i.library.name})).catch((function(t){return console.error(t)}))}}function O(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:n.db,payload:t}}function E(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:n.nb,payload:t}}function S(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{type:n.B,payload:t}}},988:function(t,e,r){"use strict";r.d(e,"b",(function(){return o})),r.d(e,"d",(function(){return a})),r.d(e,"c",(function(){return i})),r.d(e,"i",(function(){return c})),r.d(e,"g",(function(){return u})),r.d(e,"h",(function(){return l})),r.d(e,"e",(function(){return s})),r.d(e,"a",(function(){return f})),r.d(e,"f",(function(){return h})),r.d(e,"l",(function(){return p})),r.d(e,"o",(function(){return v})),r.d(e,"p",(function(){return d})),r.d(e,"m",(function(){return y})),r.d(e,"k",(function(){return m})),r.d(e,"n",(function(){return g})),r.d(e,"j",(function(){return b}));var n=r(2);function o(t,e,r){return{type:n.i,payload:r,srcName:e,criteria:t}}function a(t,e,r){return{type:n.l,payload:r,srcName:e,criteria:t}}function i(t,e,r){return{type:n.k,payload:r,srcName:e,criteria:t}}function c(t,e,r){return{type:n.kb,payload:r,srcName:e,criteria:t}}function u(t,e,r){return{type:n.ib,payload:r,srcName:e,criteria:t}}function l(t,e,r){return{type:n.jb,payload:r,srcName:e,criteria:t}}function s(t,e,r){return{type:n.z,payload:r,srcName:e,criteria:t}}function f(t,e,r){return{type:n.a,payload:r,srcName:e,criteria:t}}function h(t,e,r){return{type:n.eb,criteria:t,payload:r,srcName:e}}function p(t,e,r){return{type:n.pb,criteria:t,payload:r,srcName:e}}function v(t,e,r){return function(o){return o({type:n.sb,srcName:e,criteria:t,payload:r})}}function d(t,e,r){return{type:n.tb,payload:r,srcName:e,criteria:t}}function y(t,e,r){return{type:n.qb,payload:r,srcName:e,criteria:t}}function m(t,e,r){return{type:n.ob,payload:r,srcName:e,criteria:t}}function g(t){return{type:n.rb,payload:t,criteria:t.criteria,srcName:t.srcName}}function b(t){return{type:n.mb,payload:t,criteria:t.criteria,srcName:t.srcName}}},992:function(t,e,r){"use strict";r.d(e,"a",(function(){return l})),r.d(e,"b",(function(){return s})),r.d(e,"e",(function(){return f})),r.d(e,"f",(function(){return h})),r.d(e,"d",(function(){return p})),r.d(e,"g",(function(){return v})),r.d(e,"c",(function(){return d})),r.d(e,"j",(function(){return y})),r.d(e,"m",(function(){return m})),r.d(e,"l",(function(){return g})),r.d(e,"i",(function(){return b})),r.d(e,"h",(function(){return w})),r.d(e,"k",(function(){return O}));var n=r(1),o=r(2),a=r(993),i=r(4);function c(t,e){var r=config("CCLIBRARIES_ENDPOINT"),o=r.melvilleBasePath,a=r.librariesApi,i=r.themesApi,c=n.Sb?"".concat(encodeURIComponent(n.Mc)):"".concat(encodeURIComponent(n.Mc),",").concat(encodeURIComponent(n.wb));return"".concat(o).concat(a,"/").concat(t.main).concat(i,"?start=").concat(e,"&limit=").concat(n.jc,"&selector=representations&type=").concat(c)}function u(t,e){var r=config("ETHOS_ENDPOINT"),n=r.basePathForSearch,o=r.api,a=r.searchPath;return"".concat("".concat(n).concat(o).concat(a,"?q=%7B%22","asset_id","%22%3A%22").concat(encodeURIComponent(t),"%22%7D"),"&maxNumber=1&assetType=",e)}var l=function(t){return function(e){return e(a.a(n.kc,t))}},s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.jb.LAST_MODIFIED;return function(e){return e({type:o.e,pageName:n.kc,payload:t})}},f=function(){return function(t,e){var r=e().mythemes,o=r.criteria,u=r.srcFilter,l={},s=e().criteriaDataCollection,f=e().libraries.criteria[0],h=2*n.ic,p=0;Object(i.u)(s[JSON.stringify(f)])||Object(i.u)(s[JSON.stringify(f)]).cclibrary||(p=s[JSON.stringify(f)].cclibrary.startIndex,p=Math.floor((p-1)/h)*h),o.slice(p,o.length).forEach((function(e){l.ccLibraryUrl=c(e,0),t(a.o(JSON.stringify(e),u,l,!0))}))}},h=function(){return function(t,e){var r=e().mythemes,n=r.criteria,o=r.srcFilter,i={},u=n[0];i.ccLibraryUrl=c(u,0),t(a.o(JSON.stringify(u),o,i,!0))}},p=function(t){return function(e,r){var n=r().mythemes.srcFilter,o={},i=r().criteriaDataCollection[t].cclibrary.startIndex;o.ccLibraryUrl=c(JSON.parse(t),i),e(a.o(t,n,o,!0))}},v=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:initState;return function(e){return e(a.p(n.kc,t))}},d=function(t,e){return function(r){return r(a.h(e,t))}},y=function(t,e){return function(r){return r(a.q(t,e))}},m=function(t,e){return function(r,n){var o=n().mythemes.srcFilter;return r(a.w(t,o[0],e))}},g=function(t,e){return function(r,n){var o=n().mythemes.srcFilter;return r(a.v(t,o[0],e))}},b=function(t,e){return function(r){var n=u(t,"THEME");return r(a.s(n,e,"THEME"))}},w=function(t,e){return function(r){var n=u(t,"GRADIENT");return r(a.s(n,e,"GRADIENT"))}},O=function(t,e,r){return function(n){return n(a.t(t,e,r))}}},993:function(t,e,r){"use strict";r.d(e,"a",(function(){return d})),r.d(e,"b",(function(){return y})),r.d(e,"c",(function(){return m})),r.d(e,"j",(function(){return g})),r.d(e,"o",(function(){return b})),r.d(e,"d",(function(){return w})),r.d(e,"l",(function(){return O})),r.d(e,"f",(function(){return E})),r.d(e,"k",(function(){return S})),r.d(e,"n",(function(){return j})),r.d(e,"m",(function(){return _})),r.d(e,"i",(function(){return x})),r.d(e,"p",(function(){return L})),r.d(e,"x",(function(){return A})),r.d(e,"u",(function(){return C})),r.d(e,"t",(function(){return T})),r.d(e,"q",(function(){return M})),r.d(e,"h",(function(){return I})),r.d(e,"r",(function(){return P})),r.d(e,"g",(function(){return N})),r.d(e,"w",(function(){return R})),r.d(e,"v",(function(){return k})),r.d(e,"s",(function(){return D})),r.d(e,"e",(function(){return F}));var n=r(2),o=r(1);function a(t){return{type:n.q,criteria:t}}var i=r(1004),c=r(1019),u=r(1020),l=r(1002),s=r(988),f=r(67),h=r(4);function p(t){return t.themes=[],t.result_sets&&t.result_sets[0]&&t.result_sets[0].items&&(t.themes=t.result_sets[0].items,delete t.result_sets[0].items),t}function v(t){var e=t.user,r={"x-api-key":e.isLoggedIn?config("CLIENT_ID"):config("ETHOS_ENDPOINT").clientId,"x-product":config("UNIVERSAL_SEARCH_ENDPOINT").xProduct,"x-product-location":config("UNIVERSAL_SEARCH_ENDPOINT").xProductLocation};return e.isLoggedIn&&(r.Authorization="Bearer ".concat(e.token)),r}function d(t,e){return{type:n.c,pageName:t,payload:e}}function y(t,e){return{type:n.d,pageName:t,payload:e}}function m(t,e){return{type:n.f,pageName:t,payload:e}}function g(t,e){return function(r,n){var i=n().criteriaDataCollection;Object(h.u)(i[t])&&r(a(t)),Object(h.u)(e.curatedDataUrl)||r(function(t,e){return function(r,n){var a=n().criteriaDataCollection;if(!Object(h.u)(a[t])&&!Object(h.D)(a[t].behance.fetchStatus)||!Object(h.D)(a[t].kuler.fetchStatus)||!Object(h.D)(a[t].stock.fetchStatus))return r(Object(s.i)(t,o.i)),r(Object(s.i)(t,o.Wb)),r(Object(s.i)(t,o.Hc)),r(Object(s.i)(t,o.x)),Object(f.c)(e.endPoint).then((function(e){var n=e,a={themes:[]},i={themes:[]},c={themes:[]},u={themes:[]};n&&n.files&&(i.themes=n.files.filter((function(t){return t.source===o.i})),a.themes=n.files.filter((function(t){return t.source===o.Wb})),c.themes=n.files.filter((function(t){return t.source===o.Hc})),u.themes=n.files.filter((function(t){return t.source===o.x})),r(Object(s.e)(t,o.i,i)),r(Object(s.e)(t,o.Wb,a)),r(Object(s.e)(t,o.Hc,c)),r(Object(s.e)(t,o.x,u))),r(Object(s.g)(t,o.i)),r(Object(s.g)(t,o.Wb)),r(Object(s.g)(t,o.Hc)),r(Object(s.g)(t,o.x))})).catch((function(e){console.log("error ".concat(e));var n=o.h.COMPLETED_WITH_GENERIC_ERROR;e.response&&e.response.status&&(n=e.response.status),r(Object(s.h)(t,o.i,n)),r(Object(s.h)(t,o.Wb,n)),r(Object(s.h)(t,o.Hc,n)),r(Object(s.h)(t,o.x,n))}))}}(t,{endPoint:e.curatedDataUrl}))}}function b(t,e,r){return function(n,d){var y=d().criteriaDataCollection;Object(h.u)(y[t])&&n(a(t)),e.forEach((function(e){e!==o.i||Object(h.u)(r.behanceUrl)?e!==o.Wb||Object(h.u)(r.kulerUrl)?e!==o.x||Object(h.u)(r.gradientUrl)?e!==o.Hc||Object(h.u)(r.stockUrl)?e!==o.p||Object(h.u)(r.ccLibraryUrl)?e!==o.Xc||Object(h.u)(r.universalSearchUrl)||n(function(t,e){return function(r,n){return r(Object(s.i)(t,o.Xc)),Object(f.f)(e.endPoint,v(n()),e.formData).then((function(e){var n=p(e);r(Object(s.e)(t,o.Xc,n)),r(Object(s.g)(t,o.Xc))})).catch((function(e){Object(h.x)("fetchUniversalThemeList: ".concat(e));var n=o.h.COMPLETED_WITH_GENERIC_ERROR;e.response&&e.response.status&&(n=e.response.status),console.log("error ".concat(e)),r(Object(s.h)(t,o.Xc,n))}))}}(t,{endPoint:r.universalSearchUrl,formData:r.formData})):n(Object(l.e)(t,{endPointTheme:r.ccLibraryUrl})):n(Object(c.c)(t,{endPoint:r.stockUrl})):n(Object(i.d)(t,{endPoint:r.gradientUrl})):n(Object(i.f)(t,{endPoint:r.kulerUrl})):n(Object(u.c)(t,{endPoint:r.behanceUrl}))}))}}function w(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return function(a,l){var s={};return e.includes(o.i)&&!Object(h.u)(t.behanceUrl)&&(s.BEHANCE=Object(u.d)(t.behanceUrl)),e.includes(o.Wb)&&!Object(h.u)(t.kulerUrl)&&(s.KULER=Object(i.g)(t.kulerUrl,l(),n)),e.includes(o.x)&&!Object(h.u)(t.gradientUrl)&&(s.COLOR_GRADIENTS=Object(i.g)(t.gradientUrl,l(),n)),e.includes(o.Hc)&&!Object(h.u)(t.stockUrl)&&(s.STOCK=Object(c.d)(t.stockUrl)),e.includes(o.Xc)&&!Object(h.u)(t.universalSearchUrl)&&(s.UNIVERSAL_SEARCH=function(t,e,r){return Object(f.f)(t,v(r()),e).then((function(t){return p(t).themes.length>0})).catch((function(t){return Object(h.x)("isDataAvailableForUniversalSearch: ".concat(t)),!1}))}(t.universalSearchUrl,r.universalSearchFormData,l)),Promise.all(Object.keys(s).map((function(t){return s[t]})))}}function O(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(i,l){var s=l().criteriaDataCollection;Object(h.u)(s[t])&&i(a(t)),e.forEach((function(e){e!==o.i||Object(h.u)(r.behanceUrl)?e!==o.Hc||Object(h.u)(r.stockUrl)||i(Object(c.c)(t,{endPoint:r.stockUrl})):i(Object(u.c)(t,{endPoint:r.behanceUrl},n))}))}}function E(t,e){return function(r){e.forEach((function(e){e===o.i?r(Object(u.a)(t)):e===o.Hc?r(Object(c.a)(t)):e===o.Wb&&r(Object(i.a)(t))}))}}function S(t,e){return function(r,n){var o=n().criteriaDataCollection;Object(h.u)(o[t])&&r(a(t)),r(Object(u.b)(t,{endPoint:e.behanceUrl})),r(Object(c.b)(t,{}))}}function j(t,e){return function(r,n){var o=n().criteriaDataCollection;Object(h.u)(e.kulerUrl)||(Object(h.u)(o[t])&&r(a(t)),r(Object(i.e)(t,{endPoint:e.kulerUrl})))}}function _(t,e,r){return function(n,o){var i=o().criteriaDataCollection;return Object(h.u)(i[t])&&n(a(t)),n(Object(l.d)(t,{firstEndPoint:e,secondEndPoint:r}))}}function x(t,e,r,n,o){return function(i,c){var u=c().criteriaDataCollection;return Object(h.u)(u[t])&&i(a(t)),i(Object(l.c)(t,{url:e,signal:r,defaultLibraryName:n,currentPage:o}))}}function L(t,e){return{type:n.r,pageName:t,payload:e}}function A(t,e){return{type:n.ub,pageName:t,payload:e}}function C(t,e){return function(r){if(e.source===o.Wb)return r(Object(i.k)(t,e))}}function T(t,e,r){return function(n){switch(r){case o.g.GRADIENT:return n(Object(l.g)(e));default:return n(Object(l.h)(t,e))}}}function M(t,e){return function(r){return r(Object(i.i)(t,e))}}function I(t,e){return function(r){switch(e.source){case o.p:return r(Object(l.b)(t,e));case o.Wb:return r(Object(i.c)(t,e));case o.x:return r(Object(i.b)(t,e))}}}function P(t,e,r){return function(n){return n(Object(l.f)(t,e,r))}}function N(t){return function(e){return e(Object(l.a)(t))}}function R(t,e,r){return function(n){switch(e){case o.p:n(Object(l.j)(t,r))}}}function k(t,e,r){return function(n){switch(e){case o.p:n(Object(l.i)(t,r))}}}function D(t,e,r){return function(n){return n(Object(i.j)(t,e,r))}}function F(t){return function(e){return e(a(t))}}}}]);